[
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html",
    "href": "dengue-cluster/cluster_long_scaled.html",
    "title": "Long time series (scaled)",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#packages",
    "href": "dengue-cluster/cluster_long_scaled.html#packages",
    "title": "Long time series (scaled)",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#load-data",
    "href": "dengue-cluster/cluster_long_scaled.html#load-data",
    "title": "Long time series (scaled)",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue <- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue <- dengue %>%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date <= as.Date(\"2020-01-01\")) %>%\n  # Pad days with zero cases\n  group_by(mun) %>%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %>%\n  ungroup() %>%\n  # Aggregate by week\n  mutate(date = floor_date(date, \"week\")) %>%\n  group_by(mun, date) %>%\n  summarise(freq = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  # Keep only municipalities series with more than 100 cases total\n  group_by(mun) %>%\n  mutate(total = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  filter(total >= 100) %>%\n  select(-total) %>%\n  # Scale cases by mun\n  group_by(mun) %>%\n  arrange(date) %>%\n  mutate(freq = scale(freq)) %>%\n  ungroup() %>%\n  arrange(mun, date) %>%\n  # Prepare time series\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun, date) %>%\n  pivot_wider(names_from = mun, values_from = freq) %>%\n  select(-date) %>%\n  t() %>%\n  tslist()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument."
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#clustering",
    "href": "dengue-cluster/cluster_long_scaled.html#clustering",
    "title": "Long time series (scaled)",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq <- 3:10\n\n\nSBD method\n\ntic()\nclust <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n29.499 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  kbl() %>%\n  kable_styling()\n\n\n\n \n  \n    k \n    Sil \n    SF \n    CH \n    DB \n    DBstar \n    D \n    COP \n  \n \n\n  \n    k_3 \n    0.1361517 \n    0.3215523 \n    301.2210 \n    3.692051 \n    4.316082 \n    0.0679378 \n    0.4052902 \n  \n  \n    k_5 \n    0.0868020 \n    0.2224752 \n    282.4503 \n    2.413023 \n    2.847291 \n    0.0280136 \n    0.3615501 \n  \n  \n    k_6 \n    0.0733088 \n    0.1578847 \n    154.6699 \n    4.988996 \n    6.309369 \n    0.0216979 \n    0.3660083 \n  \n  \n    k_4 \n    0.0610827 \n    0.2544475 \n    140.5981 \n    6.897833 \n    8.287407 \n    0.0216420 \n    0.3886784 \n  \n  \n    k_9 \n    0.0504672 \n    0.0626711 \n    124.3538 \n    3.532466 \n    4.849390 \n    0.0248858 \n    0.3501298 \n  \n  \n    k_10 \n    0.0466939 \n    0.0628349 \n    166.6916 \n    3.820877 \n    4.682205 \n    0.0135861 \n    0.3434336 \n  \n  \n    k_8 \n    0.0408157 \n    0.1107509 \n    164.5684 \n    3.780052 \n    4.964673 \n    0.0221248 \n    0.3432409 \n  \n  \n    k_7 \n    0.0380647 \n    0.1346238 \n    171.9309 \n    4.240165 \n    5.555059 \n    0.0219174 \n    0.3537959 \n  \n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust <- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html",
    "title": "Mun/epi year time series",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities cumulative dengue cases time-series yearly (starting on September) by its similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#packages",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#packages",
    "title": "Mun/epi year time series",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#load-data",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#load-data",
    "title": "Mun/epi year time series",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue <- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue <- dengue %>%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date < as.Date(\"2020-01-01\")) %>%\n  # Pad days with zero cases\n  group_by(mun) %>%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %>%\n  ungroup() %>%\n  # Aggregate by week\n  mutate(\n    week = str_pad(isoweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %>%\n  group_by(mun, year, week) %>%\n  summarise(freq = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  # Center year on September\n  group_by(mun) %>%\n  mutate(year = case_when(\n    week < 40 ~ year -1,\n    .default = year\n  )) %>%\n  ungroup() %>% \n  # Keep only municipalities/year series with more than 100 cases total\n  group_by(mun, year) %>%\n  mutate(total = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  filter(total >= 100) %>%\n  select(-total) %>%\n  # Scale cases by mun and year\n  group_by(mun, year) %>%\n  arrange(week) %>%\n  mutate(freq = scale(freq)) %>%\n  ungroup() %>%\n  arrange(mun, year, week) %>%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %>%\n  select(-year, week) %>%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun) %>%\n  pivot_wider(names_from = mun, values_from = freq) %>%\n  select(-week) %>%\n  t() %>%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue <- lapply(tdengue, na.omit)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#clustering",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#clustering",
    "title": "Mun/epi year time series",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq <- 3:10\n\n\nSBD method\n\ntic()\nclust <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n10.08 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  kbl() %>%\n  kable_styling()\n\n\n\n \n  \n    k \n    Sil \n    SF \n    CH \n    DB \n    DBstar \n    D \n    COP \n  \n \n\n  \n    k_4 \n    0.1460031 \n    0.3901889 \n    1221.4732 \n    1.729571 \n    2.355575 \n    0.0144472 \n    0.2148113 \n  \n  \n    k_3 \n    0.1073370 \n    0.4371917 \n    1617.9353 \n    2.098333 \n    2.810307 \n    0.0057479 \n    0.2360803 \n  \n  \n    k_5 \n    0.0829643 \n    0.3474048 \n    777.9166 \n    4.742646 \n    6.109333 \n    0.0060501 \n    0.2178480 \n  \n  \n    k_7 \n    0.0447668 \n    0.2792414 \n    620.1160 \n    3.894731 \n    6.159100 \n    0.0059028 \n    0.2063219 \n  \n  \n    k_9 \n    0.0408667 \n    0.1378384 \n    520.9820 \n    4.006004 \n    7.405060 \n    0.0069375 \n    0.2034521 \n  \n  \n    k_6 \n    0.0306821 \n    0.2620188 \n    642.5254 \n    3.478077 \n    6.350471 \n    0.0077663 \n    0.2178271 \n  \n  \n    k_10 \n    0.0300852 \n    0.1493126 \n    471.9434 \n    3.197318 \n    5.172398 \n    0.0106935 \n    0.2003746 \n  \n  \n    k_8 \n    0.0298938 \n    0.1695255 \n    510.7171 \n    3.721259 \n    7.713016 \n    0.0097268 \n    0.2056778 \n  \n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust <- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3    4 \n1439  176 1361 3288"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html",
    "href": "dengue-cluster/cluster_mun_year.html",
    "title": "Mun/year time series",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#packages",
    "href": "dengue-cluster/cluster_mun_year.html#packages",
    "title": "Mun/year time series",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#load-data",
    "href": "dengue-cluster/cluster_mun_year.html#load-data",
    "title": "Mun/year time series",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue <- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue <- dengue %>%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date <= as.Date(\"2020-01-01\")) %>%\n  # Pad days with zero cases\n  group_by(mun) %>%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %>%\n  ungroup() %>%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %>%\n  group_by(mun, year, week) %>%\n  summarise(freq = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  # Keep only municipalities/year series with more than 1,000 cases total\n  group_by(mun, year) %>%\n  mutate(total = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  filter(total >= 100) %>%\n  select(-total) %>%\n  # Scale cases by mun and year\n  group_by(mun, year) %>%\n  arrange(week) %>%\n  mutate(freq = scale(freq)) %>%\n  ungroup() %>%\n  arrange(mun, year, week) %>%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %>%\n  select(-year, week) %>%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun) %>%\n  pivot_wider(names_from = mun, values_from = freq) %>%\n  select(-week) %>%\n  t() %>%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue <- lapply(tdengue, na.omit)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#clustering",
    "href": "dengue-cluster/cluster_mun_year.html#clustering",
    "title": "Mun/year time series",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq <- 3:10\n\n\nSBD method\n\ntic()\nclust <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n10.25 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  kbl() %>%\n  kable_styling()\n\n\n\n \n  \n    k \n    Sil \n    SF \n    CH \n    DB \n    DBstar \n    D \n    COP \n  \n \n\n  \n    k_3 \n    0.1799898 \n    0.4600699 \n    1615.6227 \n    1.808332 \n    2.176731 \n    0.0107715 \n    0.2197241 \n  \n  \n    k_6 \n    0.0893704 \n    0.2658658 \n    636.5185 \n    2.950530 \n    5.019164 \n    0.0102939 \n    0.2146694 \n  \n  \n    k_4 \n    0.0880023 \n    0.3914649 \n    880.8181 \n    2.742671 \n    3.950231 \n    0.0088136 \n    0.2199024 \n  \n  \n    k_5 \n    0.0523091 \n    0.3553609 \n    874.9466 \n    2.905408 \n    4.787980 \n    0.0118592 \n    0.2039666 \n  \n  \n    k_7 \n    0.0493956 \n    0.2508976 \n    644.2339 \n    3.110343 \n    4.808484 \n    0.0084627 \n    0.2052782 \n  \n  \n    k_8 \n    0.0161030 \n    0.2628680 \n    451.9170 \n    4.862096 \n    7.169066 \n    0.0070094 \n    0.1972874 \n  \n  \n    k_10 \n    0.0139549 \n    0.2003374 \n    469.7019 \n    4.056141 \n    6.254832 \n    0.0092263 \n    0.1866359 \n  \n  \n    k_9 \n    0.0070017 \n    0.1981565 \n    445.0204 \n    3.658878 \n    6.053719 \n    0.0095809 \n    0.2005665 \n  \n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust <- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html",
    "href": "dengue-cluster/cluster_long.html",
    "title": "Long time series (not scaled)",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#packages",
    "href": "dengue-cluster/cluster_long.html#packages",
    "title": "Long time series (not scaled)",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#load-data",
    "href": "dengue-cluster/cluster_long.html#load-data",
    "title": "Long time series (not scaled)",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue <- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue <- dengue %>%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date <= as.Date(\"2020-01-01\")) %>%\n  # Pad days with zero cases\n  group_by(mun) %>%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %>%\n  ungroup() %>%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %>%\n  group_by(mun, year, week) %>%\n  summarise(freq = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  # Keep only municipalities series with more than 100 cases total\n  group_by(mun) %>%\n  mutate(total = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  filter(total >= 100) %>%\n  select(-total) %>%\n  # Prepare time series\n  arrange(mun) %>%\n  pivot_wider(names_from = mun, values_from = freq) %>%\n  select(-week) %>%\n  t() %>%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument."
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#clustering",
    "href": "dengue-cluster/cluster_long.html#clustering",
    "title": "Long time series (not scaled)",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq <- 3:10\n\n\nSBD method\n\ntic()\nclust <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n30.77 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  kbl() %>%\n  kable_styling()\n\n\n\n \n  \n    k \n    Sil \n    SF \n    CH \n    DB \n    DBstar \n    D \n    COP \n  \n \n\n  \n    k_4 \n    0.0791379 \n    0.2942586 \n    306.7187 \n    4.320184 \n    5.211837 \n    0.0233990 \n    0.3677273 \n  \n  \n    k_9 \n    0.0692345 \n    0.0706509 \n    175.8912 \n    4.509069 \n    6.067606 \n    0.0141304 \n    0.3513956 \n  \n  \n    k_7 \n    0.0496968 \n    0.1391306 \n    195.6647 \n    3.600487 \n    4.740779 \n    0.0181748 \n    0.3502974 \n  \n  \n    k_10 \n    0.0459831 \n    0.0883332 \n    135.2412 \n    3.542252 \n    4.435284 \n    0.0143742 \n    0.3398674 \n  \n  \n    k_5 \n    0.0458740 \n    0.2229537 \n    232.7183 \n    3.748572 \n    5.009317 \n    0.0270760 \n    0.3632605 \n  \n  \n    k_8 \n    0.0425873 \n    0.1217603 \n    193.0773 \n    3.450881 \n    4.358744 \n    0.0222442 \n    0.3502011 \n  \n  \n    k_6 \n    0.0420105 \n    0.2472877 \n    252.7502 \n    5.282233 \n    6.591471 \n    0.0254406 \n    0.3569795 \n  \n  \n    k_3 \n    0.0353830 \n    0.3659076 \n    319.9928 \n    5.148414 \n    5.829406 \n    0.0139628 \n    0.3936799 \n  \n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust <- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html",
    "title": "Mun/year time series, cumulative",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities cumulative dengue cases time-series yearly by its similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#packages",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#packages",
    "title": "Mun/year time series, cumulative",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#load-data",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#load-data",
    "title": "Mun/year time series, cumulative",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue <- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue <- dengue %>%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date <= as.Date(\"2020-01-01\")) %>%\n  # Pad days with zero cases\n  group_by(mun) %>%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %>%\n  ungroup() %>%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %>%\n  group_by(mun, year, week) %>%\n  summarise(freq = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  # Keep only municipalities/year series with more than 100 cases total\n  group_by(mun, year) %>%\n  mutate(total = sum(freq, na.rm = TRUE)) %>%\n  ungroup() %>%\n  filter(total >= 100) %>%\n  select(-total) %>%\n  # Modify freq\n  group_by(mun, year) %>%\n  arrange(week) %>%\n  # Accumulate mun time series by year\n  mutate(freq = cumsum(freq)) %>%\n  # Scale cases by mun and year\n  mutate(freq = scale(freq)) %>%\n  ungroup() %>%\n  arrange(mun, year, week) %>%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %>%\n  select(-year, week) %>%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun) %>%\n  pivot_wider(names_from = mun, values_from = freq) %>%\n  select(-week) %>%\n  t() %>%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue <- lapply(tdengue, na.omit)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#clustering",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#clustering",
    "title": "Mun/year time series, cumulative",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq <- 3:10\n\n\nSBD method\n\ntic()\nclust <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n12.062 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  kbl() %>%\n  kable_styling()\n\n\n\n \n  \n    k \n    Sil \n    SF \n    CH \n    DB \n    DBstar \n    D \n    COP \n  \n \n\n  \n    k_3 \n    0.5421277 \n    0.5873658 \n    3808.751 \n    0.6836648 \n    1.038241 \n    0.0002976 \n    0.0694489 \n  \n  \n    k_4 \n    0.5042762 \n    0.5822914 \n    4206.850 \n    0.6056223 \n    1.262730 \n    0.0003035 \n    0.0528271 \n  \n  \n    k_6 \n    0.4448936 \n    0.5766970 \n    3833.303 \n    0.6646770 \n    1.555062 \n    0.0003156 \n    0.0363601 \n  \n  \n    k_5 \n    0.4399115 \n    0.5791845 \n    3498.320 \n    0.7169644 \n    1.936044 \n    0.0001725 \n    0.0459396 \n  \n  \n    k_8 \n    0.4345944 \n    0.5664725 \n    3330.480 \n    0.7752000 \n    1.988574 \n    0.0002574 \n    0.0289114 \n  \n  \n    k_7 \n    0.3884300 \n    0.5722467 \n    3277.221 \n    1.0922372 \n    3.133504 \n    0.0002989 \n    0.0330646 \n  \n  \n    k_10 \n    0.3534378 \n    0.5633514 \n    2802.179 \n    0.9206737 \n    3.137418 \n    0.0003279 \n    0.0267403 \n  \n  \n    k_9 \n    0.3434713 \n    0.5664988 \n    3067.097 \n    0.9059799 \n    2.630923 \n    0.0003052 \n    0.0279188 \n  \n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust <- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)"
  },
  {
    "objectID": "dengue-data/aggregated_database.html",
    "href": "dengue-data/aggregated_database.html",
    "title": "Export aggregated database",
    "section": "",
    "text": "This notebook aims to create a database with aggregated counts of positive dengue cases for spatial and time units.\nThe aggregation will be on municipalities and time will be date and epidemiological week."
  },
  {
    "objectID": "dengue-data/aggregated_database.html#packages",
    "href": "dengue-data/aggregated_database.html#packages",
    "title": "Export aggregated database",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#load-data",
    "href": "dengue-data/aggregated_database.html#load-data",
    "title": "Export aggregated database",
    "section": "Load data",
    "text": "Load data\nLazy evaluation.\n\ndengue <- arrow::read_parquet(file = \"parquet_improved/dengue_improved.parquet\")\n\ntally(dengue)\n\n         n\n1 19180457"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#filter-valid-dates",
    "href": "dengue-data/aggregated_database.html#filter-valid-dates",
    "title": "Export aggregated database",
    "section": "Filter valid dates",
    "text": "Filter valid dates\n\nvalid_interval <- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue <- dengue %>%\n  mutate(DT_SIN_PRI = ymd(DT_SIN_PRI)) %>%\n  filter(DT_SIN_PRI %within% valid_interval)\n\ntally(dengue)\n\n         n\n1 15561929"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#filter-positive-cases-of-dengue",
    "href": "dengue-data/aggregated_database.html#filter-positive-cases-of-dengue",
    "title": "Export aggregated database",
    "section": "Filter positive cases of dengue",
    "text": "Filter positive cases of dengue\n\ndengue_classifications <- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\n\ndengue <- dengue %>%\n  filter(CLASSI_FIN %in% dengue_classifications)\n\ntally(dengue)\n\n        n\n1 8125611"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#aggregation",
    "href": "dengue-data/aggregated_database.html#aggregation",
    "title": "Export aggregated database",
    "section": "Aggregation",
    "text": "Aggregation\n\nMunicipality and date (“md”)\nIncluding the step to fill the time series with zero values when certain dates do not have cases.\n\ndengue_md <- dengue %>%\n  group_by(mun = ID_MN_RESI, date = DT_SIN_PRI) %>%\n  summarise(freq = n()) %>%\n  arrange(date) %>%\n  complete(\n    date = seq.Date(min(date), max(date), by = \"day\"),\n    fill = list(freq = 0)\n  ) %>%\n  ungroup() %>%\n  collect()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument.\n\n\n\nglimpse(dengue_md)\n\nRows: 16,772,737\nColumns: 3\n$ mun  <chr> \"110000\", \"110000\", \"110000\", \"110000\", \"110000\", \"110000\", \"1100…\n$ date <date> 2015-12-29, 2015-12-30, 2015-12-31, 2016-01-01, 2016-01-02, 2016…\n$ freq <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n\n\n\ndengue_md %>%\n  write_parquet(sink = \"parquet_aggregated/dengue_md.parquet\")\n\n\n\nMunicipality and epidemiological week (“mw”)\n\ndengue_mw <- dengue_md %>%\n  mutate(epi_week = paste0(epiyear(date), \"-\", str_pad(epiweek(date), 2, pad = \"0\"))) %>%\n  group_by(mun, epi_week) %>%\n  summarise(freq = n()) %>%\n  arrange(epi_week) %>%\n  ungroup() %>%\n  collect()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument.\n\n\n\nglimpse(dengue_mw)\n\nRows: 2,400,687\nColumns: 3\n$ mun      <chr> \"110005\", \"110006\", \"110014\", \"110034\", \"110140\", \"120017\", \"…\n$ epi_week <chr> \"2010-52\", \"2010-52\", \"2010-52\", \"2010-52\", \"2010-52\", \"2010-…\n$ freq     <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n\n\n\ndengue_mw %>%\n  write_parquet(sink = \"parquet_aggregated/dengue_mw.parquet\")"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#session-info",
    "href": "dengue-data/aggregated_database.html#session-info",
    "title": "Export aggregated database",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] arrow_12.0.0    lubridate_1.9.2 forcats_1.0.0   stringr_1.5.0  \n [5] dplyr_1.1.2     purrr_1.0.1     readr_2.1.4     tidyr_1.3.0    \n [9] tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       knitr_1.43        generics_0.1.3   \n[21] vctrs_0.6.3       htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5      \n[25] grid_4.1.2        tidyselect_1.2.0  glue_1.6.2        R6_2.5.1         \n[29] fansi_1.0.4       rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3   \n[33] scales_1.2.1      htmltools_0.5.5   assertthat_0.2.1  colorspace_2.1-0 \n[37] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-data/imputation.html",
    "href": "dengue-data/imputation.html",
    "title": "Imputation",
    "section": "",
    "text": "This notebook aims to imputate some missing data and enrich the dataset."
  },
  {
    "objectID": "dengue-data/imputation.html#packages",
    "href": "dengue-data/imputation.html#packages",
    "title": "Imputation",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/imputation.html#load-data",
    "href": "dengue-data/imputation.html#load-data",
    "title": "Imputation",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars <- c(\"ID_AGRAVO\", \"DT_NOTIFIC\", \"ID_UNIDADE\",\n                    \"DT_SIN_PRI\", \"CS_SEXO\", \"CS_GESTANT\",\n                    \"CS_RACA\", \"CS_ESCOL_N\", \"ID_MN_RESI\",\n                    \"COUFINF\", \"COMUNINF\", \"ID_OCUPA_N\",\n                    \"DT_SORO\", \"RESUL_SORO\", \"SOROTIPO\", \n                    \"CLASSI_FIN\", \"CRITERIO\", \"EVOLUCAO\",\n                    \"DT_OBITO\", \"HOSPITALIZ\", \"DT_INTERNA\")\n\ndengue <- open_dataset(sources = \"parquets/\") %>%\n  select(all_of(important_vars)) %>%\n  collect()\n\n\nResidence municipality: ID_MN_RESI\nTask: If ID_MN_RESI is invalid or missing, imputate with valid COMUNINF information.\n\nImputation\n\ndengue <- dengue %>%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE),\n    COMUNINF_check = if_else(nchar(COMUNINF) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %>%\n  mutate(ID_MN_RESI = case_when(\n    ID_MN_RESI_check == FALSE & COMUNINF_check == TRUE ~ COMUNINF,\n    is.na(ID_MN_RESI) ~ COMUNINF,\n    TRUE ~ ID_MN_RESI\n  )) %>%\n  select(-ID_MN_RESI_check, -COMUNINF_check)\n\n\n\nCheck improval\n\ndengue %>%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %>%\n  group_by(ID_MN_RESI_check) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nID_MN_RESI_check\nfreq\n\n\n\n\nFALSE\n4\n\n\nTRUE\n19.177.930\n\n\nNA\n2.523\n\n\n\n\n\nNo improvement for invalid municipalities, improvement of 96 records with missing data.\n\n\n\nDate of the first symptoms onset: DT_SIN_PRI\nTask: If DT_SIN_PRI is invalid or missing, imputate with valid DT_NOTIFIC information.\n\nImputation\n\nvalid_interval <- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue <- dengue %>%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval,\n    DT_NOTIFIC_check = ymd(DT_NOTIFIC) %within% valid_interval,\n  ) %>%\n  mutate(DT_SIN_PRI = case_when(\n    DT_SIN_PRI_check == FALSE & DT_NOTIFIC_check == TRUE ~ DT_NOTIFIC,\n    is.na(DT_SIN_PRI) ~ DT_NOTIFIC,\n    TRUE ~ DT_SIN_PRI\n  )) %>%\n  select(-DT_SIN_PRI_check, -DT_NOTIFIC_check)\n\n\n\nCheck improval\n\nvalid_interval <- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue %>%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval\n  ) %>%\n  group_by(DT_SIN_PRI_check) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nDT_SIN_PRI_check\nfreq\n\n\n\n\nFALSE\n3.618.528\n\n\nTRUE\n15.561.929\n\n\n\n\n\nThere was a improvement on 25,823 records with invalid dates and all missing records were imputate."
  },
  {
    "objectID": "dengue-data/imputation.html#export-improved-database",
    "href": "dengue-data/imputation.html#export-improved-database",
    "title": "Imputation",
    "section": "Export improved database",
    "text": "Export improved database\n\ndengue %>%\n  write_parquet(sink = \"parquet_improved/dengue_improved.parquet\")"
  },
  {
    "objectID": "dengue-data/imputation.html#session-info",
    "href": "dengue-data/imputation.html#session-info",
    "title": "Imputation",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      arrow_12.0.0    lubridate_1.9.2 forcats_1.0.0  \n [5] stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1     readr_2.1.4    \n [9] tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       generics_0.1.3    vctrs_0.6.2      \n[21] htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5       grid_4.1.2       \n[25] tidyselect_1.2.0  glue_1.6.2        R6_2.5.1          fansi_1.0.4      \n[29] rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1     \n[33] htmltools_0.5.5   assertthat_0.2.1  colorspace_2.1-0  utf8_1.2.3       \n[37] stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-data/raw_files.html",
    "href": "dengue-data/raw_files.html",
    "title": "Raw files",
    "section": "",
    "text": "This notebook presents the process of downloading SINAN Dengue raw data files from DataSUS, preprocessing steps using the {microdatasus} package and exporting the raw files to parquet files."
  },
  {
    "objectID": "dengue-data/raw_files.html#packages",
    "href": "dengue-data/raw_files.html#packages",
    "title": "Raw files",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\n# remotes::install_github(\"rfsaldanha/microdatasus\")\nlibrary(microdatasus)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp"
  },
  {
    "objectID": "dengue-data/raw_files.html#data-download",
    "href": "dengue-data/raw_files.html#data-download",
    "title": "Raw files",
    "section": "Data download",
    "text": "Data download\n\n# for(a in 2011:2021){\n#   tmp <- fetch_datasus(\n#     year_start = a, year_end = a,\n#     information_system = \"SINAN-DENGUE\"\n#   )\n# \n#   write_parquet(x = tmp, sink = paste0(\"parquets_raw/raw_dengue_\", a, \".parquet\"))\n#   \n#   tmp <- process_sinan_dengue(data = tmp)\n#   \n#   write_parquet(x = tmp, sink = paste0(\"parquets/dengue_\", a, \".parquet\"))\n#   \n#   rm(tmp)\n# }\n\nThis code chunk is commented to avoid unnecessary download again the raw DBC files from DataSUS."
  },
  {
    "objectID": "dengue-data/raw_files.html#load",
    "href": "dengue-data/raw_files.html#load",
    "title": "Raw files",
    "section": "Load",
    "text": "Load\nAfter download, preprocessing and export, the parquet files are read to have a dimension of the size.\n\ndengue <- open_dataset(sources = \"parquets/\")\n\n\ndengue %>% glimpse()\n\nFileSystemDataset with 15 Parquet files\n19,180,457 rows x 75 columns\n$ TP_NOT       <string> \"Individual\", \"Individual\", \"Individual\", \"Individual\", …\n$ ID_AGRAVO    <string> \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", …\n$ DT_NOTIFIC   <string> \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ SEM_NOT      <string> \"200707\", \"200707\", \"200709\", \"200707\", \"200706\", \"20070…\n$ NU_ANO       <string> \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", …\n$ SG_UF_NOT    <string> \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MUNICIP   <string> \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_REGIONA   <string> \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_UNIDADE   <string> \"2454793\", \"2454793\", \"2436027\", \"3340392\", \"3340392\", \"…\n$ DT_SIN_PRI   <string> \"2007-02-09\", \"2007-02-10\", \"2007-02-21\", \"2007-01-28\", …\n$ SEM_PRI      <string> \"200706\", \"200706\", \"200708\", \"200705\", \"200703\", \"20070…\n$ CS_SEXO      <string> \"Feminino\", \"Feminino\", \"Masculino\", \"Feminino\", \"Mascul…\n$ CS_GESTANT   <string> \"Ignorado\", \"Ignorado\", \"Não se aplica\", \"Não se aplica\"…\n$ CS_RACA      <string> \"Parda\", \"Parda\", \"Branca\", \"Branca\", \"Parda\", \"Parda\", …\n$ CS_ESCOL_N   <string> \"5a à 8a série incompleta do EF (antigo ginásio ou 1o gr…\n$ SG_UF        <string> \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MN_RESI   <string> \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_RG_RESI   <string> \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_PAIS      <string> \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASI…\n$ NDUPLIC_N    <string> \"Não identificado\", \"Não identificado\", NA, NA, NA, NA, …\n$ DT_DIGITA    <string> NA, NA, \"2007-03-08\", \"2007-05-22\", \"2007-05-02\", \"2007-…\n$ CS_FLXRET    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ FLXRECEBI    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MIGRADO_W    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INVEST    <string> \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ ID_OCUPA_N   <string> \"Nao informada\", \"Nao informada\", NA, \"Nao informada\", \"…\n$ DT_SORO      <string> NA, NA, \"2007-02-26\", \"2007-02-01\", \"2007-02-09\", NA, NA…\n$ RESUL_SORO   <string> \"Não realizado\", \"Não realizado\", \"Não reagente\", \"Reage…\n$ HISTOPA_N    <string> \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_VIRAL     <string> NA, NA, NA, NA, NA, NA, NA, NA, \"2007-02-14\", NA, NA, NA…\n$ RESUL_VI_N   <string> \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ SOROTIPO     <string> NA, NA, NA, NA, NA, NA, NA, NA, \"DEN 3\", NA, NA, NA, NA,…\n$ IMUNOH_N     <string> \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_PCR       <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ RESUL_PCR_   <string> \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ CLASSI_FIN   <string> \"Dengue clássico\", \"Dengue clássico\", \"Descartado\", \"Den…\n$ CRITERIO     <string> \"Clínico epidemiológico\", \"Clínico epidemiológico\", \"Clí…\n$ TPAUTOCTO    <string> \"Sim\", \"Sim\", NA, \"Não\", \"Sim\", NA, NA, \"Não\", \"Sim\", NA…\n$ COUFINF      <string> \"Maranhão\", \"Maranhão\", NA, \"Bahia\", \"Bahia\", NA, NA, \"B…\n$ COPAISINF    <string> \"BRASIL\", \"BRASIL\", NA, \"BRASIL\", \"BRASIL\", NA, NA, \"BRA…\n$ COMUNINF     <string> \"210780\", \"210780\", NA, \"292150\", \"292150\", NA, NA, \"292…\n$ DOENCA_TRA   <string> \"Não\", \"Não\", NA, \"Não\", \"Não\", NA, NA, \"Não\", \"Não\", NA…\n$ EVOLUCAO     <string> \"Cura\", \"Cura\", NA, \"Cura\", \"Cura\", NA, NA, \"Cura\", \"Cur…\n$ DT_OBITO     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_ENCERRA   <string> \"2007-05-08\", \"2007-05-08\", \"2007-04-19\", \"2007-05-28\", …\n$ MANI_HEMOR   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EPISTAXE     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ GENGIVO      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ METRO        <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PETEQUIAS    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HEMATURA     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ SANGRAM      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ LACO_N       <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLASMATICO   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EVIDENCIA    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLAQ_MENOR   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ CON_FHD      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ COMPLICA     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HOSPITALIZ   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INTERNA   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ UF           <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MUNICIPIO    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEminutos <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEhoras   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEdias    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEmeses   <string> NA, NA, NA, \"0\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ IDADEanos    <string> \"3\", \"1\", \"3\", NA, \"0\", \"1\", \"3\", \"0\", \"3\", \"0\", \"1\", \"2…\n$ munResStatus <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResTipo   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResNome   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResUf     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLat    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLon    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResAlt    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResArea   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\nCall `print()` for full schema details"
  },
  {
    "objectID": "dengue-data/missing_data.html",
    "href": "dengue-data/missing_data.html",
    "title": "Missing data analysis",
    "section": "",
    "text": "This report presents a missing data analysis from the raw parquet files.\nConsidering the high number of variables, this report will use a subset of the most relevant ones for this research."
  },
  {
    "objectID": "dengue-data/missing_data.html#packages",
    "href": "dengue-data/missing_data.html#packages",
    "title": "Missing data analysis",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(naniar)\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/missing_data.html#load-data",
    "href": "dengue-data/missing_data.html#load-data",
    "title": "Missing data analysis",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars <- c(\"ID_AGRAVO\", \"DT_NOTIFIC\", \"ID_UNIDADE\",\n                    \"DT_SIN_PRI\", \"CS_SEXO\", \"CS_GESTANT\",\n                    \"CS_RACA\", \"CS_ESCOL_N\", \"ID_MN_RESI\",\n                    \"COUFINF\", \"COMUNINF\", \"ID_OCUPA_N\",\n                    \"DT_SORO\", \"RESUL_SORO\", \"SOROTIPO\", \n                    \"CLASSI_FIN\", \"CRITERIO\", \"EVOLUCAO\",\n                    \"DT_OBITO\", \"HOSPITALIZ\", \"DT_INTERNA\")\n\ndengue <- open_dataset(sources = \"parquets/\") %>%\n  select(all_of(important_vars)) %>%\n  collect()"
  },
  {
    "objectID": "dengue-data/missing_data.html#overall",
    "href": "dengue-data/missing_data.html#overall",
    "title": "Missing data analysis",
    "section": "Overall",
    "text": "Overall\nConsidering all records.\n\ndengue %>% \n  miss_var_summary() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nvariable\nn_miss\npct_miss\n\n\n\n\nDT_OBITO\n19.153.998\n99,8620523\n\n\nSOROTIPO\n19.122.145\n99,6959822\n\n\nDT_INTERNA\n18.666.361\n97,3196885\n\n\nDT_SORO\n13.240.413\n69,0307483\n\n\nCOUFINF\n12.135.027\n63,2676635\n\n\nCOMUNINF\n11.092.216\n57,8308223\n\n\nHOSPITALIZ\n9.873.619\n51,4774961\n\n\nRESUL_SORO\n7.430.672\n38,7408496\n\n\nEVOLUCAO\n6.002.490\n31,2948226\n\n\nCS_ESCOL_N\n5.838.882\n30,4418294\n\n\nCRITERIO\n4.529.680\n23,6161213\n\n\nCS_RACA\n3.700.530\n19,2932316\n\n\nCLASSI_FIN\n2.402.459\n12,5255566\n\n\nCS_GESTANT\n2.304.926\n12,0170547\n\n\nCS_SEXO\n2.301.330\n11,9983064\n\n\nID_OCUPA_N\n720.520\n3,7565320\n\n\nID_UNIDADE\n3.471\n0,0180965\n\n\nID_MN_RESI\n2.627\n0,0136962\n\n\nDT_SIN_PRI\n176\n0,0009176\n\n\nDT_NOTIFIC\n1\n0,0000052\n\n\nID_AGRAVO\n0\n0,0000000\n\n\n\n\n\n\nVariables quality\n\nResidence municipality: ID_MN_RESI\nCheck var length. 6 characters are expected.\n\ndengue %>%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %>%\n  group_by(ID_MN_RESI_check) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nID_MN_RESI_check\nfreq\n\n\n\n\nFALSE\n4\n\n\nTRUE\n19.177.826\n\n\nNA\n2.627\n\n\n\n\n\n15.559.994 records on the database meets the criteria. 4 records have invalid municipalty codes and this information is missing for 2.126 records. Inputation from COMUNINF is a possibility.\n\n\nFinal classification of the notification: CLASSI_FIN\nIt is expected that the notifications final classification are labeled.\n\ndengue %>%\n  group_by(CLASSI_FIN) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nCLASSI_FIN\nfreq\n\n\n\n\n1\n308.012\n\n\n2\n7.962\n\n\n3\n2.588\n\n\n4\n91\n\n\n5\n189.158\n\n\n6\n3\n\n\n8\n75.360\n\n\nDengue\n5.665.033\n\n\nDengue clássico\n2.686.548\n\n\nDengue com complicações\n23.073\n\n\nDengue com sinais de alarme\n82.408\n\n\nDengue grave\n7.391\n\n\nDescartado\n5.580.603\n\n\nFebre hemorrágica do dengue\n7.136\n\n\nInconclusivo\n2.142.252\n\n\nSíndrome do choque do dengue\n380\n\n\nNA\n2.402.459\n\n\n\n\n\n3 records have an invalid label and 69.866 are missing. This missing data may be from two causes: (1) the notification is being evaluated or (2) a real missing.\n\n\nDate of the first symptons onset: DT_SIN_PRI\nThis is the date most near to the infection date and more relevant to epidemiological analysis.\n\nvalid_interval <- interval(ymd(\"2001-01-01\"), ymd(\"2021-12-31\"))\n\ndengue %>%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval\n  ) %>%\n  group_by(DT_SIN_PRI_check) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nDT_SIN_PRI_check\nfreq\n\n\n\n\nFALSE\n30.775\n\n\nTRUE\n19.149.506\n\n\nNA\n176\n\n\n\n\n\nThis variable is missing for 173 records. For 26.018 records, we have invalid dates (outside the period 2001-2021). It is possible to imputate with DT_NOTIFIC (date of notification), if valid."
  },
  {
    "objectID": "dengue-data/missing_data.html#positive-cases",
    "href": "dengue-data/missing_data.html#positive-cases",
    "title": "Missing data analysis",
    "section": "Positive cases",
    "text": "Positive cases\n\ndengue_classifications <- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\ndengue %>% \n  filter(CLASSI_FIN %in% dengue_classifications) %>%\n  miss_var_summary() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nvariable\nn_miss\npct_miss\n\n\n\n\nDT_OBITO\n8.463.480\n99,8997990\n\n\nSOROTIPO\n8.417.274\n99,3544004\n\n\nDT_INTERNA\n8.208.924\n96,8951138\n\n\nDT_SORO\n5.864.290\n69,2199181\n\n\nHOSPITALIZ\n2.985.375\n35,2382663\n\n\nCOMUNINF\n1.959.050\n23,1239043\n\n\nCOUFINF\n1.934.904\n22,8388938\n\n\nCS_ESCOL_N\n1.782.790\n21,0433962\n\n\nRESUL_SORO\n1.778.971\n20,9983181\n\n\nCS_RACA\n717.175\n8,4652694\n\n\nEVOLUCAO\n470.392\n5,5523338\n\n\nID_OCUPA_N\n132.202\n1,5604637\n\n\nCS_GESTANT\n1.825\n0,0215416\n\n\nID_UNIDADE\n1.625\n0,0191809\n\n\nCRITERIO\n1.173\n0,0138457\n\n\nID_MN_RESI\n739\n0,0087229\n\n\nCS_SEXO\n220\n0,0025968\n\n\nDT_SIN_PRI\n5\n0,0000590\n\n\nID_AGRAVO\n0\n0,0000000\n\n\nDT_NOTIFIC\n0\n0,0000000\n\n\nCLASSI_FIN\n0\n0,0000000"
  },
  {
    "objectID": "dengue-data/missing_data.html#session-info",
    "href": "dengue-data/missing_data.html#session-info",
    "title": "Missing data analysis",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      naniar_1.0.0    arrow_12.0.0    lubridate_1.9.2\n [5] forcats_1.0.0   stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1    \n [9] readr_2.1.4     tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2  \n[13] tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       generics_0.1.3    vctrs_0.6.3      \n[21] htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5       grid_4.1.2       \n[25] tidyselect_1.2.0  glue_1.6.2        R6_2.5.1          fansi_1.0.4      \n[29] rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1     \n[33] htmltools_0.5.5   visdat_0.6.0      assertthat_0.2.1  colorspace_2.1-0 \n[37] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-data/case_classification.html",
    "href": "dengue-data/case_classification.html",
    "title": "Case classification analysis",
    "section": "",
    "text": "This report presents a description report about dengue case classification and criteria."
  },
  {
    "objectID": "dengue-data/case_classification.html#packages",
    "href": "dengue-data/case_classification.html#packages",
    "title": "Case classification analysis",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/case_classification.html#load-data",
    "href": "dengue-data/case_classification.html#load-data",
    "title": "Case classification analysis",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars <- c(\"DT_SIN_PRI\", \"RESUL_SORO\", \"SOROTIPO\", \"CLASSI_FIN\", \"CRITERIO\")\n\nvalid_interval <- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue <- open_dataset(sources = \"parquets/\") %>%\n  select(all_of(important_vars)) %>%\n  collect() %>%\n  mutate(DT_SIN_PRI = ymd(DT_SIN_PRI)) %>%\n  filter(DT_SIN_PRI %within% valid_interval) %>%\n  filter(CLASSI_FIN != \"6\")"
  },
  {
    "objectID": "dengue-data/case_classification.html#final-classification-and-criteria",
    "href": "dengue-data/case_classification.html#final-classification-and-criteria",
    "title": "Case classification analysis",
    "section": "Final classification and criteria",
    "text": "Final classification and criteria\n\ndengue %>%\n  group_by(CLASSI_FIN, CRITERIO) %>%\n  summarise(freq = n()) %>%\n  ungroup() %>%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n`summarise()` has grouped output by 'CLASSI_FIN'. You can override using the\n`.groups` argument.\n\n\n\n\n\nCLASSI_FIN\nCRITERIO\nfreq\n\n\n\n\nDengue\nClínico epidemiológico\n3.527.885\n\n\nDengue\nEm investigação\n62.457\n\n\nDengue\nLaboratório\n2.064.344\n\n\nDengue\nNA\n16\n\n\nDengue clássico\nClínico epidemiológico\n1.439.136\n\n\nDengue clássico\nEm investigação\n16.796\n\n\nDengue clássico\nLaboratório\n880.966\n\n\nDengue clássico\nNA\n7\n\n\nDengue com complicações\nClínico epidemiológico\n8.249\n\n\nDengue com complicações\nEm investigação\n595\n\n\nDengue com complicações\nLaboratório\n9.973\n\n\nDengue com sinais de alarme\nClínico epidemiológico\n41.859\n\n\nDengue com sinais de alarme\nEm investigação\n2.079\n\n\nDengue com sinais de alarme\nLaboratório\n38.350\n\n\nDengue grave\nClínico epidemiológico\n1.452\n\n\nDengue grave\nEm investigação\n447\n\n\nDengue grave\nLaboratório\n5.481\n\n\nDescartado\nClínico epidemiológico\n2.495.845\n\n\nDescartado\nEm investigação\n9.383\n\n\nDescartado\nLaboratório\n2.845.345\n\n\nDescartado\nNA\n26\n\n\nFebre hemorrágica do dengue\nClínico epidemiológico\n2\n\n\nFebre hemorrágica do dengue\nEm investigação\n230\n\n\nFebre hemorrágica do dengue\nLaboratório\n5.041\n\n\nInconclusivo\nClínico epidemiológico\n17.369\n\n\nInconclusivo\nEm investigação\n60.306\n\n\nInconclusivo\nLaboratório\n7.750\n\n\nInconclusivo\nNA\n1.909.736\n\n\nSíndrome do choque do dengue\nClínico epidemiológico\n5\n\n\nSíndrome do choque do dengue\nEm investigação\n17\n\n\nSíndrome do choque do dengue\nLaboratório\n273\n\n\n\n\n\n\ndengue_classifications <- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\n\ndengue_cases_classification <- dengue %>% \n  mutate(CLASSI_FIN = case_when(\n    CLASSI_FIN %in% dengue_classifications ~ \"Confirmed\",\n    CLASSI_FIN == \"Descartado\" ~ \"Discarded\",\n    CLASSI_FIN == \"Inconclusivo\" ~ \"Inconclusive\",\n    CLASSI_FIN == 6 ~ \"Invalid\",\n    is.na(CLASSI_FIN) ~ \"Missing\",\n    .default = CLASSI_FIN\n  )) %>%\n  mutate(DT_SIN_PRI = lubridate::ceiling_date(x = DT_SIN_PRI, unit = \"month\")) %>%\n  group_by(DT_SIN_PRI, CLASSI_FIN) %>%\n  summarise(freq = n()) %>%\n  ungroup() \n\n`summarise()` has grouped output by 'DT_SIN_PRI'. You can override using the\n`.groups` argument.\n\n\n\nwrite_parquet(x = dengue_cases_classification, sink = \"parquet_classification/dengue_cases_classification.parquet\")\n\n\nggplot(data =  dengue_cases_classification, aes(x = DT_SIN_PRI, weight = freq, fill = CLASSI_FIN)) +\n  geom_bar() +\n  scale_fill_hue(direction = 1) +\n  scale_y_continuous(labels = scales::comma) +\n  labs(fill = \"Classificação\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\") +\n  labs(x = \"Month of first symptom's onset\", y = \"Records\", fill = \"Classification\")\n\n\n\nggsave(filename = \"dengue_cases_classification.pdf\")\n\nSaving 7 x 5 in image"
  },
  {
    "objectID": "dengue-data/case_classification.html#sorological-examination",
    "href": "dengue-data/case_classification.html#sorological-examination",
    "title": "Case classification analysis",
    "section": "Sorological examination",
    "text": "Sorological examination\n\ndengue %>%\n  filter(CLASSI_FIN %in% dengue_classifications) %>%\n  group_by(SOROTIPO) %>%\n  summarise(freq = n()) %>%\n  ungroup()\n\n# A tibble: 5 × 2\n  SOROTIPO    freq\n  <chr>      <int>\n1 DEN 1      28619\n2 DEN 2      16429\n3 DEN 3        209\n4 DEN 4       6122\n5 <NA>     8054281"
  },
  {
    "objectID": "dengue-data/case_classification.html#session-info",
    "href": "dengue-data/case_classification.html#session-info",
    "title": "Case classification analysis",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      arrow_12.0.1    lubridate_1.9.2 forcats_1.0.0  \n [5] stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1     readr_2.1.4    \n [9] tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       systemfonts_1.0.4 generics_0.1.3   \n[21] vctrs_0.6.3       htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5      \n[25] grid_4.1.2        tidyselect_1.2.0  glue_1.6.2        R6_2.5.1         \n[29] textshaping_0.3.6 fansi_1.0.4       rmarkdown_2.22    farver_2.1.1     \n[33] tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1      htmltools_0.5.5  \n[37] assertthat_0.2.1  colorspace_2.1-0  ragg_1.2.5        labeling_0.4.2   \n[41] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue_data.html",
    "href": "dengue_data.html",
    "title": "Overview",
    "section": "",
    "text": "flowchart LR\n  A[Raw dataset] --> B(Imputation)\n  B --> C[Improved dataset]\n  C --> D{Filter valid dates}\n  C --> E{Filter positive cases}\n  D --> F(Aggregate)\n  E --> F\n  F --> G[Municipality and date dataset]\n  F --> H[Municipality and epiweek dataset]"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Building and Selecting Specialized AI Models for Predicting Dengue Disease",
    "section": "",
    "text": "This website presents working in progress research on dengue and machine learning, as part of my Postdoctoral researcher position at Inria (Montpellier, France) and LNCC (Petrópolis, Brazil)."
  },
  {
    "objectID": "presentations/presentation_test.html#isso-é-um-teste",
    "href": "presentations/presentation_test.html#isso-é-um-teste",
    "title": "Teste de apresentação",
    "section": "Isso é um teste",
    "text": "Isso é um teste\n\nbla\nbla bla\nbla"
  },
  {
    "objectID": "dengue_model.html",
    "href": "dengue_model.html",
    "title": "Overview",
    "section": "",
    "text": "In this section there are notebooks for dengue modelling."
  },
  {
    "objectID": "software.html",
    "href": "software.html",
    "title": "Software",
    "section": "",
    "text": "An R package to on-line access zonal statistics from weather indicators that were calculated for each municipality in Brazil using data from the BR-DWGD and TerraClimate projects.\nMore details on https://rfsaldanha.github.io/brclimr"
  },
  {
    "objectID": "software.html#epifeat",
    "href": "software.html#epifeat",
    "title": "Software",
    "section": "epifeat",
    "text": "epifeat\nAn R package to extract epidemiological features from cases time series.\nMore details on https://github.com/rfsaldanha/happyfeat"
  },
  {
    "objectID": "cluster_analysis.html",
    "href": "cluster_analysis.html",
    "title": "Overview",
    "section": "",
    "text": "On this section there are notebooks that cluster municipalities time series of dengue cases with different strategies."
  },
  {
    "objectID": "weather_data.html",
    "href": "weather_data.html",
    "title": "Weather data",
    "section": "",
    "text": "Zonal statistics such as mean, maximum, minimum, standard deviation, and sum were computed by taking into account the data cells that intersect the boundaries of each municipality and stored in Parquet files.\nThis procedure was carried out for all Brazilian municipalities, and for all available dates, for every indicator available in the weather products BR-DWGD and TerraClimate."
  },
  {
    "objectID": "weather_data.html#methodology",
    "href": "weather_data.html#methodology",
    "title": "Weather data",
    "section": "Methodology",
    "text": "Methodology\nZonal statistics are descriptive statistics calculated using a set of cells that spatially intersects a given spatial boundary. For each boundary in a map, statistics like average, maximum value, minimum value, standard deviation, and sum are obtained to represent the cell’s values that intersect the boundary.\nThe Brazilian municipality boundaries from 2010 were used as a reference, as provided by the geobr package.\nThus, for each municipality, a set of zonal statistics of weather indicators is calculated, at the same time resolution of the source dataset.\n\n\n\n\n\nThose datasets are available as parquet files on S3 buckets and queried by this project functions to retrieve data for a given municipality, dates, weather indicators, and desired zonal statistics."
  },
  {
    "objectID": "weather_data.html#results",
    "href": "weather_data.html#results",
    "title": "Weather data",
    "section": "Results",
    "text": "Results\n\nZonal BR-DWGD\n\nXavier, A. C., Scanlon, B. R., King, C. W., & Alves, A. I. (2022). New improved Brazilian daily weather gridded data (1961–2020). International Journal of Climatology. https://doi.org/10.1002/joc.7731\n\nThe BR-DWGD dataset presents daily meteorological data interpolated to a grid with 0.1° × 0.1° of spatial resolution for the Brazilian territory, with daily data from January 1, 1961, to July 31, 2020. It used data from 1,252 weather stations and 11,473 rain gauges in its interpolation methods, cross-validated to the selection of the best method for each weather indicator.\nThe following weather indicators are available from the BR-DWGD study: precipitation (mm), minimum temperature (°C), maximum temperature (°C), solar radiation (MJ⋅m−2), wind speed at 2m height (m⋅s−1) and relative humidity (%).\n\nbrclimr::product_info(product = \"brdwgd\")\n\n<list>\n├─tmax: <list>\n│ ├─name: \"Maximum temperature\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"Tmax_min\"\n│   ├─max: \"Tmax_max\"\n│   ├─mean: \"Tmax_mean\"\n│   └─sd: \"Tmax_sd\"\n├─tmin: <list>\n│ ├─name: \"Minimum temperature\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"Tmin_min\"\n│   ├─max: \"Tmin_max\"\n│   ├─mean: \"Tmin_mean\"\n│   └─sd: \"Tmin_sd\"\n├─pr: <list>\n│ ├─name: \"Precipitation\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"pr_min\"\n│   ├─max: \"pr_max\"\n│   ├─mean: \"pr_mean\"\n│   ├─sd: \"pr_sd\"\n│   └─sum: \"pr_sum\"\n├─eto: <list>\n│ ├─name: \"Evapotranspiration\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"ETo_min\"\n│   ├─max: \"ETo_max\"\n│   ├─mean: \"ETo_mean\"\n│   ├─sd: \"ETo_sd\"\n│   └─sum: \"ETo_sd\"\n├─rh: <list>\n│ ├─name: \"Relative humidity\"\n│ ├─unit: \"Percentage\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"RH_min\"\n│   ├─max: \"RH_max\"\n│   ├─mean: \"RH_mean\"\n│   └─sd: \"RH_sd\"\n├─rs: <list>\n│ ├─name: \"Solar radiation\"\n│ ├─unit: \"MJ/m2\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: <list>\n│   ├─min: \"Rs_min\"\n│   ├─max: \"Rs_max\"\n│   ├─mean: \"Rs_mean\"\n│   └─sd: \"Rs_sd\"\n└─u2: <list>\n  ├─name: \"Wind speed\"\n  ├─unit: \"m/2\"\n  ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n  └─stats: <list>\n    ├─min: \"u2_min\"\n    ├─max: \"u2_max\"\n    ├─mean: \"u2_mean\"\n    └─sd: \"u2_sd\"\n\n\n\n\nZonal TerraClimate\n\nAbatzoglou, J. T., Dobrowski, S. Z., Parks, S. A., Hegewisch, K. C. (2018). TerraClimate, a high-resolution global dataset of monthly climate and climatic water balance from 1958-2015. Scientific Data, 5. https://doi.org/10.1038/sdata.2017.191\n\nThe TerraClimate dataset presents monthly meteorological data interpolated to a grid with 0.04° × 0.04° (1/24th degree) of spatial resolution with world cover, with monthly data from January, 1958, to December, 2021.\nThe following weather indicators are available from the TerraClimate study: Actual Evapotranspiration (mm), Climate Water Deficit (mm), Potential evapotranspiration(mm), Precipitation (mm), Runoff (mm), Soil Moisture (mm), Downward surface shortwave radiation (W/m2), Snow water equivalent (mm), Minimum temperature (°C), Maximum temperature (°C), Vapor pressure (kPa), Wind speed (m/s), Vapor Pressure Deficit (kpa) and Palmer Drought Severity Index.\n\nbrclimr::product_info(product = \"terraclimate\")\n\n<list>\n├─tmax: <list>\n│ ├─name: \"Maximum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"tmax_min\"\n│   ├─max: \"tmax_max\"\n│   ├─mean: \"tmax_mean\"\n│   └─sd: \"tmax_sd\"\n├─tmin: <list>\n│ ├─name: \"Minimum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"tmin_min\"\n│   ├─max: \"tmin_max\"\n│   ├─mean: \"tmin_mean\"\n│   └─sd: \"tmin_sd\"\n├─ppt: <list>\n│ ├─name: \"Precipitation\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"ppt_min\"\n│   ├─max: \"ppt_max\"\n│   ├─mean: \"ppt_mean\"\n│   ├─sd: \"ppt_sd\"\n│   └─sum: \"ppt_sum\"\n├─aet: <list>\n│ ├─name: \"Actual Evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"aet_min\"\n│   ├─max: \"aet_max\"\n│   ├─mean: \"aet_mean\"\n│   ├─sd: \"aet_sd\"\n│   └─sum: \"aet_sum\"\n├─def: <list>\n│ ├─name: \"Climate Water Deficit\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"def_min\"\n│   ├─max: \"def_max\"\n│   ├─mean: \"def_mean\"\n│   ├─sd: \"def_sd\"\n│   └─sum: \"def_sum\"\n├─pdsi: <list>\n│ ├─name: \"Palmer Drought Severity Index\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"unitless\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"PDSI_min\"\n│   ├─max: \"PDSI_max\"\n│   ├─mean: \"PDSI_mean\"\n│   └─sd: \"PDSI_sd\"\n├─pet: <list>\n│ ├─name: \"Potential evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"pet_min\"\n│   ├─max: \"pet_max\"\n│   ├─mean: \"pet_mean\"\n│   ├─sd: \"pet_sd\"\n│   └─sum: \"pet_sum\"\n├─q: <list>\n│ ├─name: \"Runoff\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"q_min\"\n│   ├─max: \"q_max\"\n│   ├─mean: \"q_mean\"\n│   ├─sd: \"q_sd\"\n│   └─sum: \"q_sum\"\n├─soil: <list>\n│ ├─name: \"Soil Moisture\"\n│ ├─detail: \"Total column, at end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"soil_min\"\n│   ├─max: \"soil_max\"\n│   ├─mean: \"soil_mean\"\n│   ├─sd: \"soil_sd\"\n│   └─sum: \"soil_sum\"\n├─srad: <list>\n│ ├─name: \"Downward surface shortwave radia...\"\n│ ├─unit: \"W/m2\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"srad_min\"\n│   ├─max: \"srad_max\"\n│   ├─mean: \"srad_mean\"\n│   ├─sd: \"srad_sd\"\n│   └─sum: \"srad_sum\"\n├─swe: <list>\n│ ├─name: \"Snow water equivalent\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"swe_min\"\n│   ├─max: \"swe_max\"\n│   ├─mean: \"swe_mean\"\n│   ├─sd: \"swe_sd\"\n│   └─sum: \"swe_sum\"\n├─vap: <list>\n│ ├─name: \"Vapor pressure\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"vap_min\"\n│   ├─max: \"vap_max\"\n│   ├─mean: \"vap_mean\"\n│   └─sd: \"vap_sd\"\n├─vpd: <list>\n│ ├─name: \"Vapor Pressure Deficit\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: <list>\n│   ├─min: \"vpd_min\"\n│   ├─max: \"vpd_max\"\n│   ├─mean: \"vpd_mean\"\n│   └─sd: \"vpd_sd\"\n└─ws: <list>\n  ├─name: \"Wind speed\"\n  ├─detail: \"Average for month\"\n  ├─unit: \"m/s\"\n  ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n  └─stats: <list>\n    ├─min: \"ws_min\"\n    ├─max: \"ws_max\"\n    ├─mean: \"ws_mean\"\n    └─sd: \"ws_sd\""
  },
  {
    "objectID": "weather_data.html#availability",
    "href": "weather_data.html#availability",
    "title": "Weather data",
    "section": "Availability",
    "text": "Availability\n\nParquet files\nThe results are available to use as parquet format files. Access the following DOIs to access and download the files.\n\nZonal BR-DWGD\n\n\n\n\n\n\n\nZonal TerraClimate\n\n\n\n\n\n\n\n\nR package brclimr\nWe created an R package to on-line access those parquet files and download data for a user especified municipality. More details on https://rfsaldanha.github.io/brclimr"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html",
    "href": "dengue-model/dengue_weather_lag_reg.html",
    "title": "Dengue and weather lags, regression task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#dengue-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#dengue-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Dengue data",
    "text": "Dengue data\n\nSubset and aggregate\nRio de Janeiro, RJ, aggregated by month.\n\ndengue_rj <- open_dataset(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %>%\n  filter(mun == 330455) %>%\n  collect() %>%\n  summarise_by_time(.date_var = date, .by = \"month\", freq = sum(freq, na.rm = TRUE))\n\n\nplot_time_series(.data = dengue_rj, .date_var = date, .value = freq, .smooth = FALSE, .title = \"Dengue, absolute number of cases\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#weather-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#weather-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Weather data",
    "text": "Weather data\n\ntmax <- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"Tmax_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(tmax = value)\n\nprec <- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"pr_sum\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = sum(value, na.rm = TRUE)) %>%\n  rename(prec = value)\n\nprec_avg <- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"pr_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(prec_avg = value)\n\nrh <- open_dataset(sources = \"../weather-data/parquet/brdwgd/rh.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"RH_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(rh = value)\n\nwind <- open_dataset(sources = \"../weather-data/parquet/brdwgd/u2.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"u2_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(wind = value)\n\n\nplot_time_series(.data = tmax, .date_var = date, .value = tmax, .smooth = FALSE, .title = \"Max temp, average\")\n\n\n\n\n\n\nplot_time_series(.data = prec, .date_var = date, .value = prec, .smooth = FALSE, .title = \"Precipitation, sum\")\n\n\n\n\n\n\nplot_time_series(.data = prec_avg, .date_var = date, .value = prec_avg, .smooth = FALSE, .title = \"Precipitation, average\")\n\n\n\n\n\n\nplot_time_series(.data = rh, .date_var = date, .value = rh, .smooth = FALSE, .title = \"Relative humidity, average\")\n\n\n\n\n\n\nplot_time_series(.data = wind, .date_var = date, .value = wind, .smooth = FALSE, .title = \"Wind, average\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#join-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#join-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Join data",
    "text": "Join data\n\nres <- inner_join(x = dengue_rj, y = tmax, by = \"date\") %>%\n  inner_join(prec, by = \"date\") %>%\n  inner_join(prec_avg, by = \"date\") %>%\n  inner_join(rh, by = \"date\") %>%\n  inner_join(wind, by = \"date\") %>%\n  select(date, cases = freq, tmax, prec, rh, wind)"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#decision-tree",
    "href": "dengue-model/dengue_weather_lag_reg.html#decision-tree",
    "title": "Dengue and weather lags, regression task",
    "section": "Decision tree",
    "text": "Decision tree\n\nPrepare data\n\nRemove date\nLag variables: 6 months\n\n\nres_prep <- res %>%\n  select(-date) %>%\n  tk_augment_lags(.value = c(tmax, prec, wind, rh), .lags = 1:6)\n\n\n\nParameters\n\ntree_spec <- decision_tree() %>%\n  set_engine(\"rpart\") %>%\n  set_mode(\"regression\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#fit-model",
    "href": "dengue-model/dengue_weather_lag_reg.html#fit-model",
    "title": "Dengue and weather lags, regression task",
    "section": "Fit model",
    "text": "Fit model\n\nfit1 <- tree_spec %>%\n  fit(cases ~ ., data = res_prep)\n\n\nfit1 %>% extract_fit_engine() %>%\n  rpart.plot(roundint = FALSE)\n\n\n\n\n\naugment(fit1, new_data = res_prep) %>%\n    mae(truth = cases, estimate = .pred)\n\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 mae     standard       1256.\n\n\n\naugment(fit1, new_data = res_prep) %>%\n  select(cases, .pred) %>%\n  mutate(t = row_number()) %>%\n  pivot_longer(cols = c(\"cases\", \".pred\")) %>%\n  ggplot(aes(x = t, y = value, color = name)) +\n  geom_line() +\n  theme_bw()\n\n\n\n\n\nfit1 %>% \n  extract_fit_engine() %>% \n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#session-info",
    "href": "dengue-model/dengue_weather_lag_reg.html#session-info",
    "title": "Dengue and weather lags, regression task",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] vip_0.3.2          rpart.plot_3.1.1   rpart_4.1.16       timetk_2.8.3      \n [5] arrow_12.0.1       yardstick_1.2.0    workflowsets_1.0.1 workflows_1.1.3   \n [9] tune_1.1.1         rsample_1.1.1      recipes_1.0.6      parsnip_1.1.0     \n[13] modeldata_1.1.0    infer_1.0.4        dials_1.2.0        scales_1.2.1      \n[17] broom_1.0.5        tidymodels_1.1.0   lubridate_1.9.2    forcats_1.0.0     \n[21] stringr_1.5.0      dplyr_1.1.2        purrr_1.0.1        readr_2.1.4       \n[25] tidyr_1.3.0        tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         httr_1.4.6         \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            lazyeval_0.2.2     \n[10] colorspace_2.1-0    nnet_7.3-17         withr_2.5.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           plotly_4.10.2      \n[19] labeling_0.4.2      digest_0.6.31       rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     parallelly_1.36.0  \n[25] lhs_1.1.6           fastmap_1.1.1       htmlwidgets_1.6.2  \n[28] rlang_1.1.1         rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      zoo_1.8-12          jsonlite_1.8.5     \n[34] crosstalk_1.2.0     magrittr_2.0.3      Matrix_1.5-4.1     \n[37] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[40] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[43] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[46] grid_4.1.2          parallel_4.1.2      listenv_0.9.0      \n[49] lattice_0.20-45     splines_4.1.2       hms_1.1.3          \n[52] knitr_1.43          pillar_1.9.0        future.apply_1.11.0\n[55] codetools_0.2-18    glue_1.6.2          evaluate_0.21      \n[58] data.table_1.14.8   vctrs_0.6.3         tzdb_0.4.0         \n[61] foreach_1.5.2       gtable_0.3.3        future_1.32.0      \n[64] assertthat_0.2.1    xfun_0.39           gower_1.0.1        \n[67] prodlim_2023.03.31  viridisLite_0.4.2   class_7.3-20       \n[70] survival_3.2-13     timeDate_4022.108   iterators_1.0.14   \n[73] hardhat_1.3.0       lava_1.7.2.1        timechange_0.2.0   \n[76] globals_0.16.2      ellipsis_0.3.2      ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html",
    "href": "dengue-model/dengue_weather_lag_class.html",
    "title": "Dengue and weather lags, classification task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#dengue-data",
    "href": "dengue-model/dengue_weather_lag_class.html#dengue-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Dengue data",
    "text": "Dengue data\n\nSubset and aggregate\nRio de Janeiro, RJ, aggregated by month.\n\ndengue_rj <- open_dataset(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %>%\n  filter(mun == 330455) %>%\n  collect() %>%\n  summarise_by_time(.date_var = date, .by = \"month\", freq = sum(freq, na.rm = TRUE))\n\n\nplot_time_series(.data = dengue_rj, .date_var = date, .value = freq, .smooth = FALSE, .title = \"Dengue, absolute number of cases\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#classify",
    "href": "dengue-model/dengue_weather_lag_class.html#classify",
    "title": "Dengue and weather lags, classification task",
    "section": "Classify",
    "text": "Classify\n\nplot_anomaly_diagnostics(.data = dengue_rj, .date_var = date, .value = freq, .alpha = 0.10, .max_anomalies = 1, .legend_show = FALSE)\n\nfrequency = 12 observations per 1 year\n\n\ntrend = 60 observations per 5 years\n\n\n\n\n\n\n\ndengue_rj_anom <- tk_anomaly_diagnostics(.data = dengue_rj, .date_var = date, .value = freq, .alpha = 0.10, .max_anomalies = 1) %>%\n  select(date, anomaly) %>%\n  mutate(anomaly = as.factor(anomaly))\n\nfrequency = 12 observations per 1 year\n\n\ntrend = 60 observations per 5 years\n\n\n\ndengue_rj <- inner_join(dengue_rj, dengue_rj_anom) \n\nJoining with `by = join_by(date)`\n\n\n\nprop.table(table(dengue_rj$anomaly))\n\n\n       No       Yes \n0.8257576 0.1742424"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#weather-data",
    "href": "dengue-model/dengue_weather_lag_class.html#weather-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Weather data",
    "text": "Weather data\n\ntmax <- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"Tmax_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(tmax = value)\n\nprec <- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"pr_sum\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = sum(value, na.rm = TRUE)) %>%\n  rename(prec = value)\n\nprec_avg <- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"pr_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(prec_avg = value)\n\nrh <- open_dataset(sources = \"../weather-data/parquet/brdwgd/rh.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"RH_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(rh = value)\n\nwind <- open_dataset(sources = \"../weather-data/parquet/brdwgd/u2.parquet\") %>%\n  filter(code_muni == 3304557) %>%\n  filter(name == \"u2_mean\") %>%\n  select(date, value) %>%\n  collect() %>%\n  filter(date >= min(dengue_rj$date) & date <= max(dengue_rj$date)) %>%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %>%\n  rename(wind = value)\n\n\nplot_time_series(.data = tmax, .date_var = date, .value = tmax, .smooth = FALSE, .title = \"Max temp, average\")\n\n\n\n\n\n\nplot_time_series(.data = prec, .date_var = date, .value = prec, .smooth = FALSE, .title = \"Precipitation, sum\")\n\n\n\n\n\n\nplot_time_series(.data = prec_avg, .date_var = date, .value = prec_avg, .smooth = FALSE, .title = \"Precipitation, average\")\n\n\n\n\n\n\nplot_time_series(.data = rh, .date_var = date, .value = rh, .smooth = FALSE, .title = \"Relative humidity, average\")\n\n\n\n\n\n\nplot_time_series(.data = wind, .date_var = date, .value = wind, .smooth = FALSE, .title = \"Wind, average\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#join-data",
    "href": "dengue-model/dengue_weather_lag_class.html#join-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Join data",
    "text": "Join data\n\nres <- inner_join(x = dengue_rj, y = tmax, by = \"date\") %>%\n  inner_join(prec, by = \"date\") %>%\n  inner_join(prec_avg, by = \"date\") %>%\n  inner_join(rh, by = \"date\") %>%\n  inner_join(wind, by = \"date\") %>%\n  select(date, anomaly, tmax, prec, rh, wind)"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#decision-tree",
    "href": "dengue-model/dengue_weather_lag_class.html#decision-tree",
    "title": "Dengue and weather lags, classification task",
    "section": "Decision tree",
    "text": "Decision tree\n\nPrepare data\n\nRemove date\nLag variables: 12 months\n\n\nres_prep <- res %>%\n  select(-date) %>%\n  tk_augment_lags(.value = c(tmax, prec, rh, wind), .lags = 1:6)\n\n\n\nParameters\n\ntree_spec <- decision_tree() %>%\n  set_engine(\"rpart\") %>%\n  set_mode(\"classification\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#fit-model",
    "href": "dengue-model/dengue_weather_lag_class.html#fit-model",
    "title": "Dengue and weather lags, classification task",
    "section": "Fit model",
    "text": "Fit model\n\nfit1 <- tree_spec %>%\n  fit(anomaly ~ ., data = res_prep, model = TRUE)\n\n\nfit1 %>% extract_fit_engine() %>%\n  rpart.plot(roundint = FALSE)\n\n\n\n\n\naugment(fit1, new_data = res_prep) %>%\n    conf_mat(truth = anomaly, estimate = .pred_class)\n\n          Truth\nPrediction No Yes\n       No  91  10\n       Yes  1  13\n\n\n\naugment(fit1, new_data = res_prep) %>%\n    accuracy(truth = anomaly, estimate = .pred_class)\n\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy binary         0.904\n\n\n\nfit1 %>% \n  extract_fit_engine() %>% \n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#session-info",
    "href": "dengue-model/dengue_weather_lag_class.html#session-info",
    "title": "Dengue and weather lags, classification task",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] vip_0.3.2          rpart.plot_3.1.1   rpart_4.1.16       timetk_2.8.3      \n [5] arrow_12.0.1       yardstick_1.2.0    workflowsets_1.0.1 workflows_1.1.3   \n [9] tune_1.1.1         rsample_1.1.1      recipes_1.0.6      parsnip_1.1.0     \n[13] modeldata_1.1.0    infer_1.0.4        dials_1.2.0        scales_1.2.1      \n[17] broom_1.0.5        tidymodels_1.1.0   lubridate_1.9.2    forcats_1.0.0     \n[21] stringr_1.5.0      dplyr_1.1.2        purrr_1.0.1        readr_2.1.4       \n[25] tidyr_1.3.0        tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         httr_1.4.6         \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            lazyeval_0.2.2     \n[10] colorspace_2.1-0    nnet_7.3-17         withr_2.5.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           plotly_4.10.2      \n[19] labeling_0.4.2      digest_0.6.31       rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     parallelly_1.36.0  \n[25] lhs_1.1.6           fastmap_1.1.1       htmlwidgets_1.6.2  \n[28] rlang_1.1.1         rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      zoo_1.8-12          jsonlite_1.8.5     \n[34] crosstalk_1.2.0     magrittr_2.0.3      Matrix_1.5-4.1     \n[37] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[40] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[43] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[46] grid_4.1.2          parallel_4.1.2      listenv_0.9.0      \n[49] lattice_0.20-45     splines_4.1.2       hms_1.1.3          \n[52] knitr_1.43          pillar_1.9.0        future.apply_1.11.0\n[55] codetools_0.2-18    glue_1.6.2          evaluate_0.21      \n[58] data.table_1.14.8   vctrs_0.6.3         tzdb_0.4.0         \n[61] foreach_1.5.2       gtable_0.3.3        future_1.32.0      \n[64] assertthat_0.2.1    xfun_0.39           gower_1.0.1        \n[67] prodlim_2023.03.31  viridisLite_0.4.2   class_7.3-20       \n[70] survival_3.2-13     timeDate_4022.108   iterators_1.0.14   \n[73] hardhat_1.3.0       lava_1.7.2.1        timechange_0.2.0   \n[76] globals_0.16.2      ellipsis_0.3.2      ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html",
    "title": "Dengue case classification",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Dig deeper into tidy modeling with R at https://www.tmwr.org\n\nlibrary(finetune)\nlibrary(tictoc)\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#data",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#data",
    "title": "Dengue case classification",
    "section": "Data",
    "text": "Data\n\n# Data sources\nfiles_list &lt;- c(\n  \"../dengue-data/parquets/dengue_2016.parquet\",\n  \"../dengue-data/parquets/dengue_2017.parquet\",\n  \"../dengue-data/parquets/dengue_2018.parquet\",\n  \"../dengue-data/parquets/dengue_2019.parquet\",\n  \"../dengue-data/parquets/dengue_2020.parquet\",\n  \"../dengue-data/parquets/dengue_2021.parquet\"\n)\n\n# Independent variables\nx_vars &lt;- c(\"FEBRE\", \"MIALGIA\", \"CEFALEIA\", \n            \"EXANTEMA\", \"VOMITO\", \"NAUSEA\", \n            \"DOR_COSTAS\", \"CONJUNTVIT\", \n            \"ARTRITE\", \"ARTRALGIA\", \"PETEQUIA_N\", \n            \"LEUCOPENIA\", \"LACO\", \"DOR_RETRO\", \n            \"DIABETES\", \"HEMATOLOG\", \"HEPATOPAT\", \n            \"HEPATOPAT\", \"RENAL\", \"HIPERTENSA\",\n            \"ACIDO_PEPT\", \"AUTO_IMUNE\")\n\n# Prepare data\ndengue &lt;- arrow::open_dataset(sources = files_list) %&gt;%\n  # Select variables\n  select(all_of(c(\"CLASSI_FIN\", \"COMUNINF\", \"DT_SIN_PRI\", x_vars))) %&gt;%\n  # Filter out \"Inconclusivo\" cases\n  filter(CLASSI_FIN != \"Inconclusivo\") %&gt;%\n  # Collect data from parquet files\n  collect() %&gt;%\n  # Prepare variables\n  mutate(CLASSI_FIN = case_when(\n    CLASSI_FIN != \"Descartado\" ~ TRUE,\n    .default = FALSE\n  )) %&gt;%\n  mutate(CLASSI_FIN = as.factor(CLASSI_FIN)) %&gt;%\n  mutate(DT_SIN_PRI = as_date(DT_SIN_PRI)) %&gt;%\n  mutate(COMUNINF = as.factor(COMUNINF)) %&gt;%\n  mutate_at(.vars = x_vars, .funs = ~ . == \"Sim\") \n\n\n# Smaller dataset for tests\ndengue &lt;- sample_n(dengue, 100000)"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#modeling",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#modeling",
    "title": "Dengue case classification",
    "section": "Modeling",
    "text": "Modeling\n\nTrain and test dataset split\n\nset.seed(123)\n\ndengue_split &lt;- dengue %&gt;%\n  initial_split(strata = CLASSI_FIN)\n\ndengue_train &lt;- training(dengue_split)\ndengue_test &lt;- testing(dengue_split)\n\nset.seed(234)\ndengue_folds &lt;- vfold_cv(dengue_train, strata = CLASSI_FIN)\n\n\n\nRecipes\n\ndengue_rec_1 &lt;- \n  recipe(CLASSI_FIN ~ . , data = dengue_train) %&gt;%\n  step_date(DT_SIN_PRI, features = c(\"month\", \"week\", \"semester\", \"quarter\"), keep_original_cols = FALSE) %&gt;%\n  step_integer(all_predictors())\n\n\n\nSpecifications\n\nXGB\n\nxgb_spec &lt;-\n  boost_tree(\n    trees = tune(),\n    min_n = tune(),\n    mtry = tune(),\n    learn_rate = 0.01\n  ) %&gt;%\n  set_engine(\"xgboost\") %&gt;%\n  set_mode(\"classification\")\n\n\n\nDecision tree\n\ncart_spec &lt;-\n  decision_tree(\n    cost_complexity = tune(), \n    min_n = tune()\n  ) %&gt;% \n  set_engine(\"rpart\") %&gt;% \n  set_mode(\"classification\")\n\n\n\n\nWorkflows\n\nall_workflows &lt;- \n  workflow_set(\n    preproc = list(recipe_1 = dengue_rec_1),\n    models = list(xgb = xgb_spec, cart = cart_spec)\n  )\n\n\n\nTuning\n\ndoParallel::registerDoParallel()\n\nrace_ctrl &lt;-\n   control_race(\n      save_pred = TRUE,\n      parallel_over = \"everything\",\n      save_workflow = TRUE\n   )\n\ntic()\nrace_results &lt;- \n  all_workflows %&gt;%\n  workflow_map(\n    \"tune_race_anova\",\n    seed = 345,\n    resamples = dengue_folds,\n    grid = 15,\n    control = race_ctrl\n  )\n\ni Creating pre-processing data to finalize unknown parameter: mtry\n\n\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\nℹ The workflow being saved contains a recipe, which is 7.48 Mb in ℹ memory. If\nthis was not intentional, please set the control setting ℹ `save_workflow =\nFALSE`.\n\ntoc()\n\n700.27 sec elapsed\n\n\n\nRace metrics\n\ntrain_rank_results &lt;- rank_results(race_results, rank_metric = \"roc_auc\")\n\ntrain_rank_results\n\n# A tibble: 6 × 9\n  wflow_id      .config     .metric  mean std_err     n preprocessor model  rank\n  &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;int&gt;\n1 recipe_1_xgb  Preprocess… accura… 0.848 1.17e-3    10 recipe       boos…     1\n2 recipe_1_xgb  Preprocess… roc_auc 0.904 9.33e-4    10 recipe       boos…     1\n3 recipe_1_xgb  Preprocess… accura… 0.848 1.12e-3    10 recipe       boos…     2\n4 recipe_1_xgb  Preprocess… roc_auc 0.904 9.66e-4    10 recipe       boos…     2\n5 recipe_1_cart Preprocess… accura… 0.635 1.45e-3    10 recipe       deci…     3\n6 recipe_1_cart Preprocess… roc_auc 0.677 2.53e-3    10 recipe       deci…     3\n\n\n\nautoplot(race_results, metric = \"roc_auc\")\n\n\n\n\n\n\n\nLast fit\n\nselection_train &lt;- train_rank_results %&gt;%\n  arrange(-mean) %&gt;%\n  pull(wflow_id) %&gt;%\n  first()\n\nselection_train\n\n[1] \"recipe_1_xgb\"\n\n\n\nbest_results &lt;- race_results %&gt;%\n  extract_workflow_set_result(selection_train) %&gt;%\n  select_best(\"accuracy\")\n\nbest_results\n\n# A tibble: 1 × 4\n   mtry trees min_n .config              \n  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;                \n1     8  1536    11 Preprocessor1_Model05\n\n\n\nlast_fit &lt;- race_results %&gt;%\n  extract_workflow(selection_train) %&gt;%\n  finalize_workflow(best_results) %&gt;%\n  last_fit(dengue_split)\n\n\n\nEvaluate on test\n\ncollect_metrics(last_fit)\n\n# A tibble: 2 × 4\n  .metric  .estimator .estimate .config             \n  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 accuracy binary         0.847 Preprocessor1_Model1\n2 roc_auc  binary         0.905 Preprocessor1_Model1\n\n\n\ncollect_predictions(last_fit) %&gt;%\n    conf_mat(CLASSI_FIN, .pred_class)\n\n          Truth\nPrediction FALSE  TRUE\n     FALSE 10434  3590\n     TRUE    229 10748\n\n\n\nlast_fit %&gt;%\n  extract_fit_engine() %&gt;%\n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#session-info",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#session-info",
    "title": "Dengue case classification",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] rpart_4.1.16       rlang_1.1.1        xgboost_1.7.5.1    vip_0.3.2         \n [5] tictoc_1.2         finetune_1.1.0     yardstick_1.2.0    workflowsets_1.0.1\n [9] workflows_1.1.3    tune_1.1.1         rsample_1.1.1      recipes_1.0.6     \n[13] parsnip_1.1.0      modeldata_1.1.0    infer_1.0.4        dials_1.2.0       \n[17] scales_1.2.1       broom_1.0.5        tidymodels_1.1.0   knitr_1.43        \n[21] arrow_12.0.1       lubridate_1.9.2    forcats_1.0.0      stringr_1.5.0     \n[25] dplyr_1.1.2        purrr_1.0.1        readr_2.1.4        tidyr_1.3.0       \n[29] tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] nlme_3.1-155        bit64_4.0.5         doParallel_1.0.17  \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            colorspace_2.1-0   \n[10] nnet_7.3-17         withr_2.5.0         clock_0.7.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           labeling_0.4.2     \n[19] digest_0.6.31       minqa_1.2.5         rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     lme4_1.1-33        \n[25] parallelly_1.36.0   lhs_1.1.6           fastmap_1.1.1      \n[28] htmlwidgets_1.6.2   rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      jsonlite_1.8.5      magrittr_2.0.3     \n[34] Matrix_1.5-4.1      Rcpp_1.0.10         munsell_0.5.0      \n[37] fansi_1.0.4         GPfit_1.0-8         lifecycle_1.0.3    \n[40] furrr_0.3.1         stringi_1.7.12      yaml_2.3.7         \n[43] MASS_7.3-55         grid_4.1.2          parallel_4.1.2     \n[46] listenv_0.9.0       lattice_0.20-45     splines_4.1.2      \n[49] hms_1.1.3           pillar_1.9.0        boot_1.3-28        \n[52] future.apply_1.11.0 codetools_0.2-18    glue_1.6.2         \n[55] evaluate_0.21       data.table_1.14.8   nloptr_2.0.3       \n[58] vctrs_0.6.3         tzdb_0.4.0          foreach_1.5.2      \n[61] gtable_0.3.3        future_1.32.0       assertthat_0.2.1   \n[64] xfun_0.39           gower_1.0.1         prodlim_2023.03.31 \n[67] class_7.3-20        survival_3.2-13     timeDate_4022.108  \n[70] iterators_1.0.14    hardhat_1.3.0       lava_1.7.2.1       \n[73] timechange_0.2.0    globals_0.16.2      ellipsis_0.3.2     \n[76] ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#packages",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#packages",
    "title": "Dengue case classification",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Dig deeper into tidy modeling with R at https://www.tmwr.org\n\nlibrary(finetune)\nlibrary(tictoc)\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "software.html#brclimr",
    "href": "software.html#brclimr",
    "title": "Software",
    "section": "",
    "text": "An R package to on-line access zonal statistics from weather indicators that were calculated for each municipality in Brazil using data from the BR-DWGD and TerraClimate projects.\nMore details on https://rfsaldanha.github.io/brclimr"
  }
]