[
  {
    "objectID": "dengue-model/dengue_ts_global_model.html",
    "href": "dengue-model/dengue_ts_global_model.html",
    "title": "Global Model",
    "section": "",
    "text": "library(tidyverse)\nlibrary(arrow)\nlibrary(tidymodels)\nlibrary(finetune)\nlibrary(modeltime)\nlibrary(timetk)\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#packages",
    "href": "dengue-model/dengue_ts_global_model.html#packages",
    "title": "Global Model",
    "section": "",
    "text": "library(tidyverse)\nlibrary(arrow)\nlibrary(tidymodels)\nlibrary(finetune)\nlibrary(modeltime)\nlibrary(timetk)\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#load-data",
    "href": "dengue-model/dengue_ts_global_model.html#load-data",
    "title": "Global Model",
    "section": "Load data",
    "text": "Load data\nAnd remove rows with NAs\n\ntdengue &lt;- read_parquet(file = \"tdengue.parquet\") %&gt;%\n  drop_na()"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#cluster",
    "href": "dengue-model/dengue_ts_global_model.html#cluster",
    "title": "Global Model",
    "section": "Cluster",
    "text": "Cluster\nAssign random groups. To use a cluster algorithm later.\n\ntdengue &lt;- tdengue %&gt;%\n  mutate(group = sample(x = 4, size = nrow(.), replace = TRUE))"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#train-and-test-split",
    "href": "dengue-model/dengue_ts_global_model.html#train-and-test-split",
    "title": "Global Model",
    "section": "Train and test split",
    "text": "Train and test split\n\ntdengue_split &lt;- tdengue %&gt;%\n  time_series_split(\n    date_var = date, \n    assess = 24,\n    cumulative = TRUE\n  )\n\nData is not ordered by the 'date_var'. Resamples will be arranged by `date`.\n\n\nOverlapping Timestamps Detected. Processing overlapping time series together using sliding windows.\n\n\n\nsaveRDS(object = tdengue_split, file = \"tdengue_split.rds\")"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#k-folds",
    "href": "dengue-model/dengue_ts_global_model.html#k-folds",
    "title": "Global Model",
    "section": "K-folds",
    "text": "K-folds\n\ntdengue_split_folds &lt;- training(tdengue_split) %&gt;%\n  vfold_cv(v = 10)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#recipes",
    "href": "dengue-model/dengue_ts_global_model.html#recipes",
    "title": "Global Model",
    "section": "Recipes",
    "text": "Recipes\n\nGlobal\nUsing data from all municipalities.\n\nrecipe_global &lt;- recipe(cases ~ ., data = training(tdengue_split)) %&gt;%\n  step_rm(mun, group)\n\n\n\nGroups\nOne recipe for each group, with data only from the group.\n\nrecipe_group1 &lt;- recipe(cases ~ ., data = training(tdengue_split)) %&gt;%\n  step_filter(group == 1) %&gt;%\n  step_rm(mun, group)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#models",
    "href": "dengue-model/dengue_ts_global_model.html#models",
    "title": "Global Model",
    "section": "Models",
    "text": "Models\n\nRandom forest\n\nrf_spec &lt;- rand_forest(\n  mtry = tune(),\n  trees = tune(),\n  min_n = tune()\n) %&gt;%\n  set_engine(\"ranger\") %&gt;%\n  set_mode(\"regression\")"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#workflow",
    "href": "dengue-model/dengue_ts_global_model.html#workflow",
    "title": "Global Model",
    "section": "Workflow",
    "text": "Workflow\n\nrf_wf_global &lt;- workflow() %&gt;%\n  add_recipe(recipe_global) %&gt;%\n  add_model(rf_spec)\n\nrf_wf_group1 &lt;- workflow() %&gt;%\n  add_recipe(recipe_group1) %&gt;%\n  add_model(rf_spec)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#prepare-parallel-computation",
    "href": "dengue-model/dengue_ts_global_model.html#prepare-parallel-computation",
    "title": "Global Model",
    "section": "Prepare parallel computation",
    "text": "Prepare parallel computation\n\ndoParallel::registerDoParallel()"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#tune",
    "href": "dengue-model/dengue_ts_global_model.html#tune",
    "title": "Global Model",
    "section": "Tune",
    "text": "Tune\n\nset.seed(123)\n\ngrid_spec &lt;- grid_latin_hypercube(\n  extract_parameter_set_dials(rf_spec) %&gt;% \n    update(mtry = mtry(range = c(1, 10))), # 1, 20\n  size = 10 # 20 \n)\n\n\ntic()\ntune_results_race_global &lt;- tune_race_anova(\n  object = rf_wf_global, \n  resamples = tdengue_split_folds, \n  grid = grid_spec, \n  control = control_race(parallel_over = \"everything\")\n)\ntoc()\n\n72.81 sec elapsed\n\n\n\ntic()\ntune_results_race_group1 &lt;- tune_race_anova(\n  object = rf_wf_group1, \n  resamples = tdengue_split_folds, \n  grid = grid_spec, \n  control = control_race(parallel_over = \"everything\")\n)\ntoc()\n\n15.45 sec elapsed\n\n\n\ntune_results_race_global %&gt;% show_best()\n\nWarning: No value of `metric` was given; metric 'rmse' will be used.\n\n\n# A tibble: 1 × 9\n   mtry trees min_n .metric .estimator  mean     n std_err .config              \n  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                \n1    10   773     6 rmse    standard    156.    10    19.6 Preprocessor1_Model05\n\n\n\ntune_results_race_group1 %&gt;% show_best()\n\nWarning: No value of `metric` was given; metric 'rmse' will be used.\n\n\n# A tibble: 1 × 9\n   mtry trees min_n .metric .estimator  mean     n std_err .config              \n  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                \n1    10   773     6 rmse    standard    176.    10    24.4 Preprocessor1_Model05"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#select-and-fit-best-model",
    "href": "dengue-model/dengue_ts_global_model.html#select-and-fit-best-model",
    "title": "Global Model",
    "section": "Select and fit best model",
    "text": "Select and fit best model\n\nGlobal\n\nbest_fit &lt;- rf_wf_global %&gt;%\n  finalize_workflow(select_best(tune_results_race_global, \"rmse\", n = 1)) %&gt;%\n  fit(training(tdengue_split))\n\n\nmodeltime_table(best_fit) %&gt;%\n  modeltime_calibrate(testing(tdengue_split)) %&gt;%\n  modeltime_accuracy()\n\nℹ We have detected a possible intermittent series, you can change the default metric set to the extended_forecast_accuracy_metric_set() containing the MAAPE metric, which is more appropriate for this type of series.\n\n\n# A tibble: 1 × 9\n  .model_id .model_desc .type   mae  mape  mase smape  rmse   rsq\n      &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1         1 RANGER      Test   75.9   Inf 0.495  78.3  213. 0.670\n\n\n\nmodeltime_table(best_fit) %&gt;%\n  modeltime_calibrate(testing(tdengue_split)) %&gt;%\n  modeltime_forecast(\n    new_data = testing(tdengue_split),\n    actual_data = tdengue,\n    keep_data = TRUE\n  ) %&gt;%\n  filter(mun == 330455) %&gt;%\n  plot_modeltime_forecast(.conf_interval_show = FALSE)\n\n\n\n\n\n\n\nGroup 1\n\nbest_fit &lt;- rf_wf_group1 %&gt;%\n  finalize_workflow(select_best(tune_results_race_group1, \"rmse\", n = 1)) %&gt;%\n  fit(training(tdengue_split))\n\n\nmodeltime_table(best_fit) %&gt;%\n  modeltime_calibrate(testing(tdengue_split)) %&gt;%\n  modeltime_accuracy()\n\nℹ We have detected a possible intermittent series, you can change the default metric set to the extended_forecast_accuracy_metric_set() containing the MAAPE metric, which is more appropriate for this type of series.\n\n\n# A tibble: 1 × 9\n  .model_id .model_desc .type   mae  mape  mase smape  rmse   rsq\n      &lt;int&gt; &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1         1 RANGER      Test   80.4   Inf 0.525  82.7  213. 0.674\n\n\n\nmodeltime_table(best_fit) %&gt;%\n  modeltime_calibrate(testing(tdengue_split)) %&gt;%\n  modeltime_forecast(\n    new_data = testing(tdengue_split),\n    actual_data = tdengue,\n    keep_data = TRUE\n  ) %&gt;%\n  filter(mun == 330455) %&gt;%\n  plot_modeltime_forecast(.conf_interval_show = FALSE)"
  },
  {
    "objectID": "dengue-model/dengue_ts_global_model.html#session-info",
    "href": "dengue-model/dengue_ts_global_model.html#session-info",
    "title": "Global Model",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] rlang_1.1.1        ranger_0.15.1      tictoc_1.2         timetk_2.8.3      \n [5] modeltime_1.2.6    finetune_1.1.0     yardstick_1.2.0    workflowsets_1.0.1\n [9] workflows_1.1.3    tune_1.1.1         rsample_1.1.1      recipes_1.0.6     \n[13] parsnip_1.1.0      modeldata_1.1.0    infer_1.0.4        dials_1.2.0       \n[17] scales_1.2.1       broom_1.0.5        tidymodels_1.1.0   arrow_12.0.1      \n[21] lubridate_1.9.2    forcats_1.0.0      stringr_1.5.0      dplyr_1.1.2       \n[25] purrr_1.0.1        readr_2.1.4        tidyr_1.3.0        tibble_3.2.1      \n[29] ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] minqa_1.2.5         colorspace_2.1-0    ellipsis_0.3.2     \n [4] class_7.3-20        rstudioapi_0.14     listenv_0.9.0      \n [7] furrr_0.3.1         bit64_4.0.5         prodlim_2023.03.31 \n[10] fansi_1.0.4         codetools_0.2-18    splines_4.1.2      \n[13] doParallel_1.0.17   knitr_1.43          jsonlite_1.8.5     \n[16] nloptr_2.0.3        httr_1.4.6          compiler_4.1.2     \n[19] backports_1.4.1     lazyeval_0.2.2      assertthat_0.2.1   \n[22] Matrix_1.5-4.1      fastmap_1.1.1       cli_3.6.1          \n[25] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n[28] glue_1.6.2          Rcpp_1.0.10         DiceDesign_1.9     \n[31] vctrs_0.6.3         nlme_3.1-155        crosstalk_1.2.0    \n[34] iterators_1.0.14    timeDate_4022.108   gower_1.0.1        \n[37] xfun_0.39           globals_0.16.2      lme4_1.1-33        \n[40] timechange_0.2.0    lifecycle_1.0.3     future_1.32.0      \n[43] MASS_7.3-55         zoo_1.8-12          ipred_0.9-14       \n[46] hms_1.1.3           parallel_4.1.2      yaml_2.3.7         \n[49] StanHeaders_2.26.27 rpart_4.1.16        stringi_1.7.12     \n[52] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n[55] boot_1.3-28         lava_1.7.2.1        pkgconfig_2.0.3    \n[58] evaluate_0.21       lattice_0.20-45     labeling_0.4.2     \n[61] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n[64] parallelly_1.36.0   magrittr_2.0.3      R6_2.5.1           \n[67] generics_0.1.3      pillar_1.9.0        withr_2.5.0        \n[70] xts_0.13.1          survival_3.2-13     nnet_7.3-17        \n[73] future.apply_1.11.0 utf8_1.2.3          plotly_4.10.2      \n[76] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n[79] data.table_1.14.8   digest_0.6.31       RcppParallel_5.1.7 \n[82] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html",
    "href": "dengue-model/dengue_weather_lag_class.html",
    "title": "Dengue and weather lags, classification task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#packages",
    "href": "dengue-model/dengue_weather_lag_class.html#packages",
    "title": "Dengue and weather lags, classification task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#dengue-data",
    "href": "dengue-model/dengue_weather_lag_class.html#dengue-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Dengue data",
    "text": "Dengue data\n\nSubset and aggregate\nRio de Janeiro, RJ, aggregated by month.\n\ndengue_rj &lt;- open_dataset(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %&gt;%\n  filter(mun == 330455) %&gt;%\n  collect() %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", freq = sum(freq, na.rm = TRUE))\n\n\nplot_time_series(.data = dengue_rj, .date_var = date, .value = freq, .smooth = FALSE, .title = \"Dengue, absolute number of cases\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#classify",
    "href": "dengue-model/dengue_weather_lag_class.html#classify",
    "title": "Dengue and weather lags, classification task",
    "section": "Classify",
    "text": "Classify\n\nplot_anomaly_diagnostics(.data = dengue_rj, .date_var = date, .value = freq, .alpha = 0.10, .max_anomalies = 1, .legend_show = FALSE)\n\nfrequency = 12 observations per 1 year\n\n\ntrend = 60 observations per 5 years\n\n\n\n\n\n\n\ndengue_rj_anom &lt;- tk_anomaly_diagnostics(.data = dengue_rj, .date_var = date, .value = freq, .alpha = 0.10, .max_anomalies = 1) %&gt;%\n  select(date, anomaly) %&gt;%\n  mutate(anomaly = as.factor(anomaly))\n\nfrequency = 12 observations per 1 year\n\n\ntrend = 60 observations per 5 years\n\n\n\ndengue_rj &lt;- inner_join(dengue_rj, dengue_rj_anom) \n\nJoining with `by = join_by(date)`\n\n\n\nprop.table(table(dengue_rj$anomaly))\n\n\n       No       Yes \n0.8257576 0.1742424"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#weather-data",
    "href": "dengue-model/dengue_weather_lag_class.html#weather-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Weather data",
    "text": "Weather data\n\ntmax &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"Tmax_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(tmax = value)\n\nprec &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"pr_sum\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = sum(value, na.rm = TRUE)) %&gt;%\n  rename(prec = value)\n\nprec_avg &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"pr_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(prec_avg = value)\n\nrh &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/rh.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"RH_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(rh = value)\n\nwind &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/u2.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"u2_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(wind = value)\n\n\nplot_time_series(.data = tmax, .date_var = date, .value = tmax, .smooth = FALSE, .title = \"Max temp, average\")\n\n\n\n\n\n\nplot_time_series(.data = prec, .date_var = date, .value = prec, .smooth = FALSE, .title = \"Precipitation, sum\")\n\n\n\n\n\n\nplot_time_series(.data = prec_avg, .date_var = date, .value = prec_avg, .smooth = FALSE, .title = \"Precipitation, average\")\n\n\n\n\n\n\nplot_time_series(.data = rh, .date_var = date, .value = rh, .smooth = FALSE, .title = \"Relative humidity, average\")\n\n\n\n\n\n\nplot_time_series(.data = wind, .date_var = date, .value = wind, .smooth = FALSE, .title = \"Wind, average\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#join-data",
    "href": "dengue-model/dengue_weather_lag_class.html#join-data",
    "title": "Dengue and weather lags, classification task",
    "section": "Join data",
    "text": "Join data\n\nres &lt;- inner_join(x = dengue_rj, y = tmax, by = \"date\") %&gt;%\n  inner_join(prec, by = \"date\") %&gt;%\n  inner_join(prec_avg, by = \"date\") %&gt;%\n  inner_join(rh, by = \"date\") %&gt;%\n  inner_join(wind, by = \"date\") %&gt;%\n  select(date, anomaly, tmax, prec, rh, wind)"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#decision-tree",
    "href": "dengue-model/dengue_weather_lag_class.html#decision-tree",
    "title": "Dengue and weather lags, classification task",
    "section": "Decision tree",
    "text": "Decision tree\n\nPrepare data\n\nRemove date\nLag variables: 12 months\n\n\nres_prep &lt;- res %&gt;%\n  select(-date) %&gt;%\n  tk_augment_lags(.value = c(tmax, prec, rh, wind), .lags = 1:6)\n\n\n\nParameters\n\ntree_spec &lt;- decision_tree() %&gt;%\n  set_engine(\"rpart\") %&gt;%\n  set_mode(\"classification\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#fit-model",
    "href": "dengue-model/dengue_weather_lag_class.html#fit-model",
    "title": "Dengue and weather lags, classification task",
    "section": "Fit model",
    "text": "Fit model\n\nfit1 &lt;- tree_spec %&gt;%\n  fit(anomaly ~ ., data = res_prep, model = TRUE)\n\n\nfit1 %&gt;% extract_fit_engine() %&gt;%\n  rpart.plot(roundint = FALSE)\n\n\n\n\n\naugment(fit1, new_data = res_prep) %&gt;%\n    conf_mat(truth = anomaly, estimate = .pred_class)\n\n          Truth\nPrediction No Yes\n       No  91  10\n       Yes  1  13\n\n\n\naugment(fit1, new_data = res_prep) %&gt;%\n    accuracy(truth = anomaly, estimate = .pred_class)\n\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;\n1 accuracy binary         0.904\n\n\n\nfit1 %&gt;% \n  extract_fit_engine() %&gt;% \n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_class.html#session-info",
    "href": "dengue-model/dengue_weather_lag_class.html#session-info",
    "title": "Dengue and weather lags, classification task",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] vip_0.3.2          rpart.plot_3.1.1   rpart_4.1.16       timetk_2.8.3      \n [5] arrow_12.0.1       yardstick_1.2.0    workflowsets_1.0.1 workflows_1.1.3   \n [9] tune_1.1.1         rsample_1.1.1      recipes_1.0.6      parsnip_1.1.0     \n[13] modeldata_1.1.0    infer_1.0.4        dials_1.2.0        scales_1.2.1      \n[17] broom_1.0.5        tidymodels_1.1.0   lubridate_1.9.2    forcats_1.0.0     \n[21] stringr_1.5.0      dplyr_1.1.2        purrr_1.0.1        readr_2.1.4       \n[25] tidyr_1.3.0        tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         httr_1.4.6         \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            lazyeval_0.2.2     \n[10] colorspace_2.1-0    nnet_7.3-17         withr_2.5.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           plotly_4.10.2      \n[19] labeling_0.4.2      digest_0.6.31       rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     parallelly_1.36.0  \n[25] lhs_1.1.6           fastmap_1.1.1       htmlwidgets_1.6.2  \n[28] rlang_1.1.1         rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      zoo_1.8-12          jsonlite_1.8.5     \n[34] crosstalk_1.2.0     magrittr_2.0.3      Matrix_1.5-4.1     \n[37] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[40] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[43] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[46] grid_4.1.2          parallel_4.1.2      listenv_0.9.0      \n[49] lattice_0.20-45     splines_4.1.2       hms_1.1.3          \n[52] knitr_1.43          pillar_1.9.0        future.apply_1.11.0\n[55] codetools_0.2-18    glue_1.6.2          evaluate_0.21      \n[58] data.table_1.14.8   vctrs_0.6.3         tzdb_0.4.0         \n[61] foreach_1.5.2       gtable_0.3.3        future_1.32.0      \n[64] assertthat_0.2.1    xfun_0.39           gower_1.0.1        \n[67] prodlim_2023.03.31  viridisLite_0.4.2   class_7.3-20       \n[70] survival_3.2-13     timeDate_4022.108   iterators_1.0.14   \n[73] hardhat_1.3.0       lava_1.7.2.1        timechange_0.2.0   \n[76] globals_0.16.2      ellipsis_0.3.2      ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html",
    "href": "dengue-model/dengue_ts_data.html",
    "title": "Data preparing",
    "section": "",
    "text": "library(tidyverse)\nlibrary(arrow)\nlibrary(brpop)\nlibrary(tidymodels)\nlibrary(timetk)"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html#packages",
    "href": "dengue-model/dengue_ts_data.html#packages",
    "title": "Data preparing",
    "section": "",
    "text": "library(tidyverse)\nlibrary(arrow)\nlibrary(brpop)\nlibrary(tidymodels)\nlibrary(timetk)"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html#data",
    "href": "dengue-model/dengue_ts_data.html#data",
    "title": "Data preparing",
    "section": "Data",
    "text": "Data\n\nDengue\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %&gt;%\n  group_by(mun) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  rename(cases = freq)\n\n\n\nPopulation\n\npop &lt;- mun_pop_totals() %&gt;%\n  filter(year %in% seq(year(min(dengue$date)), year(max(dengue$date)))) %&gt;%\n  mutate(mun = as.character(mun))\n\n\n\nPrecipitation\n\nprec &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(name == \"pr_sum\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue$date) & date &lt;= max(dengue$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = sum(value, na.rm = TRUE)) %&gt;%\n  rename(prec = value)\n\n\n\nAverage maximum temperature\n\ntmax &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %&gt;%\n  filter(name == \"Tmax_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue$date) & date &lt;= max(dengue$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(tmax = value)\n\n\n\nJoin data\n\ntdengue &lt;- dengue %&gt;%\n  mutate(dengue_year = year(date)) %&gt;%\n  inner_join(pop, by = c(\"dengue_year\" = \"year\", \"mun\")) %&gt;%\n  select(-dengue_year) %&gt;%\n  inner_join(prec, by = \"date\") %&gt;%\n  inner_join(tmax, by = \"date\")\n\nrm(dengue, pop, prec, tmax)\n\n\n\nCleaning and basic features\n\ntdengue &lt;- tdengue %&gt;%\n  # Remove municipalilities with zero population\n  filter(pop != 0) %&gt;%\n  # Keep only municipalities series with more than 10000 cases total\n  group_by(mun) %&gt;%\n  mutate(total = sum(cases, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 10000) %&gt;%\n  select(-total) %&gt;%\n  # Compute dengue rate per population\n  mutate(cases = cases/pop*100000) %&gt;%\n  # Remove population\n  select(-pop) %&gt;%\n  # Round values\nmutate(across(c(cases, prec, tmax), ~ round(.x, digits = 2)))\n\nMunicipalities remaining at the dataset: 120\n\n\nStandardize measures\n\n# tdengue &lt;- tdengue %&gt;%\n#   group_by(mun) %&gt;%\n#   mutate(across(c(cases, prec, tmax), ~ standardize_vec(.x, silent = TRUE))) %&gt;%\n#   ungroup()\n\n\n\nLag and rolling lag variables\n\ntdengue &lt;- tdengue %&gt;%\n  group_by(mun) %&gt;%\n  tk_augment_lags(.value = c(cases, prec, tmax), .lags = 1:12) %&gt;%\n  # tk_augment_slidify(\n  #   .value = contains(\"_lag\"), \n  #   .period = c(2, 3, 4, 6, 8, 12), \n  #   .f = ~ mean(.x, na.rm = TRUE), \n  #   .partial = TRUE,\n  #   .align   = \"center\"\n  # ) %&gt;%\n  ungroup()"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html#overview",
    "href": "dengue-model/dengue_ts_data.html#overview",
    "title": "Data preparing",
    "section": "Overview",
    "text": "Overview\n\nglimpse(tdengue)\n\nRows: 13,772\nColumns: 41\n$ mun         &lt;chr&gt; \"120020\", \"120020\", \"120020\", \"120020\", \"120020\", \"120020\"…\n$ date        &lt;date&gt; 2011-01-01, 2011-02-01, 2011-03-01, 2011-04-01, 2011-05-0…\n$ cases       &lt;dbl&gt; 31.46, 21.78, 15.73, 2.42, 0.00, 1.21, 0.00, 1.21, 0.00, 1…\n$ prec        &lt;dbl&gt; 29442223, 27648413, 30775654, 22400880, 13694424, 8046289,…\n$ tmax        &lt;dbl&gt; 30.52, 30.57, 29.35, 28.96, 26.87, 26.17, 26.73, 28.43, 29…\n$ cases_lag1  &lt;dbl&gt; NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1.21, 0.00, 1.21, 0.0…\n$ prec_lag1   &lt;dbl&gt; NA, 29442223, 27648413, 30775654, 22400880, 13694424, 8046…\n$ tmax_lag1   &lt;dbl&gt; NA, 30.52, 30.57, 29.35, 28.96, 26.87, 26.17, 26.73, 28.43…\n$ cases_lag2  &lt;dbl&gt; NA, NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1.21, 0.00, 1.21,…\n$ prec_lag2   &lt;dbl&gt; NA, NA, 29442223, 27648413, 30775654, 22400880, 13694424, …\n$ tmax_lag2   &lt;dbl&gt; NA, NA, 30.52, 30.57, 29.35, 28.96, 26.87, 26.17, 26.73, 2…\n$ cases_lag3  &lt;dbl&gt; NA, NA, NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1.21, 0.00, 1…\n$ prec_lag3   &lt;dbl&gt; NA, NA, NA, 29442223, 27648413, 30775654, 22400880, 136944…\n$ tmax_lag3   &lt;dbl&gt; NA, NA, NA, 30.52, 30.57, 29.35, 28.96, 26.87, 26.17, 26.7…\n$ cases_lag4  &lt;dbl&gt; NA, NA, NA, NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1.21, 0.0…\n$ prec_lag4   &lt;dbl&gt; NA, NA, NA, NA, 29442223, 27648413, 30775654, 22400880, 13…\n$ tmax_lag4   &lt;dbl&gt; NA, NA, NA, NA, 30.52, 30.57, 29.35, 28.96, 26.87, 26.17, …\n$ cases_lag5  &lt;dbl&gt; NA, NA, NA, NA, NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1.21,…\n$ prec_lag5   &lt;dbl&gt; NA, NA, NA, NA, NA, 29442223, 27648413, 30775654, 22400880…\n$ tmax_lag5   &lt;dbl&gt; NA, NA, NA, NA, NA, 30.52, 30.57, 29.35, 28.96, 26.87, 26.…\n$ cases_lag6  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 31.46, 21.78, 15.73, 2.42, 0.00, 1…\n$ prec_lag6   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 29442223, 27648413, 30775654, 2240…\n$ tmax_lag6   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, 30.52, 30.57, 29.35, 28.96, 26.87,…\n$ cases_lag7  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 31.46, 21.78, 15.73, 2.42, 0.0…\n$ prec_lag7   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 29442223, 27648413, 30775654, …\n$ tmax_lag7   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, 30.52, 30.57, 29.35, 28.96, 26…\n$ cases_lag8  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 31.46, 21.78, 15.73, 2.42,…\n$ prec_lag8   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 29442223, 27648413, 307756…\n$ tmax_lag8   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 30.52, 30.57, 29.35, 28.96…\n$ cases_lag9  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 31.46, 21.78, 15.73, 2…\n$ prec_lag9   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 29442223, 27648413, 30…\n$ tmax_lag9   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, 30.52, 30.57, 29.35, 2…\n$ cases_lag10 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 31.46, 21.78, 15.7…\n$ prec_lag10  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 29442223, 27648413…\n$ tmax_lag10  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 30.52, 30.57, 29.3…\n$ cases_lag11 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 31.46, 21.78, …\n$ prec_lag11  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 29442223, 2764…\n$ tmax_lag11  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 30.52, 30.57, …\n$ cases_lag12 &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 31.46, 21.…\n$ prec_lag12  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 29442223, …\n$ tmax_lag12  &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 30.52, 30.…"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html#save-result",
    "href": "dengue-model/dengue_ts_data.html#save-result",
    "title": "Data preparing",
    "section": "Save result",
    "text": "Save result\n\nwrite_parquet(x = tdengue, sink = \"tdengue.parquet\")"
  },
  {
    "objectID": "dengue-model/dengue_ts_data.html#session-info",
    "href": "dengue-model/dengue_ts_data.html#session-info",
    "title": "Data preparing",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] timetk_2.8.3       yardstick_1.2.0    workflowsets_1.0.1 workflows_1.1.3   \n [5] tune_1.1.1         rsample_1.1.1      recipes_1.0.6      parsnip_1.1.0     \n [9] modeldata_1.1.0    infer_1.0.4        dials_1.2.0        scales_1.2.1      \n[13] broom_1.0.5        tidymodels_1.1.0   brpop_0.3.0        arrow_12.0.1      \n[17] lubridate_1.9.2    forcats_1.0.0      stringr_1.5.0      dplyr_1.1.2       \n[21] purrr_1.0.1        readr_2.1.4        tidyr_1.3.0        tibble_3.2.1      \n[25] ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         DiceDesign_1.9     \n [4] tools_4.1.2         backports_1.4.1     utf8_1.2.3         \n [7] R6_2.5.1            rpart_4.1.16        colorspace_2.1-0   \n[10] nnet_7.3-17         withr_2.5.0         tidyselect_1.2.0   \n[13] bit_4.0.5           compiler_4.1.2      cli_3.6.1          \n[16] digest_0.6.31       rmarkdown_2.22      pkgconfig_2.0.3    \n[19] htmltools_0.5.5     parallelly_1.36.0   lhs_1.1.6          \n[22] fastmap_1.1.1       htmlwidgets_1.6.2   rlang_1.1.1        \n[25] rstudioapi_0.14     generics_0.1.3      zoo_1.8-12         \n[28] jsonlite_1.8.5      magrittr_2.0.3      Matrix_1.5-4.1     \n[31] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[34] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[37] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[40] grid_4.1.2          parallel_4.1.2      listenv_0.9.0      \n[43] lattice_0.20-45     splines_4.1.2       hms_1.1.3          \n[46] knitr_1.43          pillar_1.9.0        future.apply_1.11.0\n[49] codetools_0.2-18    glue_1.6.2          evaluate_0.21      \n[52] data.table_1.14.8   vctrs_0.6.3         tzdb_0.4.0         \n[55] foreach_1.5.2       gtable_0.3.3        future_1.32.0      \n[58] assertthat_0.2.1    xfun_0.39           gower_1.0.1        \n[61] prodlim_2023.03.31  class_7.3-20        survival_3.2-13    \n[64] timeDate_4022.108   iterators_1.0.14    hardhat_1.3.0      \n[67] lava_1.7.2.1        timechange_0.2.0    globals_0.16.2     \n[70] ipred_0.9-14"
  },
  {
    "objectID": "cluster_analysis.html",
    "href": "cluster_analysis.html",
    "title": "Overview",
    "section": "",
    "text": "On this section there are notebooks that cluster municipalities time series of dengue cases with different strategies.\n\n\n\n Back to top"
  },
  {
    "objectID": "publications.html",
    "href": "publications.html",
    "title": "Publications",
    "section": "",
    "text": "Back to top"
  },
  {
    "objectID": "socioeconomic-data/socioeconomic_data.html",
    "href": "socioeconomic-data/socioeconomic_data.html",
    "title": "Socio economic data",
    "section": "",
    "text": "library(tidyverse)\nlibrary(janitor)\nlibrary(arrow)"
  },
  {
    "objectID": "socioeconomic-data/socioeconomic_data.html#packages",
    "href": "socioeconomic-data/socioeconomic_data.html#packages",
    "title": "Socio economic data",
    "section": "",
    "text": "library(tidyverse)\nlibrary(janitor)\nlibrary(arrow)"
  },
  {
    "objectID": "socioeconomic-data/socioeconomic_data.html#hdi",
    "href": "socioeconomic-data/socioeconomic_data.html#hdi",
    "title": "Socio economic data",
    "section": "HDI",
    "text": "HDI\n\nhdi &lt;- read_delim(\n  file = \"../socioeconomic-data/idhm.csv\",\n  delim = \",\", locale=locale(decimal_mark = \".\"), \n  na = \"-\",\n  col_types = cols(\n    CD_GEOCMU = col_character(),\n    Município = col_character(),\n    CodEstado = col_character(),\n    Estado = col_character(),\n    IDHM1991 = col_double(),\n    IDHMR1991 = col_double(),\n    IDHML1991 = col_double(),\n    IDHME1991 = col_double(),\n    R1991 = col_double(),\n    IDHM2000 = col_double(),\n    IDHMR2000 = col_double(),\n    IDHML2000 = col_double(),\n    IDHME2000 = col_double(),\n    R2000 = col_double(),\n    IDHM2010 = col_double(),\n    IDHMR2010 = col_double(),\n    IDHML2010 = col_double(),\n    IDHME2010 = col_double(),\n    R2010 = col_double(),\n    NM_MUNNICIP = col_character()\n  )\n) %&gt;%\n  clean_names() %&gt;%\n  rename(code_muni = cd_geocmu, name_muni = municipio, code_uf = cod_estado, uf = estado) %&gt;%\n  select(-nm_munnicip) %&gt;%\n  mutate(code_muni = substr(code_muni, 0, 6))"
  },
  {
    "objectID": "socioeconomic-data/socioeconomic_data.html#export",
    "href": "socioeconomic-data/socioeconomic_data.html#export",
    "title": "Socio economic data",
    "section": "Export",
    "text": "Export\n\nwrite_parquet(x = hdi, sink = \"hdi.parquet\")"
  },
  {
    "objectID": "presentations.html",
    "href": "presentations.html",
    "title": "Overview",
    "section": "",
    "text": "Back to top"
  },
  {
    "objectID": "dengue-data/missing_data.html",
    "href": "dengue-data/missing_data.html",
    "title": "Missing data analysis",
    "section": "",
    "text": "This report presents a missing data analysis from the raw parquet files.\nConsidering the high number of variables, this report will use a subset of the most relevant ones for this research."
  },
  {
    "objectID": "dengue-data/missing_data.html#context",
    "href": "dengue-data/missing_data.html#context",
    "title": "Missing data analysis",
    "section": "",
    "text": "This report presents a missing data analysis from the raw parquet files.\nConsidering the high number of variables, this report will use a subset of the most relevant ones for this research."
  },
  {
    "objectID": "dengue-data/missing_data.html#packages",
    "href": "dengue-data/missing_data.html#packages",
    "title": "Missing data analysis",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\nlibrary(arrow)\nlibrary(naniar)\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/missing_data.html#load-data",
    "href": "dengue-data/missing_data.html#load-data",
    "title": "Missing data analysis",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars &lt;- c(\"ID_AGRAVO\", \"DT_NOTIFIC\", \"ID_UNIDADE\",\n                    \"DT_SIN_PRI\", \"CS_SEXO\", \"CS_GESTANT\",\n                    \"CS_RACA\", \"CS_ESCOL_N\", \"ID_MN_RESI\",\n                    \"COUFINF\", \"COMUNINF\", \"ID_OCUPA_N\",\n                    \"DT_SORO\", \"RESUL_SORO\", \"SOROTIPO\", \n                    \"CLASSI_FIN\", \"CRITERIO\", \"EVOLUCAO\",\n                    \"DT_OBITO\", \"HOSPITALIZ\", \"DT_INTERNA\")\n\ndengue &lt;- open_dataset(sources = \"parquets/\") %&gt;%\n  select(all_of(important_vars)) %&gt;%\n  collect()"
  },
  {
    "objectID": "dengue-data/missing_data.html#overall",
    "href": "dengue-data/missing_data.html#overall",
    "title": "Missing data analysis",
    "section": "Overall",
    "text": "Overall\nConsidering all records.\n\ndengue %&gt;% \n  miss_var_summary() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nvariable\nn_miss\npct_miss\n\n\n\n\nDT_OBITO\n19.153.998\n99,8620523\n\n\nSOROTIPO\n19.122.145\n99,6959822\n\n\nDT_INTERNA\n18.666.361\n97,3196885\n\n\nDT_SORO\n13.240.413\n69,0307483\n\n\nCOUFINF\n12.135.027\n63,2676635\n\n\nCOMUNINF\n11.092.216\n57,8308223\n\n\nHOSPITALIZ\n9.873.619\n51,4774961\n\n\nRESUL_SORO\n7.430.672\n38,7408496\n\n\nEVOLUCAO\n6.002.490\n31,2948226\n\n\nCS_ESCOL_N\n5.838.882\n30,4418294\n\n\nCRITERIO\n4.529.680\n23,6161213\n\n\nCS_RACA\n3.700.530\n19,2932316\n\n\nCLASSI_FIN\n2.402.459\n12,5255566\n\n\nCS_GESTANT\n2.304.926\n12,0170547\n\n\nCS_SEXO\n2.301.330\n11,9983064\n\n\nID_OCUPA_N\n720.520\n3,7565320\n\n\nID_UNIDADE\n3.471\n0,0180965\n\n\nID_MN_RESI\n2.627\n0,0136962\n\n\nDT_SIN_PRI\n176\n0,0009176\n\n\nDT_NOTIFIC\n1\n0,0000052\n\n\nID_AGRAVO\n0\n0,0000000\n\n\n\n\n\n\nVariables quality\n\nResidence municipality: ID_MN_RESI\nCheck var length. 6 characters are expected.\n\ndengue %&gt;%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %&gt;%\n  group_by(ID_MN_RESI_check) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nID_MN_RESI_check\nfreq\n\n\n\n\nFALSE\n4\n\n\nTRUE\n19.177.826\n\n\nNA\n2.627\n\n\n\n\n\n15.559.994 records on the database meets the criteria. 4 records have invalid municipalty codes and this information is missing for 2.126 records. Inputation from COMUNINF is a possibility.\n\n\nFinal classification of the notification: CLASSI_FIN\nIt is expected that the notifications final classification are labeled.\n\ndengue %&gt;%\n  group_by(CLASSI_FIN) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nCLASSI_FIN\nfreq\n\n\n\n\n1\n308.012\n\n\n2\n7.962\n\n\n3\n2.588\n\n\n4\n91\n\n\n5\n189.158\n\n\n6\n3\n\n\n8\n75.360\n\n\nDengue\n5.665.033\n\n\nDengue clássico\n2.686.548\n\n\nDengue com complicações\n23.073\n\n\nDengue com sinais de alarme\n82.408\n\n\nDengue grave\n7.391\n\n\nDescartado\n5.580.603\n\n\nFebre hemorrágica do dengue\n7.136\n\n\nInconclusivo\n2.142.252\n\n\nSíndrome do choque do dengue\n380\n\n\nNA\n2.402.459\n\n\n\n\n\n3 records have an invalid label and 69.866 are missing. This missing data may be from two causes: (1) the notification is being evaluated or (2) a real missing.\n\n\nDate of the first symptons onset: DT_SIN_PRI\nThis is the date most near to the infection date and more relevant to epidemiological analysis.\n\nvalid_interval &lt;- interval(ymd(\"2001-01-01\"), ymd(\"2021-12-31\"))\n\ndengue %&gt;%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval\n  ) %&gt;%\n  group_by(DT_SIN_PRI_check) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nDT_SIN_PRI_check\nfreq\n\n\n\n\nFALSE\n30.775\n\n\nTRUE\n19.149.506\n\n\nNA\n176\n\n\n\n\n\nThis variable is missing for 173 records. For 26.018 records, we have invalid dates (outside the period 2001-2021). It is possible to imputate with DT_NOTIFIC (date of notification), if valid."
  },
  {
    "objectID": "dengue-data/missing_data.html#positive-cases",
    "href": "dengue-data/missing_data.html#positive-cases",
    "title": "Missing data analysis",
    "section": "Positive cases",
    "text": "Positive cases\n\ndengue_classifications &lt;- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\ndengue %&gt;% \n  filter(CLASSI_FIN %in% dengue_classifications) %&gt;%\n  miss_var_summary() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nvariable\nn_miss\npct_miss\n\n\n\n\nDT_OBITO\n8.463.480\n99,8997990\n\n\nSOROTIPO\n8.417.274\n99,3544004\n\n\nDT_INTERNA\n8.208.924\n96,8951138\n\n\nDT_SORO\n5.864.290\n69,2199181\n\n\nHOSPITALIZ\n2.985.375\n35,2382663\n\n\nCOMUNINF\n1.959.050\n23,1239043\n\n\nCOUFINF\n1.934.904\n22,8388938\n\n\nCS_ESCOL_N\n1.782.790\n21,0433962\n\n\nRESUL_SORO\n1.778.971\n20,9983181\n\n\nCS_RACA\n717.175\n8,4652694\n\n\nEVOLUCAO\n470.392\n5,5523338\n\n\nID_OCUPA_N\n132.202\n1,5604637\n\n\nCS_GESTANT\n1.825\n0,0215416\n\n\nID_UNIDADE\n1.625\n0,0191809\n\n\nCRITERIO\n1.173\n0,0138457\n\n\nID_MN_RESI\n739\n0,0087229\n\n\nCS_SEXO\n220\n0,0025968\n\n\nDT_SIN_PRI\n5\n0,0000590\n\n\nID_AGRAVO\n0\n0,0000000\n\n\nDT_NOTIFIC\n0\n0,0000000\n\n\nCLASSI_FIN\n0\n0,0000000"
  },
  {
    "objectID": "dengue-data/missing_data.html#session-info",
    "href": "dengue-data/missing_data.html#session-info",
    "title": "Missing data analysis",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.2.0 (2022-04-22)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 13.4\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      naniar_1.0.0    arrow_12.0.1    lubridate_1.9.2\n [5] forcats_1.0.0   stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1    \n [9] readr_2.1.4     tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2  \n[13] tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.2.0    pillar_1.9.0      tools_4.2.0       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       generics_0.1.3    vctrs_0.6.3      \n[21] htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5       grid_4.2.0       \n[25] tidyselect_1.2.0  glue_1.6.2        R6_2.5.1          fansi_1.0.4      \n[29] rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1     \n[33] htmltools_0.5.5   visdat_0.6.0      assertthat_0.2.1  colorspace_2.1-0 \n[37] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-data/aggregated_database.html",
    "href": "dengue-data/aggregated_database.html",
    "title": "Export aggregated database",
    "section": "",
    "text": "This notebook aims to create a database with aggregated counts of positive dengue cases for spatial and time units.\nThe aggregation will be on municipalities and time will be date and epidemiological week."
  },
  {
    "objectID": "dengue-data/aggregated_database.html#context",
    "href": "dengue-data/aggregated_database.html#context",
    "title": "Export aggregated database",
    "section": "",
    "text": "This notebook aims to create a database with aggregated counts of positive dengue cases for spatial and time units.\nThe aggregation will be on municipalities and time will be date and epidemiological week."
  },
  {
    "objectID": "dengue-data/aggregated_database.html#packages",
    "href": "dengue-data/aggregated_database.html#packages",
    "title": "Export aggregated database",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#load-data",
    "href": "dengue-data/aggregated_database.html#load-data",
    "title": "Export aggregated database",
    "section": "Load data",
    "text": "Load data\nLazy evaluation.\n\ndengue &lt;- arrow::read_parquet(file = \"parquet_improved/dengue_improved.parquet\")\n\ntally(dengue)\n\n         n\n1 19180457"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#filter-valid-dates",
    "href": "dengue-data/aggregated_database.html#filter-valid-dates",
    "title": "Export aggregated database",
    "section": "Filter valid dates",
    "text": "Filter valid dates\n\nvalid_interval &lt;- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue &lt;- dengue %&gt;%\n  mutate(DT_SIN_PRI = ymd(DT_SIN_PRI)) %&gt;%\n  filter(DT_SIN_PRI %within% valid_interval)\n\ntally(dengue)\n\n         n\n1 15561929"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#filter-positive-cases-of-dengue",
    "href": "dengue-data/aggregated_database.html#filter-positive-cases-of-dengue",
    "title": "Export aggregated database",
    "section": "Filter positive cases of dengue",
    "text": "Filter positive cases of dengue\n\ndengue_classifications &lt;- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\n\ndengue &lt;- dengue %&gt;%\n  filter(CLASSI_FIN %in% dengue_classifications)\n\ntally(dengue)\n\n        n\n1 8125611"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#aggregation",
    "href": "dengue-data/aggregated_database.html#aggregation",
    "title": "Export aggregated database",
    "section": "Aggregation",
    "text": "Aggregation\n\nMunicipality and date (“md”)\nIncluding the step to fill the time series with zero values when certain dates do not have cases.\n\ndengue_md &lt;- dengue %&gt;%\n  group_by(mun = ID_MN_RESI, date = DT_SIN_PRI) %&gt;%\n  summarise(freq = n()) %&gt;%\n  arrange(date) %&gt;%\n  complete(\n    date = seq.Date(min(date), max(date), by = \"day\"),\n    fill = list(freq = 0)\n  ) %&gt;%\n  ungroup() %&gt;%\n  collect()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument.\n\n\n\nglimpse(dengue_md)\n\nRows: 16,772,737\nColumns: 3\n$ mun  &lt;chr&gt; \"110000\", \"110000\", \"110000\", \"110000\", \"110000\", \"110000\", \"1100…\n$ date &lt;date&gt; 2015-12-29, 2015-12-30, 2015-12-31, 2016-01-01, 2016-01-02, 2016…\n$ freq &lt;int&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n\n\n\ndengue_md %&gt;%\n  write_parquet(sink = \"parquet_aggregated/dengue_md.parquet\")\n\n\n\nMunicipality and epidemiological week (“mw”)\n\ndengue_mw &lt;- dengue_md %&gt;%\n  mutate(epi_week = paste0(epiyear(date), \"-\", str_pad(epiweek(date), 2, pad = \"0\"))) %&gt;%\n  group_by(mun, epi_week) %&gt;%\n  summarise(freq = n()) %&gt;%\n  arrange(epi_week) %&gt;%\n  ungroup() %&gt;%\n  collect()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument.\n\n\n\nglimpse(dengue_mw)\n\nRows: 2,400,687\nColumns: 3\n$ mun      &lt;chr&gt; \"110005\", \"110006\", \"110014\", \"110034\", \"110140\", \"120017\", \"…\n$ epi_week &lt;chr&gt; \"2010-52\", \"2010-52\", \"2010-52\", \"2010-52\", \"2010-52\", \"2010-…\n$ freq     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n\n\n\ndengue_mw %&gt;%\n  write_parquet(sink = \"parquet_aggregated/dengue_mw.parquet\")"
  },
  {
    "objectID": "dengue-data/aggregated_database.html#session-info",
    "href": "dengue-data/aggregated_database.html#session-info",
    "title": "Export aggregated database",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] arrow_12.0.0    lubridate_1.9.2 forcats_1.0.0   stringr_1.5.0  \n [5] dplyr_1.1.2     purrr_1.0.1     readr_2.1.4     tidyr_1.3.0    \n [9] tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       knitr_1.43        generics_0.1.3   \n[21] vctrs_0.6.3       htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5      \n[25] grid_4.1.2        tidyselect_1.2.0  glue_1.6.2        R6_2.5.1         \n[29] fansi_1.0.4       rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3   \n[33] scales_1.2.1      htmltools_0.5.5   assertthat_0.2.1  colorspace_2.1-0 \n[37] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-data/imputation.html",
    "href": "dengue-data/imputation.html",
    "title": "Imputation",
    "section": "",
    "text": "This notebook aims to imputate some missing data and enrich the dataset."
  },
  {
    "objectID": "dengue-data/imputation.html#context",
    "href": "dengue-data/imputation.html#context",
    "title": "Imputation",
    "section": "",
    "text": "This notebook aims to imputate some missing data and enrich the dataset."
  },
  {
    "objectID": "dengue-data/imputation.html#packages",
    "href": "dengue-data/imputation.html#packages",
    "title": "Imputation",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/imputation.html#load-data",
    "href": "dengue-data/imputation.html#load-data",
    "title": "Imputation",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars &lt;- c(\"ID_AGRAVO\", \"DT_NOTIFIC\", \"ID_UNIDADE\",\n                    \"DT_SIN_PRI\", \"CS_SEXO\", \"CS_GESTANT\",\n                    \"CS_RACA\", \"CS_ESCOL_N\", \"ID_MN_RESI\",\n                    \"COUFINF\", \"COMUNINF\", \"ID_OCUPA_N\",\n                    \"DT_SORO\", \"RESUL_SORO\", \"SOROTIPO\", \n                    \"CLASSI_FIN\", \"CRITERIO\", \"EVOLUCAO\",\n                    \"DT_OBITO\", \"HOSPITALIZ\", \"DT_INTERNA\")\n\ndengue &lt;- open_dataset(sources = \"parquets/\") %&gt;%\n  select(all_of(important_vars)) %&gt;%\n  collect()\n\n\nResidence municipality: ID_MN_RESI\nTask: If ID_MN_RESI is invalid or missing, imputate with valid COMUNINF information.\n\nImputation\n\ndengue &lt;- dengue %&gt;%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE),\n    COMUNINF_check = if_else(nchar(COMUNINF) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %&gt;%\n  mutate(ID_MN_RESI = case_when(\n    ID_MN_RESI_check == FALSE & COMUNINF_check == TRUE ~ COMUNINF,\n    is.na(ID_MN_RESI) ~ COMUNINF,\n    TRUE ~ ID_MN_RESI\n  )) %&gt;%\n  select(-ID_MN_RESI_check, -COMUNINF_check)\n\n\n\nCheck improval\n\ndengue %&gt;%\n  mutate(\n    ID_MN_RESI_check = if_else(nchar(ID_MN_RESI) == 6, \n                               false = FALSE,\n                               true = TRUE)\n  ) %&gt;%\n  group_by(ID_MN_RESI_check) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nID_MN_RESI_check\nfreq\n\n\n\n\nFALSE\n4\n\n\nTRUE\n19.177.930\n\n\nNA\n2.523\n\n\n\n\n\nNo improvement for invalid municipalities, improvement of 96 records with missing data.\n\n\n\nDate of the first symptoms onset: DT_SIN_PRI\nTask: If DT_SIN_PRI is invalid or missing, imputate with valid DT_NOTIFIC information.\n\nImputation\n\nvalid_interval &lt;- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue &lt;- dengue %&gt;%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval,\n    DT_NOTIFIC_check = ymd(DT_NOTIFIC) %within% valid_interval,\n  ) %&gt;%\n  mutate(DT_SIN_PRI = case_when(\n    DT_SIN_PRI_check == FALSE & DT_NOTIFIC_check == TRUE ~ DT_NOTIFIC,\n    is.na(DT_SIN_PRI) ~ DT_NOTIFIC,\n    TRUE ~ DT_SIN_PRI\n  )) %&gt;%\n  select(-DT_SIN_PRI_check, -DT_NOTIFIC_check)\n\n\n\nCheck improval\n\nvalid_interval &lt;- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue %&gt;%\n  mutate(\n    DT_SIN_PRI_check = ymd(DT_SIN_PRI) %within% valid_interval\n  ) %&gt;%\n  group_by(DT_SIN_PRI_check) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n\n\n\nDT_SIN_PRI_check\nfreq\n\n\n\n\nFALSE\n3.618.528\n\n\nTRUE\n15.561.929\n\n\n\n\n\nThere was a improvement on 25,823 records with invalid dates and all missing records were imputate."
  },
  {
    "objectID": "dengue-data/imputation.html#export-improved-database",
    "href": "dengue-data/imputation.html#export-improved-database",
    "title": "Imputation",
    "section": "Export improved database",
    "text": "Export improved database\n\ndengue %&gt;%\n  write_parquet(sink = \"parquet_improved/dengue_improved.parquet\")"
  },
  {
    "objectID": "dengue-data/imputation.html#session-info",
    "href": "dengue-data/imputation.html#session-info",
    "title": "Imputation",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      arrow_12.0.0    lubridate_1.9.2 forcats_1.0.0  \n [5] stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1     readr_2.1.4    \n [9] tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.1.2    pillar_1.9.0      tools_4.1.2       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       generics_0.1.3    vctrs_0.6.2      \n[21] htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5       grid_4.1.2       \n[25] tidyselect_1.2.0  glue_1.6.2        R6_2.5.1          fansi_1.0.4      \n[29] rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1     \n[33] htmltools_0.5.5   assertthat_0.2.1  colorspace_2.1-0  utf8_1.2.3       \n[37] stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html",
    "title": "Mun/epi year time series",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities cumulative dengue cases time-series yearly (starting on September) by its similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#packages",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#packages",
    "title": "Mun/epi year time series",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#load-data",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#load-data",
    "title": "Mun/epi year time series",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue &lt;- dengue %&gt;%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date &lt; as.Date(\"2020-01-01\")) %&gt;%\n  # Pad days with zero cases\n  group_by(mun) %&gt;%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %&gt;%\n  ungroup() %&gt;%\n  # Aggregate by week\n  mutate(\n    week = str_pad(isoweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %&gt;%\n  group_by(mun, year, week) %&gt;%\n  summarise(freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  # Center year on September\n  group_by(mun) %&gt;%\n  mutate(year = case_when(\n    week &lt; 40 ~ year -1,\n    .default = year\n  )) %&gt;%\n  ungroup() %&gt;% \n  # Keep only municipalities/year series with more than 100 cases total\n  group_by(mun, year) %&gt;%\n  mutate(total = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 100) %&gt;%\n  select(-total) %&gt;%\n  # Scale cases by mun and year\n  group_by(mun, year) %&gt;%\n  arrange(week) %&gt;%\n  mutate(freq = scale(freq)) %&gt;%\n  ungroup() %&gt;%\n  arrange(mun, year, week) %&gt;%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %&gt;%\n  select(-year, week) %&gt;%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %&gt;%\n  arrange(mun) %&gt;%\n  pivot_wider(names_from = mun, values_from = freq) %&gt;%\n  select(-week) %&gt;%\n  t() %&gt;%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue &lt;- lapply(tdengue, na.omit)\n\n\nlength(tdengue)\n\n[1] 6264"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#clustering",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#clustering",
    "title": "Mun/epi year time series",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq &lt;- 3:10\n\n\nSBD method\n\ntic()\nclust &lt;- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n10.042 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) &lt;- paste0(\"k_\", k_seq)\nres_cvi &lt;- sapply(clust, cvi, type = \"internal\") %&gt;% \n  t() %&gt;%\n  as_tibble(rownames = \"k\") %&gt;%\n  arrange(-Sil)\n\nres_cvi %&gt;%\n  kbl() %&gt;%\n  kable_styling()\n\n\n\n\nk\nSil\nSF\nCH\nDB\nDBstar\nD\nCOP\n\n\n\n\nk_4\n0.1460031\n0.3901889\n1221.4732\n1.729571\n2.355575\n0.0144472\n0.2148113\n\n\nk_3\n0.1073370\n0.4371917\n1617.9353\n2.098333\n2.810307\n0.0057479\n0.2360803\n\n\nk_5\n0.0829643\n0.3474048\n777.9166\n4.742646\n6.109333\n0.0060501\n0.2178480\n\n\nk_7\n0.0447668\n0.2792414\n620.1160\n3.894731\n6.159100\n0.0059028\n0.2063219\n\n\nk_9\n0.0408667\n0.1378384\n520.9820\n4.006004\n7.405060\n0.0069375\n0.2034521\n\n\nk_6\n0.0306821\n0.2620188\n642.5254\n3.478077\n6.350471\n0.0077663\n0.2178271\n\n\nk_10\n0.0300852\n0.1493126\n471.9434\n3.197318\n5.172398\n0.0106935\n0.2003746\n\n\nk_8\n0.0298938\n0.1695255\n510.7171\n3.721259\n7.713016\n0.0097268\n0.2056778\n\n\n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust &lt;- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nggsave(filename = \"cluster_mun_epiyear.pdf\")\n\nSaving 7 x 5 in image\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\nggsave(filename = \"cluster_mun_epiyear_centr.pdf\")\n\nSaving 7 x 5 in image\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3    4 \n1439  176 1361 3288"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_epi_year.html#session-info",
    "href": "dengue-cluster/cluster_mun_year_epi_year.html#session-info",
    "title": "Mun/epi year time series",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.8.3     arrow_12.0.1     lubridate_1.9.2 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2      purrr_1.0.1     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.2   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] colorspace_2.1-0    ellipsis_0.3.2      class_7.3-20       \n  [4] modeltools_0.2-23   clue_0.3-64         rstudioapi_0.14    \n  [7] farver_2.1.1        listenv_0.9.0       furrr_0.3.1        \n [10] dials_1.2.0         ggrepel_0.9.3       bit64_4.0.5        \n [13] RSpectra_0.16-1     prodlim_2023.03.31  fansi_1.0.4        \n [16] xml2_1.3.4          codetools_0.2-18    splines_4.1.2      \n [19] knitr_1.43          jsonlite_1.8.5      workflows_1.1.3    \n [22] anytime_0.3.9       cluster_2.1.2       yardstick_1.2.0    \n [25] shiny_1.7.4         tune_1.1.1          httr_1.4.6         \n [28] compiler_4.1.2      assertthat_0.2.1    Matrix_1.5-4.1     \n [31] fastmap_1.1.1       cli_3.6.1           later_1.3.1        \n [34] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n [37] glue_1.6.2          reshape2_1.4.4      Rcpp_1.0.10        \n [40] DiceDesign_1.9      vctrs_0.6.3         svglite_2.1.1      \n [43] iterators_1.0.14    parsnip_1.1.0       timeDate_4022.108  \n [46] gower_1.0.1         xfun_0.39           globals_0.16.2     \n [49] rvest_1.0.3         timechange_0.2.0    mime_0.12          \n [52] lifecycle_1.0.3     future_1.32.0       MASS_7.3-55        \n [55] zoo_1.8-12          scales_1.2.1        ipred_0.9-14       \n [58] ragg_1.2.5          hms_1.1.3           promises_1.2.0.1   \n [61] parallel_4.1.2      yaml_2.3.7          padr_0.6.2         \n [64] rpart_4.1.16        stringi_1.7.12      highr_0.10         \n [67] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n [70] lava_1.7.2.1        systemfonts_1.0.4   rlang_1.1.1        \n [73] pkgconfig_2.0.3     rsample_1.1.1       evaluate_0.21      \n [76] lattice_0.20-45     labeling_0.4.2      recipes_1.0.6      \n [79] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n [82] parallelly_1.36.0   plyr_1.8.8          magrittr_2.0.3     \n [85] R6_2.5.1            generics_0.1.3      pillar_1.9.0       \n [88] withr_2.5.0         xts_0.13.1          survival_3.2-13    \n [91] nnet_7.3-17         future.apply_1.11.0 utf8_1.2.3         \n [94] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n [97] flexclust_1.4-1     data.table_1.14.8   webshot_0.5.4      \n[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.11      \n[103] textshaping_0.3.6   RcppParallel_5.1.7  stats4_4.1.2       \n[106] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2  \n[109] shinyjs_2.1.0"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html",
    "href": "dengue-cluster/cluster_long.html",
    "title": "Long time series (not scaled)",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#packages",
    "href": "dengue-cluster/cluster_long.html#packages",
    "title": "Long time series (not scaled)",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#load-data",
    "href": "dengue-cluster/cluster_long.html#load-data",
    "title": "Long time series (not scaled)",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue &lt;- dengue %&gt;%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date &lt; as.Date(\"2020-01-01\")) %&gt;%\n  # Pad days with zero cases\n  group_by(mun) %&gt;%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %&gt;%\n  ungroup() %&gt;%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %&gt;%\n  group_by(mun, year, week) %&gt;%\n  summarise(freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  # Keep only municipalities series with more than 100 cases total\n  group_by(mun) %&gt;%\n  mutate(total = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 100) %&gt;%\n  select(-total) %&gt;%\n  # Prepare time series\n  arrange(mun) %&gt;%\n  pivot_wider(names_from = mun, values_from = freq) %&gt;%\n  select(-week) %&gt;%\n  t() %&gt;%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n\n\nlength(tdengue)\n\n[1] 2953"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#clustering",
    "href": "dengue-cluster/cluster_long.html#clustering",
    "title": "Long time series (not scaled)",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq &lt;- 3:10\n\n\nSBD method\n\ntic()\nclust &lt;- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n29.799 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) &lt;- paste0(\"k_\", k_seq)\nres_cvi &lt;- sapply(clust, cvi, type = \"internal\") %&gt;% \n  t() %&gt;%\n  as_tibble(rownames = \"k\") %&gt;%\n  arrange(-Sil)\n\nres_cvi %&gt;%\n  kbl() %&gt;%\n  kable_styling()\n\n\n\n\nk\nSil\nSF\nCH\nDB\nDBstar\nD\nCOP\n\n\n\n\nk_4\n0.0792636\n0.2942582\n306.6924\n4.320899\n5.211936\n0.0233990\n0.3676556\n\n\nk_9\n0.0692372\n0.0706483\n175.8549\n4.509085\n6.068099\n0.0141304\n0.3514621\n\n\nk_7\n0.0497536\n0.1391297\n195.6471\n3.601189\n4.740963\n0.0181718\n0.3502824\n\n\nk_10\n0.0460694\n0.0883471\n135.2359\n3.542163\n4.435264\n0.0143743\n0.3398911\n\n\nk_5\n0.0459207\n0.2229480\n232.7881\n3.748984\n5.009457\n0.0270760\n0.3632902\n\n\nk_8\n0.0426182\n0.1217283\n193.0502\n3.451211\n4.361179\n0.0222442\n0.3501777\n\n\nk_6\n0.0418012\n0.2473345\n252.6956\n5.279611\n6.589676\n0.0254406\n0.3570179\n\n\nk_3\n0.0354230\n0.3658859\n319.9077\n5.150333\n5.830050\n0.0139629\n0.3937537\n\n\n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust &lt;- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nggsave(filename = \"cluster_long.pdf\")\n\nSaving 7 x 5 in image\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3    4 \n1512  292  867  282"
  },
  {
    "objectID": "dengue-cluster/cluster_long.html#session-info",
    "href": "dengue-cluster/cluster_long.html#session-info",
    "title": "Long time series (not scaled)",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.8.3     arrow_12.0.1     lubridate_1.9.2 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2      purrr_1.0.1     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.2   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] colorspace_2.1-0    ellipsis_0.3.2      class_7.3-20       \n  [4] modeltools_0.2-23   clue_0.3-64         rstudioapi_0.14    \n  [7] farver_2.1.1        listenv_0.9.0       furrr_0.3.1        \n [10] dials_1.2.0         ggrepel_0.9.3       bit64_4.0.5        \n [13] RSpectra_0.16-1     prodlim_2023.03.31  fansi_1.0.4        \n [16] xml2_1.3.4          codetools_0.2-18    splines_4.1.2      \n [19] knitr_1.43          jsonlite_1.8.5      workflows_1.1.3    \n [22] anytime_0.3.9       cluster_2.1.2       yardstick_1.2.0    \n [25] shiny_1.7.4         tune_1.1.1          httr_1.4.6         \n [28] compiler_4.1.2      assertthat_0.2.1    Matrix_1.5-4.1     \n [31] fastmap_1.1.1       cli_3.6.1           later_1.3.1        \n [34] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n [37] glue_1.6.2          reshape2_1.4.4      Rcpp_1.0.10        \n [40] DiceDesign_1.9      vctrs_0.6.3         svglite_2.1.1      \n [43] iterators_1.0.14    parsnip_1.1.0       timeDate_4022.108  \n [46] gower_1.0.1         xfun_0.39           globals_0.16.2     \n [49] rvest_1.0.3         timechange_0.2.0    mime_0.12          \n [52] lifecycle_1.0.3     future_1.32.0       MASS_7.3-55        \n [55] zoo_1.8-12          scales_1.2.1        ipred_0.9-14       \n [58] ragg_1.2.5          hms_1.1.3           promises_1.2.0.1   \n [61] parallel_4.1.2      yaml_2.3.7          padr_0.6.2         \n [64] rpart_4.1.16        stringi_1.7.12      highr_0.10         \n [67] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n [70] lava_1.7.2.1        systemfonts_1.0.4   rlang_1.1.1        \n [73] pkgconfig_2.0.3     rsample_1.1.1       evaluate_0.21      \n [76] lattice_0.20-45     labeling_0.4.2      recipes_1.0.6      \n [79] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n [82] parallelly_1.36.0   plyr_1.8.8          magrittr_2.0.3     \n [85] R6_2.5.1            generics_0.1.3      pillar_1.9.0       \n [88] withr_2.5.0         xts_0.13.1          survival_3.2-13    \n [91] nnet_7.3-17         future.apply_1.11.0 utf8_1.2.3         \n [94] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n [97] flexclust_1.4-1     data.table_1.14.8   webshot_0.5.4      \n[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.11      \n[103] textshaping_0.3.6   RcppParallel_5.1.7  stats4_4.1.2       \n[106] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2  \n[109] shinyjs_2.1.0"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Building and Selecting Specialized AI Models for Predicting Dengue Disease",
    "section": "",
    "text": "This website presents working in progress research on dengue and machine learning, as part of my Postdoctoral researcher position at Inria (Montpellier, France) and LNCC (Petrópolis, Brazil)."
  },
  {
    "objectID": "dengue_data.html",
    "href": "dengue_data.html",
    "title": "Overview",
    "section": "",
    "text": "In this section there are notebooks for dengue notifications data download, pre-processing, missing data analysis, imputations and exportation.\n\n\n\n\nflowchart LR\n  A[Raw dataset] --&gt; B(Imputation)\n  B --&gt; C[Improved dataset]\n  C --&gt; D{Filter valid dates}\n  C --&gt; E{Filter positive cases}\n  D --&gt; F(Aggregate)\n  E --&gt; F\n  F --&gt; G[Municipality and date dataset]\n  F --&gt; H[Municipality and epiweek dataset]\n\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html",
    "href": "dengue-cluster/cluster_mun_year.html",
    "title": "Mun/year time series",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#packages",
    "href": "dengue-cluster/cluster_mun_year.html#packages",
    "title": "Mun/year time series",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#load-data",
    "href": "dengue-cluster/cluster_mun_year.html#load-data",
    "title": "Mun/year time series",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue &lt;- dengue %&gt;%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date &lt;= as.Date(\"2020-01-01\")) %&gt;%\n  # Pad days with zero cases\n  group_by(mun) %&gt;%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %&gt;%\n  ungroup() %&gt;%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %&gt;%\n  group_by(mun, year, week) %&gt;%\n  summarise(freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  # Keep only municipalities/year series with more than 1,000 cases total\n  group_by(mun, year) %&gt;%\n  mutate(total = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 100) %&gt;%\n  select(-total) %&gt;%\n  # Scale cases by mun and year\n  group_by(mun, year) %&gt;%\n  arrange(week) %&gt;%\n  mutate(freq = scale(freq)) %&gt;%\n  ungroup() %&gt;%\n  arrange(mun, year, week) %&gt;%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %&gt;%\n  select(-year, week) %&gt;%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %&gt;%\n  arrange(mun) %&gt;%\n  pivot_wider(names_from = mun, values_from = freq) %&gt;%\n  select(-week) %&gt;%\n  t() %&gt;%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue &lt;- lapply(tdengue, na.omit)\n\n\nlength(tdengue)\n\n[1] 6286"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#clustering",
    "href": "dengue-cluster/cluster_mun_year.html#clustering",
    "title": "Mun/year time series",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq &lt;- 3:10\n\n\nSBD method\n\ntic()\nclust &lt;- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n10.258 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) &lt;- paste0(\"k_\", k_seq)\nres_cvi &lt;- sapply(clust, cvi, type = \"internal\") %&gt;% \n  t() %&gt;%\n  as_tibble(rownames = \"k\") %&gt;%\n  arrange(-Sil)\n\nres_cvi %&gt;%\n  kbl() %&gt;%\n  kable_styling()\n\n\n\n\nk\nSil\nSF\nCH\nDB\nDBstar\nD\nCOP\n\n\n\n\nk_3\n0.1799898\n0.4600699\n1615.6227\n1.808332\n2.176731\n0.0107715\n0.2197241\n\n\nk_6\n0.0893704\n0.2658658\n636.5185\n2.950530\n5.019164\n0.0102939\n0.2146694\n\n\nk_4\n0.0880023\n0.3914649\n880.8181\n2.742671\n3.950231\n0.0088136\n0.2199024\n\n\nk_5\n0.0523091\n0.3553609\n874.9466\n2.905408\n4.787980\n0.0118592\n0.2039666\n\n\nk_7\n0.0493956\n0.2508976\n644.2339\n3.110343\n4.808484\n0.0084627\n0.2052782\n\n\nk_8\n0.0161030\n0.2628680\n451.9170\n4.862096\n7.169066\n0.0070094\n0.1972874\n\n\nk_10\n0.0139549\n0.2003374\n469.7019\n4.056141\n6.254832\n0.0092263\n0.1866359\n\n\nk_9\n0.0070017\n0.1981565\n445.0204\n3.658878\n6.053719\n0.0095809\n0.2005665\n\n\n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust &lt;- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nggsave(filename = \"cluster_mun_year.pdf\")\n\nSaving 7 x 5 in image\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\nggsave(filename = \"cluster_mun_year_centr.pdf\")\n\nSaving 7 x 5 in image\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3 \n1166 3617 1503"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year.html#session-info",
    "href": "dengue-cluster/cluster_mun_year.html#session-info",
    "title": "Mun/year time series",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.8.3     arrow_12.0.1     lubridate_1.9.2 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2      purrr_1.0.1     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.2   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] colorspace_2.1-0    ellipsis_0.3.2      class_7.3-20       \n  [4] modeltools_0.2-23   clue_0.3-64         rstudioapi_0.14    \n  [7] farver_2.1.1        listenv_0.9.0       furrr_0.3.1        \n [10] dials_1.2.0         ggrepel_0.9.3       bit64_4.0.5        \n [13] RSpectra_0.16-1     prodlim_2023.03.31  fansi_1.0.4        \n [16] xml2_1.3.4          codetools_0.2-18    splines_4.1.2      \n [19] knitr_1.43          jsonlite_1.8.5      workflows_1.1.3    \n [22] anytime_0.3.9       cluster_2.1.2       yardstick_1.2.0    \n [25] shiny_1.7.4         tune_1.1.1          httr_1.4.6         \n [28] compiler_4.1.2      assertthat_0.2.1    Matrix_1.5-4.1     \n [31] fastmap_1.1.1       cli_3.6.1           later_1.3.1        \n [34] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n [37] glue_1.6.2          reshape2_1.4.4      Rcpp_1.0.10        \n [40] DiceDesign_1.9      vctrs_0.6.3         svglite_2.1.1      \n [43] iterators_1.0.14    parsnip_1.1.0       timeDate_4022.108  \n [46] gower_1.0.1         xfun_0.39           globals_0.16.2     \n [49] rvest_1.0.3         timechange_0.2.0    mime_0.12          \n [52] lifecycle_1.0.3     future_1.32.0       MASS_7.3-55        \n [55] zoo_1.8-12          scales_1.2.1        ipred_0.9-14       \n [58] ragg_1.2.5          hms_1.1.3           promises_1.2.0.1   \n [61] parallel_4.1.2      yaml_2.3.7          padr_0.6.2         \n [64] rpart_4.1.16        stringi_1.7.12      highr_0.10         \n [67] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n [70] lava_1.7.2.1        systemfonts_1.0.4   rlang_1.1.1        \n [73] pkgconfig_2.0.3     rsample_1.1.1       evaluate_0.21      \n [76] lattice_0.20-45     labeling_0.4.2      recipes_1.0.6      \n [79] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n [82] parallelly_1.36.0   plyr_1.8.8          magrittr_2.0.3     \n [85] R6_2.5.1            generics_0.1.3      pillar_1.9.0       \n [88] withr_2.5.0         xts_0.13.1          survival_3.2-13    \n [91] nnet_7.3-17         future.apply_1.11.0 utf8_1.2.3         \n [94] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n [97] flexclust_1.4-1     data.table_1.14.8   webshot_0.5.4      \n[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.11      \n[103] textshaping_0.3.6   RcppParallel_5.1.7  stats4_4.1.2       \n[106] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2  \n[109] shinyjs_2.1.0"
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html",
    "href": "dengue-cluster/cluster_long_scaled.html",
    "title": "Long time series (scaled)",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities considering dengue cases time-series similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#packages",
    "href": "dengue-cluster/cluster_long_scaled.html#packages",
    "title": "Long time series (scaled)",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#load-data",
    "href": "dengue-cluster/cluster_long_scaled.html#load-data",
    "title": "Long time series (scaled)",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue &lt;- dengue %&gt;%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date &lt;= as.Date(\"2020-01-01\")) %&gt;%\n  # Pad days with zero cases\n  group_by(mun) %&gt;%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %&gt;%\n  ungroup() %&gt;%\n  # Aggregate by week\n  mutate(date = floor_date(date, \"week\")) %&gt;%\n  group_by(mun, date) %&gt;%\n  summarise(freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  # Keep only municipalities series with more than 100 cases total\n  group_by(mun) %&gt;%\n  mutate(total = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 100) %&gt;%\n  select(-total) %&gt;%\n  # Scale cases by mun\n  group_by(mun) %&gt;%\n  arrange(date) %&gt;%\n  mutate(freq = scale(freq)) %&gt;%\n  ungroup() %&gt;%\n  arrange(mun, date) %&gt;%\n  # Prepare time series\n  mutate(mun = paste0(\"m_\", mun)) %&gt;%\n  arrange(mun, date) %&gt;%\n  pivot_wider(names_from = mun, values_from = freq) %&gt;%\n  select(-date) %&gt;%\n  t() %&gt;%\n  tslist()\n\n`summarise()` has grouped output by 'mun'. You can override using the `.groups`\nargument.\n\n\n\nlength(tdengue)\n\n[1] 2952"
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#clustering",
    "href": "dengue-cluster/cluster_long_scaled.html#clustering",
    "title": "Long time series (scaled)",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq &lt;- 3:10\n\n\nSBD method\n\ntic()\nclust &lt;- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n30.198 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) &lt;- paste0(\"k_\", k_seq)\nres_cvi &lt;- sapply(clust, cvi, type = \"internal\") %&gt;% \n  t() %&gt;%\n  as_tibble(rownames = \"k\") %&gt;%\n  arrange(-Sil)\n\nres_cvi %&gt;%\n  kbl() %&gt;%\n  kable_styling()\n\n\n\n\nk\nSil\nSF\nCH\nDB\nDBstar\nD\nCOP\n\n\n\n\nk_3\n0.1361517\n0.3215523\n301.2210\n3.692051\n4.316082\n0.0679378\n0.4052902\n\n\nk_5\n0.0868020\n0.2224752\n282.4503\n2.413023\n2.847291\n0.0280136\n0.3615501\n\n\nk_6\n0.0733088\n0.1578847\n154.6699\n4.988996\n6.309369\n0.0216979\n0.3660083\n\n\nk_4\n0.0610827\n0.2544475\n140.5981\n6.897833\n8.287407\n0.0216420\n0.3886784\n\n\nk_9\n0.0504672\n0.0626711\n124.3538\n3.532466\n4.849390\n0.0248858\n0.3501298\n\n\nk_10\n0.0466939\n0.0628349\n166.6916\n3.820877\n4.682205\n0.0135861\n0.3434336\n\n\nk_8\n0.0408157\n0.1107509\n164.5684\n3.780052\n4.964673\n0.0221248\n0.3432409\n\n\nk_7\n0.0380647\n0.1346238\n171.9309\n4.240165\n5.555059\n0.0219174\n0.3537959\n\n\n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust &lt;- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nggsave(filename = \"cluster_long_scaled.pdf\")\n\nSaving 7 x 5 in image\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3 \n2457   54  441"
  },
  {
    "objectID": "dengue-cluster/cluster_long_scaled.html#session-info",
    "href": "dengue-cluster/cluster_long_scaled.html#session-info",
    "title": "Long time series (scaled)",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.8.3     arrow_12.0.1     lubridate_1.9.2 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2      purrr_1.0.1     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.2   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] colorspace_2.1-0    ellipsis_0.3.2      class_7.3-20       \n  [4] modeltools_0.2-23   clue_0.3-64         rstudioapi_0.14    \n  [7] farver_2.1.1        listenv_0.9.0       furrr_0.3.1        \n [10] dials_1.2.0         ggrepel_0.9.3       bit64_4.0.5        \n [13] RSpectra_0.16-1     prodlim_2023.03.31  fansi_1.0.4        \n [16] xml2_1.3.4          codetools_0.2-18    splines_4.1.2      \n [19] knitr_1.43          jsonlite_1.8.5      workflows_1.1.3    \n [22] anytime_0.3.9       cluster_2.1.2       yardstick_1.2.0    \n [25] shiny_1.7.4         tune_1.1.1          httr_1.4.6         \n [28] compiler_4.1.2      assertthat_0.2.1    Matrix_1.5-4.1     \n [31] fastmap_1.1.1       cli_3.6.1           later_1.3.1        \n [34] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n [37] glue_1.6.2          reshape2_1.4.4      Rcpp_1.0.10        \n [40] DiceDesign_1.9      vctrs_0.6.3         svglite_2.1.1      \n [43] iterators_1.0.14    parsnip_1.1.0       timeDate_4022.108  \n [46] gower_1.0.1         xfun_0.39           globals_0.16.2     \n [49] rvest_1.0.3         timechange_0.2.0    mime_0.12          \n [52] lifecycle_1.0.3     future_1.32.0       MASS_7.3-55        \n [55] zoo_1.8-12          scales_1.2.1        ipred_0.9-14       \n [58] ragg_1.2.5          hms_1.1.3           promises_1.2.0.1   \n [61] parallel_4.1.2      yaml_2.3.7          padr_0.6.2         \n [64] rpart_4.1.16        stringi_1.7.12      highr_0.10         \n [67] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n [70] lava_1.7.2.1        systemfonts_1.0.4   rlang_1.1.1        \n [73] pkgconfig_2.0.3     rsample_1.1.1       evaluate_0.21      \n [76] lattice_0.20-45     labeling_0.4.2      recipes_1.0.6      \n [79] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n [82] parallelly_1.36.0   plyr_1.8.8          magrittr_2.0.3     \n [85] R6_2.5.1            generics_0.1.3      pillar_1.9.0       \n [88] withr_2.5.0         xts_0.13.1          survival_3.2-13    \n [91] nnet_7.3-17         future.apply_1.11.0 utf8_1.2.3         \n [94] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n [97] flexclust_1.4-1     data.table_1.14.8   webshot_0.5.4      \n[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.11      \n[103] textshaping_0.3.6   RcppParallel_5.1.7  stats4_4.1.2       \n[106] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2  \n[109] shinyjs_2.1.0"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html",
    "title": "Mun/year time series, cumulative",
    "section": "",
    "text": "This notebook aims to cluster the Brazilian municipalities cumulative dengue cases time-series yearly by its similarities."
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#packages",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#packages",
    "title": "Mun/year time series, cumulative",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(lubridate)\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(dtwclust)\n\nLoading required package: proxy\n\nAttaching package: 'proxy'\n\nThe following objects are masked from 'package:stats':\n\n    as.dist, dist\n\nThe following object is masked from 'package:base':\n\n    as.matrix\n\nLoading required package: dtw\nLoaded dtw v1.23-1. See ?dtw for help, citation(\"dtw\") for use in publication.\n\ndtwclust:\nSetting random number generator to L'Ecuyer-CMRG (see RNGkind()).\nTo read the included vignettes type: browseVignettes(\"dtwclust\").\nSee news(package = \"dtwclust\") after package updates.\n\nlibrary(kableExtra)\n\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n\nlibrary(tictoc)"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#load-data",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#load-data",
    "title": "Mun/year time series, cumulative",
    "section": "Load data",
    "text": "Load data\nLoad the aggregated data.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\")\n\ndim(dengue)\n\n[1] 16772737        3\n\n\n\nPrepare data\nThe chunk bellow executes various steps to prepare the data for clustering.\n\ntdengue &lt;- dengue %&gt;%\n  # Filter out dates after 2020-01-01, as this year is not complete\n  filter(date &lt;= as.Date(\"2020-01-01\")) %&gt;%\n  # Pad days with zero cases\n  group_by(mun) %&gt;%\n  pad_by_time(date, .by = \"day\", .pad_value = 0, .start_date = min(dengue$date), .end_date = max(dengue$date)) %&gt;%\n  ungroup() %&gt;%\n  # Aggregate by week\n  mutate(\n    week = str_pad(epiweek(date), pad = 0, width = 2),\n    year = year(date)\n  ) %&gt;%\n  group_by(mun, year, week) %&gt;%\n  summarise(freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  # Keep only municipalities/year series with more than 100 cases total\n  group_by(mun, year) %&gt;%\n  mutate(total = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  filter(total &gt;= 100) %&gt;%\n  select(-total) %&gt;%\n  # Modify freq\n  group_by(mun, year) %&gt;%\n  arrange(week) %&gt;%\n  # Accumulate mun time series by year\n  mutate(freq = cumsum(freq)) %&gt;%\n  # Scale cases by mun and year\n  mutate(freq = scale(freq)) %&gt;%\n  ungroup() %&gt;%\n  arrange(mun, year, week) %&gt;%\n  # Isolate municipality and year\n  mutate(mun = paste0(mun, \"_\", year)) %&gt;%\n  select(-year, week) %&gt;%\n  # Prepare time series of municipalities by year\n  mutate(mun = paste0(\"m_\", mun)) %&gt;%\n  arrange(mun) %&gt;%\n  pivot_wider(names_from = mun, values_from = freq) %&gt;%\n  select(-week) %&gt;%\n  t() %&gt;%\n  # Convert object\n  tslist()\n\n`summarise()` has grouped output by 'mun', 'year'. You can override using the\n`.groups` argument.\n\n# Remove missing values created by leap years (week 53)\ntdengue &lt;- lapply(tdengue, na.omit)\n\n\nlength(tdengue)\n\n[1] 6286"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#clustering",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#clustering",
    "title": "Mun/year time series, cumulative",
    "section": "Clustering",
    "text": "Clustering\nSequence of k groups to be used.\n\nk_seq &lt;- 3:10\n\n\nSBD method\n\ntic()\nclust &lt;- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n\n12.511 sec elapsed\n\n\n\n\nCluster Validity Indices (CVI)\n\nnames(clust) &lt;- paste0(\"k_\", k_seq)\nres_cvi &lt;- sapply(clust, cvi, type = \"internal\") %&gt;% \n  t() %&gt;%\n  as_tibble(rownames = \"k\") %&gt;%\n  arrange(-Sil)\n\nres_cvi %&gt;%\n  kbl() %&gt;%\n  kable_styling()\n\n\n\n\nk\nSil\nSF\nCH\nDB\nDBstar\nD\nCOP\n\n\n\n\nk_3\n0.5421277\n0.5873658\n3808.751\n0.6836648\n1.038241\n0.0002976\n0.0694489\n\n\nk_4\n0.5042762\n0.5822914\n4206.850\n0.6056223\n1.262730\n0.0003035\n0.0528271\n\n\nk_6\n0.4448936\n0.5766970\n3833.303\n0.6646770\n1.555062\n0.0003156\n0.0363601\n\n\nk_5\n0.4399115\n0.5791845\n3498.320\n0.7169644\n1.936044\n0.0001725\n0.0459396\n\n\nk_8\n0.4345944\n0.5664725\n3330.480\n0.7752000\n1.988574\n0.0002574\n0.0289114\n\n\nk_7\n0.3884300\n0.5722467\n3277.221\n1.0922372\n3.133504\n0.0002989\n0.0330646\n\n\nk_10\n0.3534378\n0.5633514\n2802.179\n0.9206737\n3.137418\n0.0003279\n0.0267403\n\n\nk_9\n0.3434713\n0.5664988\n3067.097\n0.9059799\n2.630923\n0.0003052\n0.0279188\n\n\n\n\n\n\n\n\n\nCluster with higher Silhouette statistic\n\nsel_clust &lt;- clust[[res_cvi[[1,1]]]]\n\n\nplot(sel_clust)\n\n\n\n\n\nggsave(filename = \"cluster_mun_year_cum.pdf\")\n\nSaving 7 x 5 in image\n\n\n\nplot(sel_clust, type = \"centroids\", lty = 1)\n\n\n\n\n\nggsave(filename = \"cluster_mun_year_cum_centr.pdf\")\n\nSaving 7 x 5 in image\n\n\n\n\nCluster sizes\n\ntable(sel_clust@cluster)\n\n\n   1    2    3 \n2199 3303  784"
  },
  {
    "objectID": "dengue-cluster/cluster_mun_year_cumulative.html#session-info",
    "href": "dengue-cluster/cluster_mun_year_cumulative.html#session-info",
    "title": "Mun/year time series, cumulative",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.8.3     arrow_12.0.1     lubridate_1.9.2 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.2      purrr_1.0.1     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.2   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] colorspace_2.1-0    ellipsis_0.3.2      class_7.3-20       \n  [4] modeltools_0.2-23   clue_0.3-64         rstudioapi_0.14    \n  [7] farver_2.1.1        listenv_0.9.0       furrr_0.3.1        \n [10] dials_1.2.0         ggrepel_0.9.3       bit64_4.0.5        \n [13] RSpectra_0.16-1     prodlim_2023.03.31  fansi_1.0.4        \n [16] xml2_1.3.4          codetools_0.2-18    splines_4.1.2      \n [19] knitr_1.43          jsonlite_1.8.5      workflows_1.1.3    \n [22] anytime_0.3.9       cluster_2.1.2       yardstick_1.2.0    \n [25] shiny_1.7.4         tune_1.1.1          httr_1.4.6         \n [28] compiler_4.1.2      assertthat_0.2.1    Matrix_1.5-4.1     \n [31] fastmap_1.1.1       cli_3.6.1           later_1.3.1        \n [34] htmltools_0.5.5     tools_4.1.2         gtable_0.3.3       \n [37] glue_1.6.2          reshape2_1.4.4      Rcpp_1.0.10        \n [40] DiceDesign_1.9      vctrs_0.6.3         svglite_2.1.1      \n [43] iterators_1.0.14    parsnip_1.1.0       timeDate_4022.108  \n [46] gower_1.0.1         xfun_0.39           globals_0.16.2     \n [49] rvest_1.0.3         timechange_0.2.0    mime_0.12          \n [52] lifecycle_1.0.3     future_1.32.0       MASS_7.3-55        \n [55] zoo_1.8-12          scales_1.2.1        ipred_0.9-14       \n [58] ragg_1.2.5          hms_1.1.3           promises_1.2.0.1   \n [61] parallel_4.1.2      yaml_2.3.7          padr_0.6.2         \n [64] rpart_4.1.16        stringi_1.7.12      highr_0.10         \n [67] foreach_1.5.2       lhs_1.1.6           hardhat_1.3.0      \n [70] lava_1.7.2.1        systemfonts_1.0.4   rlang_1.1.1        \n [73] pkgconfig_2.0.3     rsample_1.1.1       evaluate_0.21      \n [76] lattice_0.20-45     labeling_0.4.2      recipes_1.0.6      \n [79] htmlwidgets_1.6.2   bit_4.0.5           tidyselect_1.2.0   \n [82] parallelly_1.36.0   plyr_1.8.8          magrittr_2.0.3     \n [85] R6_2.5.1            generics_0.1.3      pillar_1.9.0       \n [88] withr_2.5.0         xts_0.13.1          survival_3.2-13    \n [91] nnet_7.3-17         future.apply_1.11.0 utf8_1.2.3         \n [94] tzdb_0.4.0          rmarkdown_2.22      grid_4.1.2         \n [97] flexclust_1.4-1     data.table_1.14.8   webshot_0.5.4      \n[100] digest_0.6.31       xtable_1.8-4        httpuv_1.6.11      \n[103] textshaping_0.3.6   RcppParallel_5.1.7  stats4_4.1.2       \n[106] GPfit_1.0-8         munsell_0.5.0       viridisLite_0.4.2  \n[109] shinyjs_2.1.0"
  },
  {
    "objectID": "dengue-data/raw_files.html",
    "href": "dengue-data/raw_files.html",
    "title": "Raw files",
    "section": "",
    "text": "This notebook presents the process of downloading SINAN Dengue raw data files from DataSUS, pre-processing steps using the {microdatasus} package and exporting the raw files to parquet files."
  },
  {
    "objectID": "dengue-data/raw_files.html#packages",
    "href": "dengue-data/raw_files.html#packages",
    "title": "Raw files",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\n# remotes::install_github(\"rfsaldanha/microdatasus\")\nlibrary(microdatasus)\nlibrary(arrow)"
  },
  {
    "objectID": "dengue-data/raw_files.html#data-download",
    "href": "dengue-data/raw_files.html#data-download",
    "title": "Raw files",
    "section": "Data download",
    "text": "Data download\n\n# for(a in 2011:2021){\n#   tmp &lt;- fetch_datasus(\n#     year_start = a, year_end = a,\n#     information_system = \"SINAN-DENGUE\"\n#   )\n# \n#   write_parquet(x = tmp, sink = paste0(\"parquets_raw/raw_dengue_\", a, \".parquet\"))\n#   \n#   tmp &lt;- process_sinan_dengue(data = tmp)\n#   \n#   write_parquet(x = tmp, sink = paste0(\"parquets/dengue_\", a, \".parquet\"))\n#   \n#   rm(tmp)\n# }\n\n\n\n\n\n\n\nWarning\n\n\n\nThis code chunk is commented to avoid unnecessary download again the raw DBC files from DataSUS."
  },
  {
    "objectID": "dengue-data/raw_files.html#load",
    "href": "dengue-data/raw_files.html#load",
    "title": "Raw files",
    "section": "Load",
    "text": "Load\nAfter download, preprocessing and export, the parquet files are read to have a dimension of the size.\n\ndengue &lt;- open_dataset(sources = \"parquets/\")\n\n\ndengue %&gt;% glimpse()\n\nFileSystemDataset with 15 Parquet files\n19,180,457 rows x 75 columns\n$ TP_NOT       &lt;string&gt; \"Individual\", \"Individual\", \"Individual\", \"Individual\", …\n$ ID_AGRAVO    &lt;string&gt; \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", …\n$ DT_NOTIFIC   &lt;string&gt; \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ SEM_NOT      &lt;string&gt; \"200707\", \"200707\", \"200709\", \"200707\", \"200706\", \"20070…\n$ NU_ANO       &lt;string&gt; \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", …\n$ SG_UF_NOT    &lt;string&gt; \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MUNICIP   &lt;string&gt; \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_REGIONA   &lt;string&gt; \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_UNIDADE   &lt;string&gt; \"2454793\", \"2454793\", \"2436027\", \"3340392\", \"3340392\", \"…\n$ DT_SIN_PRI   &lt;string&gt; \"2007-02-09\", \"2007-02-10\", \"2007-02-21\", \"2007-01-28\", …\n$ SEM_PRI      &lt;string&gt; \"200706\", \"200706\", \"200708\", \"200705\", \"200703\", \"20070…\n$ CS_SEXO      &lt;string&gt; \"Feminino\", \"Feminino\", \"Masculino\", \"Feminino\", \"Mascul…\n$ CS_GESTANT   &lt;string&gt; \"Ignorado\", \"Ignorado\", \"Não se aplica\", \"Não se aplica\"…\n$ CS_RACA      &lt;string&gt; \"Parda\", \"Parda\", \"Branca\", \"Branca\", \"Parda\", \"Parda\", …\n$ CS_ESCOL_N   &lt;string&gt; \"5a à 8a série incompleta do EF (antigo ginásio ou 1o gr…\n$ SG_UF        &lt;string&gt; \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MN_RESI   &lt;string&gt; \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_RG_RESI   &lt;string&gt; \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_PAIS      &lt;string&gt; \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASI…\n$ NDUPLIC_N    &lt;string&gt; \"Não identificado\", \"Não identificado\", NA, NA, NA, NA, …\n$ DT_DIGITA    &lt;string&gt; NA, NA, \"2007-03-08\", \"2007-05-22\", \"2007-05-02\", \"2007-…\n$ CS_FLXRET    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ FLXRECEBI    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MIGRADO_W    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INVEST    &lt;string&gt; \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ ID_OCUPA_N   &lt;string&gt; \"Nao informada\", \"Nao informada\", NA, \"Nao informada\", \"…\n$ DT_SORO      &lt;string&gt; NA, NA, \"2007-02-26\", \"2007-02-01\", \"2007-02-09\", NA, NA…\n$ RESUL_SORO   &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não reagente\", \"Reage…\n$ HISTOPA_N    &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_VIRAL     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, \"2007-02-14\", NA, NA, NA…\n$ RESUL_VI_N   &lt;string&gt; \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ SOROTIPO     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, \"DEN 3\", NA, NA, NA, NA,…\n$ IMUNOH_N     &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_PCR       &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ RESUL_PCR_   &lt;string&gt; \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ CLASSI_FIN   &lt;string&gt; \"Dengue clássico\", \"Dengue clássico\", \"Descartado\", \"Den…\n$ CRITERIO     &lt;string&gt; \"Clínico epidemiológico\", \"Clínico epidemiológico\", \"Clí…\n$ TPAUTOCTO    &lt;string&gt; \"Sim\", \"Sim\", NA, \"Não\", \"Sim\", NA, NA, \"Não\", \"Sim\", NA…\n$ COUFINF      &lt;string&gt; \"Maranhão\", \"Maranhão\", NA, \"Bahia\", \"Bahia\", NA, NA, \"B…\n$ COPAISINF    &lt;string&gt; \"BRASIL\", \"BRASIL\", NA, \"BRASIL\", \"BRASIL\", NA, NA, \"BRA…\n$ COMUNINF     &lt;string&gt; \"210780\", \"210780\", NA, \"292150\", \"292150\", NA, NA, \"292…\n$ DOENCA_TRA   &lt;string&gt; \"Não\", \"Não\", NA, \"Não\", \"Não\", NA, NA, \"Não\", \"Não\", NA…\n$ EVOLUCAO     &lt;string&gt; \"Cura\", \"Cura\", NA, \"Cura\", \"Cura\", NA, NA, \"Cura\", \"Cur…\n$ DT_OBITO     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_ENCERRA   &lt;string&gt; \"2007-05-08\", \"2007-05-08\", \"2007-04-19\", \"2007-05-28\", …\n$ MANI_HEMOR   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EPISTAXE     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ GENGIVO      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ METRO        &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PETEQUIAS    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HEMATURA     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ SANGRAM      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ LACO_N       &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLASMATICO   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EVIDENCIA    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLAQ_MENOR   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ CON_FHD      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ COMPLICA     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HOSPITALIZ   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INTERNA   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ UF           &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MUNICIPIO    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEminutos &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEhoras   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEdias    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEmeses   &lt;string&gt; NA, NA, NA, \"0\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ IDADEanos    &lt;string&gt; \"3\", \"1\", \"3\", NA, \"0\", \"1\", \"3\", \"0\", \"3\", \"0\", \"1\", \"2…\n$ munResStatus &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResTipo   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResNome   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResUf     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLat    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLon    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResAlt    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResArea   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\nCall `print()` for full schema details"
  },
  {
    "objectID": "dengue-data/case_classification.html",
    "href": "dengue-data/case_classification.html",
    "title": "Case classification analysis",
    "section": "",
    "text": "This is a descriptive report about dengue case classification and criteria."
  },
  {
    "objectID": "dengue-data/case_classification.html#context",
    "href": "dengue-data/case_classification.html#context",
    "title": "Case classification analysis",
    "section": "",
    "text": "This report presents a description report about dengue case classification and criteria."
  },
  {
    "objectID": "dengue-data/case_classification.html#packages",
    "href": "dengue-data/case_classification.html#packages",
    "title": "Case classification analysis",
    "section": "Packages",
    "text": "Packages\n\nlibrary(tidyverse)\nlibrary(arrow)\nlibrary(knitr)\nlibrary(lubridate)"
  },
  {
    "objectID": "dengue-data/case_classification.html#load-data",
    "href": "dengue-data/case_classification.html#load-data",
    "title": "Case classification analysis",
    "section": "Load data",
    "text": "Load data\n\nimportant_vars &lt;- c(\"DT_SIN_PRI\", \"RESUL_SORO\", \"SOROTIPO\", \"CLASSI_FIN\", \"CRITERIO\")\n\nvalid_interval &lt;- interval(ymd(\"2011-01-01\"), ymd(\"2021-12-31\"))\n\ndengue &lt;- open_dataset(sources = \"parquets/\") %&gt;%\n  select(all_of(important_vars)) %&gt;%\n  collect() %&gt;%\n  mutate(DT_SIN_PRI = ymd(DT_SIN_PRI)) %&gt;%\n  filter(DT_SIN_PRI %within% valid_interval) %&gt;%\n  filter(CLASSI_FIN != \"6\")"
  },
  {
    "objectID": "dengue-data/case_classification.html#final-classification-and-criteria",
    "href": "dengue-data/case_classification.html#final-classification-and-criteria",
    "title": "Case classification analysis",
    "section": "Final classification and criteria",
    "text": "Final classification and criteria\n\ndengue %&gt;%\n  group_by(CLASSI_FIN, CRITERIO) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() %&gt;%\n  kable(\n    format.args = list(big.mark = \".\", decimal.mark = \",\")\n  )\n\n`summarise()` has grouped output by 'CLASSI_FIN'. You can override using the\n`.groups` argument.\n\n\n\n\n\nCLASSI_FIN\nCRITERIO\nfreq\n\n\n\n\nDengue\nClínico epidemiológico\n3.527.885\n\n\nDengue\nEm investigação\n62.457\n\n\nDengue\nLaboratório\n2.064.344\n\n\nDengue\nNA\n16\n\n\nDengue clássico\nClínico epidemiológico\n1.439.136\n\n\nDengue clássico\nEm investigação\n16.796\n\n\nDengue clássico\nLaboratório\n880.966\n\n\nDengue clássico\nNA\n7\n\n\nDengue com complicações\nClínico epidemiológico\n8.249\n\n\nDengue com complicações\nEm investigação\n595\n\n\nDengue com complicações\nLaboratório\n9.973\n\n\nDengue com sinais de alarme\nClínico epidemiológico\n41.859\n\n\nDengue com sinais de alarme\nEm investigação\n2.079\n\n\nDengue com sinais de alarme\nLaboratório\n38.350\n\n\nDengue grave\nClínico epidemiológico\n1.452\n\n\nDengue grave\nEm investigação\n447\n\n\nDengue grave\nLaboratório\n5.481\n\n\nDescartado\nClínico epidemiológico\n2.495.845\n\n\nDescartado\nEm investigação\n9.383\n\n\nDescartado\nLaboratório\n2.845.345\n\n\nDescartado\nNA\n26\n\n\nFebre hemorrágica do dengue\nClínico epidemiológico\n2\n\n\nFebre hemorrágica do dengue\nEm investigação\n230\n\n\nFebre hemorrágica do dengue\nLaboratório\n5.041\n\n\nInconclusivo\nClínico epidemiológico\n17.369\n\n\nInconclusivo\nEm investigação\n60.306\n\n\nInconclusivo\nLaboratório\n7.750\n\n\nInconclusivo\nNA\n1.909.736\n\n\nSíndrome do choque do dengue\nClínico epidemiológico\n5\n\n\nSíndrome do choque do dengue\nEm investigação\n17\n\n\nSíndrome do choque do dengue\nLaboratório\n273\n\n\n\n\n\n\ndengue_classifications &lt;- c(\"Febre hemorrágica do dengue\", \"Síndrome do choque do dengue\", \"Dengue com sinais de alarme\",\n  \"Dengue clássico\", \"Dengue com complicações\", \"Dengue\",\n  \"Dengue grave\")\n\n\ndengue_cases_classification &lt;- dengue %&gt;% \n  mutate(CLASSI_FIN = case_when(\n    CLASSI_FIN %in% dengue_classifications ~ \"Confirmed\",\n    CLASSI_FIN == \"Descartado\" ~ \"Discarded\",\n    CLASSI_FIN == \"Inconclusivo\" ~ \"Inconclusive\",\n    CLASSI_FIN == 6 ~ \"Invalid\",\n    is.na(CLASSI_FIN) ~ \"Missing\",\n    .default = CLASSI_FIN\n  )) %&gt;%\n  mutate(DT_SIN_PRI = lubridate::ceiling_date(x = DT_SIN_PRI, unit = \"month\")) %&gt;%\n  group_by(DT_SIN_PRI, CLASSI_FIN) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup() \n\n`summarise()` has grouped output by 'DT_SIN_PRI'. You can override using the\n`.groups` argument.\n\n\n\nwrite_parquet(x = dengue_cases_classification, sink = \"parquet_classification/dengue_cases_classification.parquet\")\n\n\nggplot(data =  dengue_cases_classification, aes(x = DT_SIN_PRI, weight = freq, fill = CLASSI_FIN)) +\n  geom_bar() +\n  scale_fill_hue(direction = 1) +\n  scale_y_continuous(labels = scales::comma) +\n  labs(fill = \"Classificação\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\") +\n  labs(x = \"Month of first symptom's onset\", y = \"Records\", fill = \"Classification\")\n\n\n\nggsave(filename = \"dengue_cases_classification.pdf\")\n\nSaving 7 x 5 in image"
  },
  {
    "objectID": "dengue-data/case_classification.html#sorological-examination",
    "href": "dengue-data/case_classification.html#sorological-examination",
    "title": "Case classification analysis",
    "section": "Sorological examination",
    "text": "Sorological examination\n\ndengue %&gt;%\n  filter(CLASSI_FIN %in% dengue_classifications) %&gt;%\n  group_by(SOROTIPO) %&gt;%\n  summarise(freq = n()) %&gt;%\n  ungroup()\n\n# A tibble: 5 × 2\n  SOROTIPO    freq\n  &lt;chr&gt;      &lt;int&gt;\n1 DEN 1      28619\n2 DEN 2      16429\n3 DEN 3        209\n4 DEN 4       6122\n5 &lt;NA&gt;     8054281"
  },
  {
    "objectID": "dengue-data/case_classification.html#session-info",
    "href": "dengue-data/case_classification.html#session-info",
    "title": "Case classification analysis",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.2.0 (2022-04-22)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 13.4\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] knitr_1.43      arrow_12.0.1    lubridate_1.9.2 forcats_1.0.0  \n [5] stringr_1.5.0   dplyr_1.1.2     purrr_1.0.1     readr_2.1.4    \n [9] tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.2   tidyverse_2.0.0\n\nloaded via a namespace (and not attached):\n [1] compiler_4.2.0    pillar_1.9.0      tools_4.2.0       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       systemfonts_1.0.4 generics_0.1.3   \n[21] vctrs_0.6.3       htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5      \n[25] grid_4.2.0        tidyselect_1.2.0  glue_1.6.2        R6_2.5.1         \n[29] textshaping_0.3.6 fansi_1.0.4       rmarkdown_2.22    farver_2.1.1     \n[33] tzdb_0.4.0        magrittr_2.0.3    scales_1.2.1      htmltools_0.5.5  \n[37] assertthat_0.2.1  colorspace_2.1-0  ragg_1.2.5        labeling_0.4.2   \n[41] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  },
  {
    "objectID": "weather_data.html",
    "href": "weather_data.html",
    "title": "Weather data",
    "section": "",
    "text": "Zonal statistics such as mean, maximum, minimum, standard deviation, and sum were computed by taking into account the data cells that intersect the boundaries of each municipality and stored in Parquet files.\nThis procedure was carried out for all Brazilian municipalities, and for all available dates, for every indicator available in the weather products BR-DWGD and TerraClimate."
  },
  {
    "objectID": "weather_data.html#introduction",
    "href": "weather_data.html#introduction",
    "title": "Weather data",
    "section": "",
    "text": "Zonal statistics such as mean, maximum, minimum, standard deviation, and sum were computed by taking into account the data cells that intersect the boundaries of each municipality and stored in Parquet files.\nThis procedure was carried out for all Brazilian municipalities, and for all available dates, for every indicator available in the weather products BR-DWGD and TerraClimate."
  },
  {
    "objectID": "weather_data.html#methodology",
    "href": "weather_data.html#methodology",
    "title": "Weather data",
    "section": "Methodology",
    "text": "Methodology\nZonal statistics are descriptive statistics calculated using a set of cells that spatially intersects a given spatial boundary. For each boundary in a map, statistics like average, maximum value, minimum value, standard deviation, and sum are obtained to represent the cell’s values that intersect the boundary.\nThe Brazilian municipality boundaries from 2010 were used as a reference, as provided by the geobr package.\nThus, for each municipality, a set of zonal statistics of weather indicators is calculated, at the same time resolution of the source dataset.\n\n\n\n\n\nThose datasets are available as parquet files on S3 buckets and queried by this project functions to retrieve data for a given municipality, dates, weather indicators, and desired zonal statistics."
  },
  {
    "objectID": "weather_data.html#results",
    "href": "weather_data.html#results",
    "title": "Weather data",
    "section": "Results",
    "text": "Results\n\nZonal BR-DWGD\n\nXavier, A. C., Scanlon, B. R., King, C. W., & Alves, A. I. (2022). New improved Brazilian daily weather gridded data (1961–2020). International Journal of Climatology. https://doi.org/10.1002/joc.7731\n\nThe BR-DWGD dataset presents daily meteorological data interpolated to a grid with 0.1° × 0.1° of spatial resolution for the Brazilian territory, with daily data from January 1, 1961, to July 31, 2020. It used data from 1,252 weather stations and 11,473 rain gauges in its interpolation methods, cross-validated to the selection of the best method for each weather indicator.\nThe following weather indicators are available from the BR-DWGD study: precipitation (mm), minimum temperature (°C), maximum temperature (°C), solar radiation (MJ⋅m−2), wind speed at 2m height (m⋅s−1) and relative humidity (%).\n\nbrclimr::product_info(product = \"brdwgd\")\n\n&lt;list&gt;\n├─tmax: &lt;list&gt;\n│ ├─name: \"Maximum temperature\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"Tmax_min\"\n│   ├─max: \"Tmax_max\"\n│   ├─mean: \"Tmax_mean\"\n│   └─sd: \"Tmax_sd\"\n├─tmin: &lt;list&gt;\n│ ├─name: \"Minimum temperature\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"Tmin_min\"\n│   ├─max: \"Tmin_max\"\n│   ├─mean: \"Tmin_mean\"\n│   └─sd: \"Tmin_sd\"\n├─pr: &lt;list&gt;\n│ ├─name: \"Precipitation\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"pr_min\"\n│   ├─max: \"pr_max\"\n│   ├─mean: \"pr_mean\"\n│   ├─sd: \"pr_sd\"\n│   └─sum: \"pr_sum\"\n├─eto: &lt;list&gt;\n│ ├─name: \"Evapotranspiration\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"ETo_min\"\n│   ├─max: \"ETo_max\"\n│   ├─mean: \"ETo_mean\"\n│   ├─sd: \"ETo_sd\"\n│   └─sum: \"ETo_sd\"\n├─rh: &lt;list&gt;\n│ ├─name: \"Relative humidity\"\n│ ├─unit: \"Percentage\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"RH_min\"\n│   ├─max: \"RH_max\"\n│   ├─mean: \"RH_mean\"\n│   └─sd: \"RH_sd\"\n├─rs: &lt;list&gt;\n│ ├─name: \"Solar radiation\"\n│ ├─unit: \"MJ/m2\"\n│ ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"Rs_min\"\n│   ├─max: \"Rs_max\"\n│   ├─mean: \"Rs_mean\"\n│   └─sd: \"Rs_sd\"\n└─u2: &lt;list&gt;\n  ├─name: \"Wind speed\"\n  ├─unit: \"m/2\"\n  ├─date_range: \"Daily, 1961-01-01 to 2020-07-31\"\n  └─stats: &lt;list&gt;\n    ├─min: \"u2_min\"\n    ├─max: \"u2_max\"\n    ├─mean: \"u2_mean\"\n    └─sd: \"u2_sd\"\n\n\n\n\nZonal TerraClimate\n\nAbatzoglou, J. T., Dobrowski, S. Z., Parks, S. A., Hegewisch, K. C. (2018). TerraClimate, a high-resolution global dataset of monthly climate and climatic water balance from 1958-2015. Scientific Data, 5. https://doi.org/10.1038/sdata.2017.191\n\nThe TerraClimate dataset presents monthly meteorological data interpolated to a grid with 0.04° × 0.04° (1/24th degree) of spatial resolution with world cover, with monthly data from January, 1958, to December, 2021.\nThe following weather indicators are available from the TerraClimate study: Actual Evapotranspiration (mm), Climate Water Deficit (mm), Potential evapotranspiration(mm), Precipitation (mm), Runoff (mm), Soil Moisture (mm), Downward surface shortwave radiation (W/m2), Snow water equivalent (mm), Minimum temperature (°C), Maximum temperature (°C), Vapor pressure (kPa), Wind speed (m/s), Vapor Pressure Deficit (kpa) and Palmer Drought Severity Index.\n\nbrclimr::product_info(product = \"terraclimate\")\n\n&lt;list&gt;\n├─tmax: &lt;list&gt;\n│ ├─name: \"Maximum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"tmax_min\"\n│   ├─max: \"tmax_max\"\n│   ├─mean: \"tmax_mean\"\n│   └─sd: \"tmax_sd\"\n├─tmin: &lt;list&gt;\n│ ├─name: \"Minimum temperature\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"Degree Celsius\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"tmin_min\"\n│   ├─max: \"tmin_max\"\n│   ├─mean: \"tmin_mean\"\n│   └─sd: \"tmin_sd\"\n├─ppt: &lt;list&gt;\n│ ├─name: \"Precipitation\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"ppt_min\"\n│   ├─max: \"ppt_max\"\n│   ├─mean: \"ppt_mean\"\n│   ├─sd: \"ppt_sd\"\n│   └─sum: \"ppt_sum\"\n├─aet: &lt;list&gt;\n│ ├─name: \"Actual Evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"aet_min\"\n│   ├─max: \"aet_max\"\n│   ├─mean: \"aet_mean\"\n│   ├─sd: \"aet_sd\"\n│   └─sum: \"aet_sum\"\n├─def: &lt;list&gt;\n│ ├─name: \"Climate Water Deficit\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"def_min\"\n│   ├─max: \"def_max\"\n│   ├─mean: \"def_mean\"\n│   ├─sd: \"def_sd\"\n│   └─sum: \"def_sum\"\n├─pdsi: &lt;list&gt;\n│ ├─name: \"Palmer Drought Severity Index\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"unitless\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"PDSI_min\"\n│   ├─max: \"PDSI_max\"\n│   ├─mean: \"PDSI_mean\"\n│   └─sd: \"PDSI_sd\"\n├─pet: &lt;list&gt;\n│ ├─name: \"Potential evapotranspiration\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"pet_min\"\n│   ├─max: \"pet_max\"\n│   ├─mean: \"pet_mean\"\n│   ├─sd: \"pet_sd\"\n│   └─sum: \"pet_sum\"\n├─q: &lt;list&gt;\n│ ├─name: \"Runoff\"\n│ ├─detail: \"Monthly total\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"q_min\"\n│   ├─max: \"q_max\"\n│   ├─mean: \"q_mean\"\n│   ├─sd: \"q_sd\"\n│   └─sum: \"q_sum\"\n├─soil: &lt;list&gt;\n│ ├─name: \"Soil Moisture\"\n│ ├─detail: \"Total column, at end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"soil_min\"\n│   ├─max: \"soil_max\"\n│   ├─mean: \"soil_mean\"\n│   ├─sd: \"soil_sd\"\n│   └─sum: \"soil_sum\"\n├─srad: &lt;list&gt;\n│ ├─name: \"Downward surface shortwave radia...\"\n│ ├─unit: \"W/m2\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"srad_min\"\n│   ├─max: \"srad_max\"\n│   ├─mean: \"srad_mean\"\n│   ├─sd: \"srad_sd\"\n│   └─sum: \"srad_sum\"\n├─swe: &lt;list&gt;\n│ ├─name: \"Snow water equivalent\"\n│ ├─detail: \"At end of month\"\n│ ├─unit: \"mm\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"swe_min\"\n│   ├─max: \"swe_max\"\n│   ├─mean: \"swe_mean\"\n│   ├─sd: \"swe_sd\"\n│   └─sum: \"swe_sum\"\n├─vap: &lt;list&gt;\n│ ├─name: \"Vapor pressure\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"vap_min\"\n│   ├─max: \"vap_max\"\n│   ├─mean: \"vap_mean\"\n│   └─sd: \"vap_sd\"\n├─vpd: &lt;list&gt;\n│ ├─name: \"Vapor Pressure Deficit\"\n│ ├─detail: \"Average for month\"\n│ ├─unit: \"kPa\"\n│ ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n│ └─stats: &lt;list&gt;\n│   ├─min: \"vpd_min\"\n│   ├─max: \"vpd_max\"\n│   ├─mean: \"vpd_mean\"\n│   └─sd: \"vpd_sd\"\n└─ws: &lt;list&gt;\n  ├─name: \"Wind speed\"\n  ├─detail: \"Average for month\"\n  ├─unit: \"m/s\"\n  ├─date_range: \"Monthly, 1958-01 to 2021-12\"\n  └─stats: &lt;list&gt;\n    ├─min: \"ws_min\"\n    ├─max: \"ws_max\"\n    ├─mean: \"ws_mean\"\n    └─sd: \"ws_sd\""
  },
  {
    "objectID": "weather_data.html#availability",
    "href": "weather_data.html#availability",
    "title": "Weather data",
    "section": "Availability",
    "text": "Availability\n\nParquet files\nThe results are available to use as parquet format files. Access the following DOIs to access and download the files.\n\nZonal BR-DWGD\n\n\n\n\n\n\n\nZonal TerraClimate\n\n\n\n\n\n\n\n\nR package brclimr\nWe created an R package to on-line access those parquet files and download data for a user especified municipality. More details on https://rfsaldanha.github.io/brclimr"
  },
  {
    "objectID": "software.html",
    "href": "software.html",
    "title": "Software",
    "section": "",
    "text": "An R package to on-line access zonal statistics from weather indicators that were calculated for each municipality in Brazil using data from the BR-DWGD and TerraClimate projects.\nMore details on https://rfsaldanha.github.io/brclimr"
  },
  {
    "objectID": "software.html#brclimr",
    "href": "software.html#brclimr",
    "title": "Software",
    "section": "",
    "text": "An R package to on-line access zonal statistics from weather indicators that were calculated for each municipality in Brazil using data from the BR-DWGD and TerraClimate projects.\nMore details on https://rfsaldanha.github.io/brclimr"
  },
  {
    "objectID": "software.html#epifeat",
    "href": "software.html#epifeat",
    "title": "Software",
    "section": "epifeat",
    "text": "epifeat\nAn R package to extract epidemiological features from cases time series.\nMore details on https://github.com/rfsaldanha/happyfeat"
  },
  {
    "objectID": "presentations/presentation_test.html#isso-é-um-teste",
    "href": "presentations/presentation_test.html#isso-é-um-teste",
    "title": "Teste de apresentação",
    "section": "Isso é um teste",
    "text": "Isso é um teste\n\nbla\nbla bla\nbla"
  },
  {
    "objectID": "dengue_model.html",
    "href": "dengue_model.html",
    "title": "Overview",
    "section": "",
    "text": "In this section there are notebooks for dengue modelling.\n\n\n\n Back to top"
  },
  {
    "objectID": "export-data/exported_data.html",
    "href": "export-data/exported_data.html",
    "title": "Exported data",
    "section": "",
    "text": "library(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(brpop)\nlibrary(piggyback)"
  },
  {
    "objectID": "export-data/exported_data.html#packages",
    "href": "export-data/exported_data.html#packages",
    "title": "Exported data",
    "section": "",
    "text": "library(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(brpop)\nlibrary(piggyback)"
  },
  {
    "objectID": "export-data/exported_data.html#dengue-data",
    "href": "export-data/exported_data.html#dengue-data",
    "title": "Exported data",
    "section": "Dengue data",
    "text": "Dengue data\nTotal number of confirmed dengue cases, aggregated per municipality of residence and week of the first symptom’s onset.\n\ndengue &lt;- read_parquet(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %&gt;%\n  group_by(mun) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"week\", freq = sum(freq, na.rm = TRUE)) %&gt;%\n  ungroup() %&gt;%\n  rename(cases = freq)"
  },
  {
    "objectID": "export-data/exported_data.html#population",
    "href": "export-data/exported_data.html#population",
    "title": "Exported data",
    "section": "Population",
    "text": "Population\nEstimated municipality population per year.\n\npop &lt;- mun_pop_totals() %&gt;%\n  filter(year %in% seq(year(min(dengue$date)), year(max(dengue$date)))) %&gt;%\n  mutate(mun = as.character(mun))"
  },
  {
    "objectID": "export-data/exported_data.html#human-development-index",
    "href": "export-data/exported_data.html#human-development-index",
    "title": "Exported data",
    "section": "Human Development Index",
    "text": "Human Development Index\n\nhdi &lt;- read_parquet(\"../socioeconomic-data/hdi.parquet\") %&gt;%\n  select(code_muni, hdi2010 = idhm2010)"
  },
  {
    "objectID": "export-data/exported_data.html#weather-data",
    "href": "export-data/exported_data.html#weather-data",
    "title": "Exported data",
    "section": "Weather data",
    "text": "Weather data\nWeather indicators estimated by using zonal statistics of the territorial area of the municipality.\n\nPrecipitation\nTotal estimated precipitation, per municipality and week, in millimeter.\n\nprec &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(name == \"pr_sum\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue$date) & date &lt;= max(dengue$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"week\", value = sum(value, na.rm = TRUE)) %&gt;%\n  rename(prec = value)\n\n\n\nAverage maximun temperature\nAverage of maximum temperatures, per municipality and week, in celsius.\n\ntmax &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %&gt;%\n  filter(name == \"Tmax_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue$date) & date &lt;= max(dengue$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"week\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(tmax = value)\n\n\n\nAverage minimum temperature\nAverage of minimum temperatures, per municipality and week, in celsius.\n\ntmin &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmin.parquet\") %&gt;%\n  filter(name == \"Tmin_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue$date) & date &lt;= max(dengue$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"week\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(tmin = value)"
  },
  {
    "objectID": "export-data/exported_data.html#join-data",
    "href": "export-data/exported_data.html#join-data",
    "title": "Exported data",
    "section": "Join data",
    "text": "Join data\n\nexp_data &lt;- dengue %&gt;%\n  mutate(dengue_year = year(date)) %&gt;%\n  inner_join(pop, by = c(\"dengue_year\" = \"year\", \"mun\")) %&gt;%\n  select(-dengue_year) %&gt;%\n  inner_join(hdi, by = c(\"mun\" = \"code_muni\")) %&gt;%\n  inner_join(prec, by = \"date\") %&gt;%\n  inner_join(tmax, by = \"date\") %&gt;%\n  inner_join(tmin, by = \"date\")"
  },
  {
    "objectID": "export-data/exported_data.html#lag-weather-variables",
    "href": "export-data/exported_data.html#lag-weather-variables",
    "title": "Exported data",
    "section": "Lag weather variables",
    "text": "Lag weather variables\nLag one and two weeks.\n\nexp_data &lt;- exp_data %&gt;%\n  tk_augment_lags(.value = c(prec, tmax, tmin), .lags = 1:2)"
  },
  {
    "objectID": "export-data/exported_data.html#overview",
    "href": "export-data/exported_data.html#overview",
    "title": "Exported data",
    "section": "Overview",
    "text": "Overview\n\nglimpse(exp_data)\n\nRows: 2,202,058\nColumns: 14\n$ mun       &lt;chr&gt; \"110001\", \"110001\", \"110001\", \"110001\", \"110001\", \"110001\", …\n$ date      &lt;date&gt; 2011-03-13, 2011-03-20, 2011-03-27, 2011-04-03, 2011-04-10,…\n$ cases     &lt;int&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ pop       &lt;int&gt; 24737, 24737, 24737, 24737, 24737, 24737, 24737, 24737, 2473…\n$ hdi2010   &lt;dbl&gt; 0.641, 0.641, 0.641, 0.641, 0.641, 0.641, 0.641, 0.641, 0.64…\n$ prec      &lt;dbl&gt; 5977667, 5832714, 6581013, 6411878, 5538108, 4712170, 412114…\n$ tmax      &lt;dbl&gt; 29.89511, 29.59591, 29.72916, 29.27960, 29.05301, 29.32273, …\n$ tmin      &lt;dbl&gt; 20.19973, 20.17791, 20.34251, 19.15049, 19.11662, 19.37211, …\n$ prec_lag1 &lt;dbl&gt; NA, 5977667, 5832714, 6581013, 6411878, 5538108, 4712170, 41…\n$ tmax_lag1 &lt;dbl&gt; NA, 29.89511, 29.59591, 29.72916, 29.27960, 29.05301, 29.322…\n$ tmin_lag1 &lt;dbl&gt; NA, 20.19973, 20.17791, 20.34251, 19.15049, 19.11662, 19.372…\n$ prec_lag2 &lt;dbl&gt; NA, NA, 5977667, 5832714, 6581013, 6411878, 5538108, 4712170…\n$ tmax_lag2 &lt;dbl&gt; NA, NA, 29.89511, 29.59591, 29.72916, 29.27960, 29.05301, 29…\n$ tmin_lag2 &lt;dbl&gt; NA, NA, 20.19973, 20.17791, 20.34251, 19.15049, 19.11662, 19…\n\n\nMunicipalities count: 5167"
  },
  {
    "objectID": "export-data/exported_data.html#export-data",
    "href": "export-data/exported_data.html#export-data",
    "title": "Exported data",
    "section": "Export data",
    "text": "Export data\n\nexp_data %&gt;% write_parquet(sink = \"exp_data.parquet\")\n\n\nexp_data %&gt;% write_csv(file = \"exp_data.csv\")\nzip::zip(zipfile = \"exp_data.csv.zip\", files = \"exp_data.csv\")\nunlink(x = \"exp_data.csv\")"
  },
  {
    "objectID": "export-data/exported_data.html#data-dictionary",
    "href": "export-data/exported_data.html#data-dictionary",
    "title": "Exported data",
    "section": "Data dictionary",
    "text": "Data dictionary\n\nmun character. Municipality code with 6 digits\ndate date. Date on format YYYY-MM-DD of the ceiling data of the week\ncases integer. Confirmed dengue cases count\npop integer. Population estimation of the municipality\nhdi2010 double. Human Development Index for 2010\nprec double. Total precipitation, mm\ntmax double. Average maximum temperature, Celsius\ntmin double. Average minimum temperature, Celsius\n*_lag1 double. One week lagged variables\n*_lag2 double. Two weeks lagged variables"
  },
  {
    "objectID": "export-data/exported_data.html#include-on-current-github-release",
    "href": "export-data/exported_data.html#include-on-current-github-release",
    "title": "Exported data",
    "section": "Include on current GitHub release",
    "text": "Include on current GitHub release\n\n# Files list to upload\nfiles_list &lt;- c(\"exp_data.parquet\", \"exp_data.csv.zip\")\n\n# Upload files\nfor(i in files_list){\n  pb_upload(file = i, repo = \"rfsaldanha/dengue\", overwrite = TRUE)\n}\n\nFiles exp_data.parquet and exp_data.csv.zip available on current release: https://github.com/rfsaldanha/dengue/releases"
  },
  {
    "objectID": "export-data/exported_data.html#session-info",
    "href": "export-data/exported_data.html#session-info",
    "title": "Exported data",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] piggyback_0.1.4.9006 brpop_0.3.0          timetk_2.8.3        \n [4] arrow_12.0.1         lubridate_1.9.2      forcats_1.0.0       \n [7] stringr_1.5.0        dplyr_1.1.2          purrr_1.0.1         \n[10] readr_2.1.4          tidyr_1.3.0          tibble_3.2.1        \n[13] ggplot2_3.4.2        tidyverse_2.0.0     \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         httr_1.4.6         \n [4] DiceDesign_1.9      gh_1.4.0            tools_4.1.2        \n [7] utf8_1.2.3          R6_2.5.1            rpart_4.1.16       \n[10] colorspace_2.1-0    yardstick_1.2.0     nnet_7.3-17        \n[13] withr_2.5.0         tidyselect_1.2.0    curl_5.0.1         \n[16] bit_4.0.5           compiler_4.1.2      httr2_0.2.3        \n[19] cli_3.6.1           scales_1.2.1        tune_1.1.1         \n[22] rappdirs_0.3.3      digest_0.6.31       rmarkdown_2.22     \n[25] pkgconfig_2.0.3     htmltools_0.5.5     parallelly_1.36.0  \n[28] lhs_1.1.6           fastmap_1.1.1       htmlwidgets_1.6.2  \n[31] rlang_1.1.1         rstudioapi_0.14     generics_0.1.3     \n[34] zoo_1.8-12          jsonlite_1.8.5      vroom_1.6.3        \n[37] zip_2.3.0           magrittr_2.0.3      Matrix_1.5-4.1     \n[40] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[43] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[46] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[49] recipes_1.0.6       grid_4.1.2          parallel_4.1.2     \n[52] listenv_0.9.0       crayon_1.5.2        lattice_0.20-45    \n[55] splines_4.1.2       hms_1.1.3           knitr_1.43         \n[58] pillar_1.9.0        dials_1.2.0         future.apply_1.11.0\n[61] codetools_0.2-18    parsnip_1.1.0       glue_1.6.2         \n[64] evaluate_0.21       rsample_1.1.1       data.table_1.14.8  \n[67] vctrs_0.6.3         tzdb_0.4.0          foreach_1.5.2      \n[70] gtable_0.3.3        future_1.32.0       assertthat_0.2.1   \n[73] cachem_1.0.8        xfun_0.39           gower_1.0.1        \n[76] mime_0.12           prodlim_2023.03.31  gitcreds_0.1.2     \n[79] class_7.3-20        survival_3.2-13     timeDate_4022.108  \n[82] iterators_1.0.14    memoise_2.0.1       hardhat_1.3.0      \n[85] lava_1.7.2.1        workflows_1.1.3     timechange_0.2.0   \n[88] globals_0.16.2      ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html",
    "title": "Dengue case classification",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(finetune)\nlibrary(tictoc)\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#packages",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#packages",
    "title": "Dengue case classification",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(knitr)\nlibrary(lubridate)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(finetune)\nlibrary(tictoc)\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#data",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#data",
    "title": "Dengue case classification",
    "section": "Data",
    "text": "Data\n\n# Data sources\nfiles_list &lt;- c(\n  \"../dengue-data/parquets/dengue_2016.parquet\",\n  \"../dengue-data/parquets/dengue_2017.parquet\",\n  \"../dengue-data/parquets/dengue_2018.parquet\",\n  \"../dengue-data/parquets/dengue_2019.parquet\",\n  \"../dengue-data/parquets/dengue_2020.parquet\",\n  \"../dengue-data/parquets/dengue_2021.parquet\"\n)\n\n# Independent variables\nx_vars &lt;- c(\"FEBRE\", \"MIALGIA\", \"CEFALEIA\", \n            \"EXANTEMA\", \"VOMITO\", \"NAUSEA\", \n            \"DOR_COSTAS\", \"CONJUNTVIT\", \n            \"ARTRITE\", \"ARTRALGIA\", \"PETEQUIA_N\", \n            \"LEUCOPENIA\", \"LACO\", \"DOR_RETRO\", \n            \"DIABETES\", \"HEMATOLOG\", \"HEPATOPAT\", \n            \"HEPATOPAT\", \"RENAL\", \"HIPERTENSA\",\n            \"ACIDO_PEPT\", \"AUTO_IMUNE\")\n\n# Prepare data\ndengue &lt;- arrow::open_dataset(sources = files_list) %&gt;%\n  # Select variables\n  select(all_of(c(\"CLASSI_FIN\", \"COMUNINF\", \"DT_SIN_PRI\", x_vars))) %&gt;%\n  # Filter out \"Inconclusivo\" cases\n  filter(CLASSI_FIN != \"Inconclusivo\") %&gt;%\n  # Collect data from parquet files\n  collect() %&gt;%\n  # Prepare variables\n  mutate(CLASSI_FIN = case_when(\n    CLASSI_FIN != \"Descartado\" ~ TRUE,\n    .default = FALSE\n  )) %&gt;%\n  mutate(CLASSI_FIN = as.factor(CLASSI_FIN)) %&gt;%\n  mutate(DT_SIN_PRI = as_date(DT_SIN_PRI)) %&gt;%\n  mutate(COMUNINF = as.factor(COMUNINF)) %&gt;%\n  mutate_at(.vars = x_vars, .funs = ~ . == \"Sim\") \n\n\n# Smaller dataset for tests\ndengue &lt;- sample_n(dengue, 10000)"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#modeling",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#modeling",
    "title": "Dengue case classification",
    "section": "Modeling",
    "text": "Modeling\n\nTrain and test dataset split\n\nset.seed(123)\n\ndengue_split &lt;- dengue %&gt;%\n  initial_split(strata = CLASSI_FIN)\n\ndengue_train &lt;- training(dengue_split)\ndengue_test &lt;- testing(dengue_split)\n\nset.seed(234)\ndengue_folds &lt;- vfold_cv(dengue_train, strata = CLASSI_FIN)\n\n\n\nRecipes\n\n# All variables\ndengue_rec_1 &lt;- \n  recipe(CLASSI_FIN ~ . , data = dengue_train) %&gt;%\n  step_date(DT_SIN_PRI, features = c(\"month\", \"week\", \"semester\", \"quarter\"), keep_original_cols = FALSE) %&gt;%\n  step_integer(all_predictors())\n\n\n# Without municipality code\ndengue_rec_2 &lt;- dengue_rec_1 %&gt;%\n  step_rm(COMUNINF)\n\n\n\nSpecifications\n\nXGB\n\nxgb_spec &lt;-\n  boost_tree(\n    trees = tune(),\n    min_n = tune(),\n    mtry = tune(),\n    learn_rate = 0.01\n  ) %&gt;%\n  set_engine(\"xgboost\") %&gt;%\n  set_mode(\"classification\")\n\n\n\nDecision tree\n\ncart_spec &lt;-\n  decision_tree(\n    cost_complexity = tune(), \n    min_n = tune()\n  ) %&gt;% \n  set_engine(\"rpart\") %&gt;% \n  set_mode(\"classification\")\n\n\n\n\nWorkflows\n\nall_workflows &lt;- \n  workflow_set(\n    preproc = list(recipe_1 = dengue_rec_1, recipe_2 = dengue_rec_2),\n    models = list(xgb = xgb_spec, cart = cart_spec)\n  )\n\n\n\nTuning\n\ndoParallel::registerDoParallel()\n\nrace_ctrl &lt;-\n   control_race(\n      save_pred = TRUE,\n      parallel_over = \"everything\",\n      save_workflow = TRUE\n   )\n\ntic()\nrace_results &lt;- \n  all_workflows %&gt;%\n  workflow_map(\n    \"tune_race_anova\",\n    seed = 345,\n    resamples = dengue_folds,\n    grid = 15,\n    control = race_ctrl\n  )\n\ni Creating pre-processing data to finalize unknown parameter: mtry\ni Creating pre-processing data to finalize unknown parameter: mtry\n\ntoc()\n\n179.59 sec elapsed\n\n\n\nRace metrics\n\ntrain_rank_results &lt;- rank_results(race_results, rank_metric = \"roc_auc\")\n\ntrain_rank_results\n\n# A tibble: 28 × 9\n   wflow_id     .config     .metric  mean std_err     n preprocessor model  rank\n   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;int&gt;\n 1 recipe_1_xgb Preprocess… accura… 0.853 0.00418    10 recipe       boos…     1\n 2 recipe_1_xgb Preprocess… roc_auc 0.896 0.00391    10 recipe       boos…     1\n 3 recipe_1_xgb Preprocess… accura… 0.852 0.00423    10 recipe       boos…     2\n 4 recipe_1_xgb Preprocess… roc_auc 0.895 0.00415    10 recipe       boos…     2\n 5 recipe_1_xgb Preprocess… accura… 0.852 0.00401    10 recipe       boos…     3\n 6 recipe_1_xgb Preprocess… roc_auc 0.894 0.00383    10 recipe       boos…     3\n 7 recipe_1_xgb Preprocess… accura… 0.853 0.00418    10 recipe       boos…     4\n 8 recipe_1_xgb Preprocess… roc_auc 0.894 0.00381    10 recipe       boos…     4\n 9 recipe_1_xgb Preprocess… accura… 0.850 0.00450    10 recipe       boos…     5\n10 recipe_1_xgb Preprocess… roc_auc 0.894 0.00375    10 recipe       boos…     5\n# ℹ 18 more rows\n\n\n\nautoplot(race_results, metric = \"roc_auc\")\n\n\n\n\n\n\n\nLast fit\n\nselection_train &lt;- train_rank_results %&gt;%\n  arrange(-mean) %&gt;%\n  pull(wflow_id) %&gt;%\n  first()\n\nselection_train\n\n[1] \"recipe_1_xgb\"\n\n\n\nbest_results &lt;- race_results %&gt;%\n  extract_workflow_set_result(selection_train) %&gt;%\n  select_best(\"accuracy\")\n\nbest_results\n\n# A tibble: 1 × 4\n   mtry trees min_n .config              \n  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;                \n1     4  1805    31 Preprocessor1_Model02\n\n\n\nlast_fit &lt;- race_results %&gt;%\n  extract_workflow(selection_train) %&gt;%\n  finalize_workflow(best_results) %&gt;%\n  last_fit(dengue_split)\n\n\n\nEvaluate on test\n\ncollect_metrics(last_fit)\n\n# A tibble: 2 × 4\n  .metric  .estimator .estimate .config             \n  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 accuracy binary         0.844 Preprocessor1_Model1\n2 roc_auc  binary         0.888 Preprocessor1_Model1\n\n\n\ncollect_predictions(last_fit) %&gt;%\n    conf_mat(CLASSI_FIN, .pred_class)\n\n          Truth\nPrediction FALSE TRUE\n     FALSE  1052  370\n     TRUE     21 1058\n\n\n\nlast_fit %&gt;%\n  extract_fit_engine() %&gt;%\n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_classification_symptoms_conditions_multi.html#session-info",
    "href": "dengue-model/dengue_classification_symptoms_conditions_multi.html#session-info",
    "title": "Dengue case classification",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] rpart_4.1.16       rlang_1.1.1        xgboost_1.7.5.1    vip_0.3.2         \n [5] tictoc_1.2         finetune_1.1.0     yardstick_1.2.0    workflowsets_1.0.1\n [9] workflows_1.1.3    tune_1.1.1         rsample_1.1.1      recipes_1.0.6     \n[13] parsnip_1.1.0      modeldata_1.1.0    infer_1.0.4        dials_1.2.0       \n[17] scales_1.2.1       broom_1.0.5        tidymodels_1.1.0   knitr_1.43        \n[21] arrow_12.0.1       lubridate_1.9.2    forcats_1.0.0      stringr_1.5.0     \n[25] dplyr_1.1.2        purrr_1.0.1        readr_2.1.4        tidyr_1.3.0       \n[29] tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] nlme_3.1-155        bit64_4.0.5         doParallel_1.0.17  \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            colorspace_2.1-0   \n[10] nnet_7.3-17         withr_2.5.0         clock_0.7.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           labeling_0.4.2     \n[19] digest_0.6.31       minqa_1.2.5         rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     lme4_1.1-33        \n[25] parallelly_1.36.0   lhs_1.1.6           fastmap_1.1.1      \n[28] htmlwidgets_1.6.2   rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      jsonlite_1.8.5      magrittr_2.0.3     \n[34] Matrix_1.5-4.1      Rcpp_1.0.10         munsell_0.5.0      \n[37] fansi_1.0.4         GPfit_1.0-8         lifecycle_1.0.3    \n[40] furrr_0.3.1         stringi_1.7.12      yaml_2.3.7         \n[43] MASS_7.3-55         grid_4.1.2          parallel_4.1.2     \n[46] listenv_0.9.0       lattice_0.20-45     splines_4.1.2      \n[49] hms_1.1.3           pillar_1.9.0        boot_1.3-28        \n[52] future.apply_1.11.0 codetools_0.2-18    glue_1.6.2         \n[55] evaluate_0.21       data.table_1.14.8   nloptr_2.0.3       \n[58] vctrs_0.6.3         tzdb_0.4.0          foreach_1.5.2      \n[61] gtable_0.3.3        future_1.32.0       assertthat_0.2.1   \n[64] xfun_0.39           gower_1.0.1         prodlim_2023.03.31 \n[67] class_7.3-20        survival_3.2-13     timeDate_4022.108  \n[70] iterators_1.0.14    hardhat_1.3.0       lava_1.7.2.1       \n[73] timechange_0.2.0    globals_0.16.2      ellipsis_0.3.2     \n[76] ipred_0.9-14"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html",
    "href": "dengue-model/dengue_weather_lag_reg.html",
    "title": "Dengue and weather lags, regression task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#packages",
    "href": "dengue-model/dengue_weather_lag_reg.html#packages",
    "title": "Dengue and weather lags, regression task",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.1.0 ──\n✔ broom        1.0.5     ✔ rsample      1.1.1\n✔ dials        1.2.0     ✔ tune         1.1.1\n✔ infer        1.0.4     ✔ workflows    1.1.3\n✔ modeldata    1.1.0     ✔ workflowsets 1.0.1\n✔ parsnip      1.1.0     ✔ yardstick    1.2.0\n✔ recipes      1.0.6     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Search for functions across packages at https://www.tidymodels.org/find/\n\nlibrary(arrow)\n\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n\nlibrary(timetk)\nlibrary(rpart.plot)\n\nLoading required package: rpart\n\nAttaching package: 'rpart'\n\nThe following object is masked from 'package:dials':\n\n    prune\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#dengue-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#dengue-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Dengue data",
    "text": "Dengue data\n\nSubset and aggregate\nRio de Janeiro, RJ, aggregated by month.\n\ndengue_rj &lt;- open_dataset(\"../dengue-data/parquet_aggregated/dengue_md.parquet\") %&gt;%\n  filter(mun == 330455) %&gt;%\n  collect() %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", freq = sum(freq, na.rm = TRUE))\n\n\nplot_time_series(.data = dengue_rj, .date_var = date, .value = freq, .smooth = FALSE, .title = \"Dengue, absolute number of cases\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#weather-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#weather-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Weather data",
    "text": "Weather data\n\ntmax &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/tmax.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"Tmax_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(tmax = value)\n\nprec &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"pr_sum\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = sum(value, na.rm = TRUE)) %&gt;%\n  rename(prec = value)\n\nprec_avg &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/pr.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"pr_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(prec_avg = value)\n\nrh &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/rh.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"RH_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(rh = value)\n\nwind &lt;- open_dataset(sources = \"../weather-data/parquet/brdwgd/u2.parquet\") %&gt;%\n  filter(code_muni == 3304557) %&gt;%\n  filter(name == \"u2_mean\") %&gt;%\n  select(date, value) %&gt;%\n  collect() %&gt;%\n  filter(date &gt;= min(dengue_rj$date) & date &lt;= max(dengue_rj$date)) %&gt;%\n  summarise_by_time(.date_var = date, .by = \"month\", value = mean(value, na.rm = TRUE)) %&gt;%\n  rename(wind = value)\n\n\nplot_time_series(.data = tmax, .date_var = date, .value = tmax, .smooth = FALSE, .title = \"Max temp, average\")\n\n\n\n\n\n\nplot_time_series(.data = prec, .date_var = date, .value = prec, .smooth = FALSE, .title = \"Precipitation, sum\")\n\n\n\n\n\n\nplot_time_series(.data = prec_avg, .date_var = date, .value = prec_avg, .smooth = FALSE, .title = \"Precipitation, average\")\n\n\n\n\n\n\nplot_time_series(.data = rh, .date_var = date, .value = rh, .smooth = FALSE, .title = \"Relative humidity, average\")\n\n\n\n\n\n\nplot_time_series(.data = wind, .date_var = date, .value = wind, .smooth = FALSE, .title = \"Wind, average\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#join-data",
    "href": "dengue-model/dengue_weather_lag_reg.html#join-data",
    "title": "Dengue and weather lags, regression task",
    "section": "Join data",
    "text": "Join data\n\nres &lt;- inner_join(x = dengue_rj, y = tmax, by = \"date\") %&gt;%\n  inner_join(prec, by = \"date\") %&gt;%\n  inner_join(prec_avg, by = \"date\") %&gt;%\n  inner_join(rh, by = \"date\") %&gt;%\n  inner_join(wind, by = \"date\") %&gt;%\n  select(date, cases = freq, tmax, prec, rh, wind)"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#decision-tree",
    "href": "dengue-model/dengue_weather_lag_reg.html#decision-tree",
    "title": "Dengue and weather lags, regression task",
    "section": "Decision tree",
    "text": "Decision tree\n\nPrepare data\n\nRemove date\nLag variables: 6 months\n\n\nres_prep &lt;- res %&gt;%\n  select(-date) %&gt;%\n  tk_augment_lags(.value = c(tmax, prec, wind, rh), .lags = 1:6)\n\n\n\nParameters\n\ntree_spec &lt;- decision_tree() %&gt;%\n  set_engine(\"rpart\") %&gt;%\n  set_mode(\"regression\")"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#fit-model",
    "href": "dengue-model/dengue_weather_lag_reg.html#fit-model",
    "title": "Dengue and weather lags, regression task",
    "section": "Fit model",
    "text": "Fit model\n\nfit1 &lt;- tree_spec %&gt;%\n  fit(cases ~ ., data = res_prep)\n\n\nfit1 %&gt;% extract_fit_engine() %&gt;%\n  rpart.plot(roundint = FALSE)\n\n\n\n\n\naugment(fit1, new_data = res_prep) %&gt;%\n    mae(truth = cases, estimate = .pred)\n\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;\n1 mae     standard       1256.\n\n\n\naugment(fit1, new_data = res_prep) %&gt;%\n  select(cases, .pred) %&gt;%\n  mutate(t = row_number()) %&gt;%\n  pivot_longer(cols = c(\"cases\", \".pred\")) %&gt;%\n  ggplot(aes(x = t, y = value, color = name)) +\n  geom_line() +\n  theme_bw()\n\n\n\n\n\nfit1 %&gt;% \n  extract_fit_engine() %&gt;% \n  vip()"
  },
  {
    "objectID": "dengue-model/dengue_weather_lag_reg.html#session-info",
    "href": "dengue-model/dengue_weather_lag_reg.html#session-info",
    "title": "Dengue and weather lags, regression task",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.1.2 (2021-11-01)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.2 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0\nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] vip_0.3.2          rpart.plot_3.1.1   rpart_4.1.16       timetk_2.8.3      \n [5] arrow_12.0.1       yardstick_1.2.0    workflowsets_1.0.1 workflows_1.1.3   \n [9] tune_1.1.1         rsample_1.1.1      recipes_1.0.6      parsnip_1.1.0     \n[13] modeldata_1.1.0    infer_1.0.4        dials_1.2.0        scales_1.2.1      \n[17] broom_1.0.5        tidymodels_1.1.0   lubridate_1.9.2    forcats_1.0.0     \n[21] stringr_1.5.0      dplyr_1.1.2        purrr_1.0.1        readr_2.1.4       \n[25] tidyr_1.3.0        tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] xts_0.13.1          bit64_4.0.5         httr_1.4.6         \n [4] DiceDesign_1.9      tools_4.1.2         backports_1.4.1    \n [7] utf8_1.2.3          R6_2.5.1            lazyeval_0.2.2     \n[10] colorspace_2.1-0    nnet_7.3-17         withr_2.5.0        \n[13] gridExtra_2.3       tidyselect_1.2.0    bit_4.0.5          \n[16] compiler_4.1.2      cli_3.6.1           plotly_4.10.2      \n[19] labeling_0.4.2      digest_0.6.31       rmarkdown_2.22     \n[22] pkgconfig_2.0.3     htmltools_0.5.5     parallelly_1.36.0  \n[25] lhs_1.1.6           fastmap_1.1.1       htmlwidgets_1.6.2  \n[28] rlang_1.1.1         rstudioapi_0.14     farver_2.1.1       \n[31] generics_0.1.3      zoo_1.8-12          jsonlite_1.8.5     \n[34] crosstalk_1.2.0     magrittr_2.0.3      Matrix_1.5-4.1     \n[37] Rcpp_1.0.10         munsell_0.5.0       fansi_1.0.4        \n[40] GPfit_1.0-8         lifecycle_1.0.3     furrr_0.3.1        \n[43] stringi_1.7.12      yaml_2.3.7          MASS_7.3-55        \n[46] grid_4.1.2          parallel_4.1.2      listenv_0.9.0      \n[49] lattice_0.20-45     splines_4.1.2       hms_1.1.3          \n[52] knitr_1.43          pillar_1.9.0        future.apply_1.11.0\n[55] codetools_0.2-18    glue_1.6.2          evaluate_0.21      \n[58] data.table_1.14.8   vctrs_0.6.3         tzdb_0.4.0         \n[61] foreach_1.5.2       gtable_0.3.3        future_1.32.0      \n[64] assertthat_0.2.1    xfun_0.39           gower_1.0.1        \n[67] prodlim_2023.03.31  viridisLite_0.4.2   class_7.3-20       \n[70] survival_3.2-13     timeDate_4022.108   iterators_1.0.14   \n[73] hardhat_1.3.0       lava_1.7.2.1        timechange_0.2.0   \n[76] globals_0.16.2      ellipsis_0.3.2      ipred_0.9-14"
  },
  {
    "objectID": "dengue-data/raw_files.html#overview",
    "href": "dengue-data/raw_files.html#overview",
    "title": "Raw files",
    "section": "Overview",
    "text": "Overview\n\ndengue &lt;- open_dataset(sources = \"parquets/\")\n\n\ndengue %&gt;% glimpse()\n\nFileSystemDataset with 15 Parquet files\n19,180,457 rows x 75 columns\n$ TP_NOT       &lt;string&gt; \"Individual\", \"Individual\", \"Individual\", \"Individual\", …\n$ ID_AGRAVO    &lt;string&gt; \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", …\n$ DT_NOTIFIC   &lt;string&gt; \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ SEM_NOT      &lt;string&gt; \"200707\", \"200707\", \"200709\", \"200707\", \"200706\", \"20070…\n$ NU_ANO       &lt;string&gt; \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", …\n$ SG_UF_NOT    &lt;string&gt; \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MUNICIP   &lt;string&gt; \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_REGIONA   &lt;string&gt; \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_UNIDADE   &lt;string&gt; \"2454793\", \"2454793\", \"2436027\", \"3340392\", \"3340392\", \"…\n$ DT_SIN_PRI   &lt;string&gt; \"2007-02-09\", \"2007-02-10\", \"2007-02-21\", \"2007-01-28\", …\n$ SEM_PRI      &lt;string&gt; \"200706\", \"200706\", \"200708\", \"200705\", \"200703\", \"20070…\n$ CS_SEXO      &lt;string&gt; \"Feminino\", \"Feminino\", \"Masculino\", \"Feminino\", \"Mascul…\n$ CS_GESTANT   &lt;string&gt; \"Ignorado\", \"Ignorado\", \"Não se aplica\", \"Não se aplica\"…\n$ CS_RACA      &lt;string&gt; \"Parda\", \"Parda\", \"Branca\", \"Branca\", \"Parda\", \"Parda\", …\n$ CS_ESCOL_N   &lt;string&gt; \"5a à 8a série incompleta do EF (antigo ginásio ou 1o gr…\n$ SG_UF        &lt;string&gt; \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MN_RESI   &lt;string&gt; \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_RG_RESI   &lt;string&gt; \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_PAIS      &lt;string&gt; \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASI…\n$ NDUPLIC_N    &lt;string&gt; \"Não identificado\", \"Não identificado\", NA, NA, NA, NA, …\n$ DT_DIGITA    &lt;string&gt; NA, NA, \"2007-03-08\", \"2007-05-22\", \"2007-05-02\", \"2007-…\n$ CS_FLXRET    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ FLXRECEBI    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MIGRADO_W    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INVEST    &lt;string&gt; \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ ID_OCUPA_N   &lt;string&gt; \"Nao informada\", \"Nao informada\", NA, \"Nao informada\", \"…\n$ DT_SORO      &lt;string&gt; NA, NA, \"2007-02-26\", \"2007-02-01\", \"2007-02-09\", NA, NA…\n$ RESUL_SORO   &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não reagente\", \"Reage…\n$ HISTOPA_N    &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_VIRAL     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, \"2007-02-14\", NA, NA, NA…\n$ RESUL_VI_N   &lt;string&gt; \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ SOROTIPO     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, \"DEN 3\", NA, NA, NA, NA,…\n$ IMUNOH_N     &lt;string&gt; \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_PCR       &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ RESUL_PCR_   &lt;string&gt; \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ CLASSI_FIN   &lt;string&gt; \"Dengue clássico\", \"Dengue clássico\", \"Descartado\", \"Den…\n$ CRITERIO     &lt;string&gt; \"Clínico epidemiológico\", \"Clínico epidemiológico\", \"Clí…\n$ TPAUTOCTO    &lt;string&gt; \"Sim\", \"Sim\", NA, \"Não\", \"Sim\", NA, NA, \"Não\", \"Sim\", NA…\n$ COUFINF      &lt;string&gt; \"Maranhão\", \"Maranhão\", NA, \"Bahia\", \"Bahia\", NA, NA, \"B…\n$ COPAISINF    &lt;string&gt; \"BRASIL\", \"BRASIL\", NA, \"BRASIL\", \"BRASIL\", NA, NA, \"BRA…\n$ COMUNINF     &lt;string&gt; \"210780\", \"210780\", NA, \"292150\", \"292150\", NA, NA, \"292…\n$ DOENCA_TRA   &lt;string&gt; \"Não\", \"Não\", NA, \"Não\", \"Não\", NA, NA, \"Não\", \"Não\", NA…\n$ EVOLUCAO     &lt;string&gt; \"Cura\", \"Cura\", NA, \"Cura\", \"Cura\", NA, NA, \"Cura\", \"Cur…\n$ DT_OBITO     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_ENCERRA   &lt;string&gt; \"2007-05-08\", \"2007-05-08\", \"2007-04-19\", \"2007-05-28\", …\n$ MANI_HEMOR   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EPISTAXE     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ GENGIVO      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ METRO        &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PETEQUIAS    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HEMATURA     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ SANGRAM      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ LACO_N       &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLASMATICO   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EVIDENCIA    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLAQ_MENOR   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ CON_FHD      &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ COMPLICA     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HOSPITALIZ   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INTERNA   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ UF           &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MUNICIPIO    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEminutos &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEhoras   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEdias    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEmeses   &lt;string&gt; NA, NA, NA, \"0\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ IDADEanos    &lt;string&gt; \"3\", \"1\", \"3\", NA, \"0\", \"1\", \"3\", \"0\", \"3\", \"0\", \"1\", \"2…\n$ munResStatus &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResTipo   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResNome   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResUf     &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLat    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLon    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResAlt    &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResArea   &lt;string&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\nCall `print()` for full schema details"
  },
  {
    "objectID": "dengue-data/raw_files.html#session-info",
    "href": "dengue-data/raw_files.html#session-info",
    "title": "Raw files",
    "section": "Session info",
    "text": "Session info\n\nsessionInfo()\n\nR version 4.2.0 (2022-04-22)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS 13.4\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] arrow_12.0.1       microdatasus_2.1.2 lubridate_1.9.2    forcats_1.0.0     \n [5] stringr_1.5.0      dplyr_1.1.2        purrr_1.0.1        readr_2.1.4       \n [9] tidyr_1.3.0        tibble_3.2.1       ggplot2_3.4.2      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] compiler_4.2.0    pillar_1.9.0      tools_4.2.0       bit_4.0.5        \n [5] digest_0.6.31     timechange_0.2.0  jsonlite_1.8.5    evaluate_0.21    \n [9] lifecycle_1.0.3   gtable_0.3.3      pkgconfig_2.0.3   rlang_1.1.1      \n[13] cli_3.6.1         rstudioapi_0.14   yaml_2.3.7        xfun_0.39        \n[17] fastmap_1.1.1     withr_2.5.0       knitr_1.43        generics_0.1.3   \n[21] vctrs_0.6.3       htmlwidgets_1.6.2 hms_1.1.3         bit64_4.0.5      \n[25] grid_4.2.0        tidyselect_1.2.0  glue_1.6.2        R6_2.5.1         \n[29] fansi_1.0.4       rmarkdown_2.22    tzdb_0.4.0        magrittr_2.0.3   \n[33] scales_1.2.1      htmltools_0.5.5   assertthat_0.2.1  colorspace_2.1-0 \n[37] utf8_1.2.3        stringi_1.7.12    munsell_0.5.0"
  }
]