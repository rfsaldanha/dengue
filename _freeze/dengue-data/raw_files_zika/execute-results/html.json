{
  "hash": "0ddb1b7cf09f178e9a540c864944e54a",
  "result": {
    "markdown": "---\ntitle: \"Raw files, chikungunya\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook presents the process of downloading SINAN Dengue raw data files from DataSUS, pre-processing steps using the `{microdatasus}` package and exporting the raw files to `parquet` files.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n# remotes::install_github(\"rfsaldanha/microdatasus\")\nlibrary(microdatasus)\nlibrary(arrow)\nsource(\"../functions.R\")\n```\n:::\n\n\n### Execution node\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnode_name()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rfsaldanha\"\n```\n:::\n:::\n\n\n## Data download\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# for(a in 2016:2021){\n#   tmp <- fetch_datasus(\n#     year_start = a, year_end = a,\n#     information_system = \"SINAN-ZIKA\"\n#   )\n# \n#   write_parquet(x = tmp, sink = paste0(data_dir(\"zika_data/parquets_raw/raw_zika_\"),a, \".parquet\"))\n# \n#   tmp <- process_sinan_zika(data = tmp)\n# \n#   write_parquet(x = tmp, sink = paste0(data_dir(\"zika_data/parquets/zika_\"), a, \".parquet\"))\n# \n#   rm(tmp)\n# }\n```\n:::\n\n\n::: callout-warning\nThis code chunk is commented to avoid unnecessary download again the raw DBC files from DataSUS.\n:::\n\n## Overview\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndengue <- open_dataset(sources = data_dir(\"dengue_data/parquets\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndengue %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nFileSystemDataset with 15 Parquet files\n19,180,457 rows x 75 columns\n$ TP_NOT       <string> \"Individual\", \"Individual\", \"Individual\", \"Individual\", …\n$ ID_AGRAVO    <string> \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", \"A90\", …\n$ DT_NOTIFIC   <string> \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ SEM_NOT      <string> \"200707\", \"200707\", \"200709\", \"200707\", \"200706\", \"20070…\n$ NU_ANO       <string> \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", \"2007\", …\n$ SG_UF_NOT    <string> \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MUNICIP   <string> \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_REGIONA   <string> \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_UNIDADE   <string> \"2454793\", \"2454793\", \"2436027\", \"3340392\", \"3340392\", \"…\n$ DT_SIN_PRI   <string> \"2007-02-09\", \"2007-02-10\", \"2007-02-21\", \"2007-01-28\", …\n$ SEM_PRI      <string> \"200706\", \"200706\", \"200708\", \"200705\", \"200703\", \"20070…\n$ CS_SEXO      <string> \"Feminino\", \"Feminino\", \"Masculino\", \"Feminino\", \"Mascul…\n$ CS_GESTANT   <string> \"Ignorado\", \"Ignorado\", \"Não se aplica\", \"Não se aplica\"…\n$ CS_RACA      <string> \"Parda\", \"Parda\", \"Branca\", \"Branca\", \"Parda\", \"Parda\", …\n$ CS_ESCOL_N   <string> \"5a à 8a série incompleta do EF (antigo ginásio ou 1o gr…\n$ SG_UF        <string> \"Maranhão\", \"Maranhão\", \"Pernambuco\", \"Bahia\", \"Bahia\", …\n$ ID_MN_RESI   <string> \"210780\", \"210780\", \"260640\", \"292150\", \"292150\", \"29215…\n$ ID_RG_RESI   <string> \"1577\", \"1577\", \"1499\", \"1410\", \"1410\", \"1410\", \"1410\", …\n$ ID_PAIS      <string> \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASIL\", \"BRASI…\n$ NDUPLIC_N    <string> \"Não identificado\", \"Não identificado\", NA, NA, NA, NA, …\n$ DT_DIGITA    <string> NA, NA, \"2007-03-08\", \"2007-05-22\", \"2007-05-02\", \"2007-…\n$ CS_FLXRET    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ FLXRECEBI    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MIGRADO_W    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INVEST    <string> \"2007-02-12\", \"2007-02-12\", \"2007-02-26\", \"2007-02-12\", …\n$ ID_OCUPA_N   <string> \"Nao informada\", \"Nao informada\", NA, \"Nao informada\", \"…\n$ DT_SORO      <string> NA, NA, \"2007-02-26\", \"2007-02-01\", \"2007-02-09\", NA, NA…\n$ RESUL_SORO   <string> \"Não realizado\", \"Não realizado\", \"Não reagente\", \"Reage…\n$ HISTOPA_N    <string> \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_VIRAL     <string> NA, NA, NA, NA, NA, NA, NA, NA, \"2007-02-14\", NA, NA, NA…\n$ RESUL_VI_N   <string> \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ SOROTIPO     <string> NA, NA, NA, NA, NA, NA, NA, NA, \"DEN 3\", NA, NA, NA, NA,…\n$ IMUNOH_N     <string> \"Não realizado\", \"Não realizado\", \"Não realizado\", \"Não …\n$ DT_PCR       <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ RESUL_PCR_   <string> \"Não realizado\", \"Não realizado\", NA, \"Não realizado\", \"…\n$ CLASSI_FIN   <string> \"Dengue clássico\", \"Dengue clássico\", \"Descartado\", \"Den…\n$ CRITERIO     <string> \"Clínico epidemiológico\", \"Clínico epidemiológico\", \"Clí…\n$ TPAUTOCTO    <string> \"Sim\", \"Sim\", NA, \"Não\", \"Sim\", NA, NA, \"Não\", \"Sim\", NA…\n$ COUFINF      <string> \"Maranhão\", \"Maranhão\", NA, \"Bahia\", \"Bahia\", NA, NA, \"B…\n$ COPAISINF    <string> \"BRASIL\", \"BRASIL\", NA, \"BRASIL\", \"BRASIL\", NA, NA, \"BRA…\n$ COMUNINF     <string> \"210780\", \"210780\", NA, \"292150\", \"292150\", NA, NA, \"292…\n$ DOENCA_TRA   <string> \"Não\", \"Não\", NA, \"Não\", \"Não\", NA, NA, \"Não\", \"Não\", NA…\n$ EVOLUCAO     <string> \"Cura\", \"Cura\", NA, \"Cura\", \"Cura\", NA, NA, \"Cura\", \"Cur…\n$ DT_OBITO     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_ENCERRA   <string> \"2007-05-08\", \"2007-05-08\", \"2007-04-19\", \"2007-05-28\", …\n$ MANI_HEMOR   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EPISTAXE     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ GENGIVO      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ METRO        <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PETEQUIAS    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HEMATURA     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ SANGRAM      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ LACO_N       <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLASMATICO   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ EVIDENCIA    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ PLAQ_MENOR   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ CON_FHD      <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ COMPLICA     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ HOSPITALIZ   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ DT_INTERNA   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ UF           <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ MUNICIPIO    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEminutos <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEhoras   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEdias    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ IDADEmeses   <string> NA, NA, NA, \"0\", NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ IDADEanos    <string> \"3\", \"1\", \"3\", NA, \"0\", \"1\", \"3\", \"0\", \"3\", \"0\", \"1\", \"2…\n$ munResStatus <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResTipo   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResNome   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResUf     <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLat    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResLon    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResAlt    <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\n$ munResArea   <string> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …\nCall `print()` for full schema details\n```\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] arrow_14.0.0.2     microdatasus_2.2.4 lubridate_1.9.3    forcats_1.0.0     \n [5] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        readr_2.1.5       \n [9] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.4.4      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] bit_4.0.5         gtable_0.3.4      jsonlite_1.8.8    compiler_4.3.2   \n [5] tidyselect_1.2.0  assertthat_0.2.1  scales_1.3.0      yaml_2.3.8       \n [9] fastmap_1.1.1     R6_2.5.1          generics_0.1.3    knitr_1.45       \n[13] htmlwidgets_1.6.4 munsell_0.5.0     pillar_1.9.0      tzdb_0.4.0       \n[17] rlang_1.1.3       utf8_1.2.4        stringi_1.8.3     xfun_0.41        \n[21] bit64_4.0.5       timechange_0.3.0  cli_3.6.2         withr_3.0.0      \n[25] magrittr_2.0.3    digest_0.6.34     grid_4.3.2        rstudioapi_0.15.0\n[29] hms_1.1.3         lifecycle_1.0.4   vctrs_0.6.5       data.table_1.15.0\n[33] evaluate_0.23     glue_1.7.0        fansi_1.0.6       colorspace_2.1-0 \n[37] rmarkdown_2.25    tools_4.3.2       pkgconfig_2.0.3   htmltools_0.5.7  \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}