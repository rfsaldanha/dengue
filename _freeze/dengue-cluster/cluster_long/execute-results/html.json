{
  "hash": "781a9344d3c60e1a6dafaa7a5afa31b5",
  "result": {
    "markdown": "---\ntitle: \"Raw cases\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering dengue raw cases time-series similarities.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nLoad the bundled data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n    select(mun, date, cases = cases_raw) %>%\n    collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 340179      3\n```\n:::\n:::\n\n\n### Prepare data\n\nThe chunk bellow formats the dataset for `tsclust` use.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- tdengue %>%\n  # Prepare time series\n  arrange(mun) %>%\n  pivot_wider(names_from = mun, values_from = cases) %>%\n  select(-date) %>%\n  t() %>%\n  # Convert object\n  tslist()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 679\n```\n:::\n:::\n\n\n## Clustering\n\nSequence of `k` groups to be used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nk_seq <- 2:10\n```\n:::\n\n\n### DTW (basic)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_dtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"dtw_basic\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n46.292 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_dtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_dtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.563306808</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">243.13362</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.777906</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.777906</td>\n<td headers=\"D\" class=\"gt_row gt_right\">4.033050e-03</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.81493978</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.500486555</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">179.80850</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.589921</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">8.236031</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.463657e-03</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06040454</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.234604708</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">102.69761</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.868848</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">23.661427</td>\n<td headers=\"D\" class=\"gt_row gt_right\">7.946198e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.05528690</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.221410311</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">122.82411</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.535349</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">24.240538</td>\n<td headers=\"D\" class=\"gt_row gt_right\">7.813649e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.07362652</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.047380416</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">71.53960</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.385318</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">105.686817</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.503914e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06330307</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.018931701</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">66.01800</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.523758</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">87.921436</td>\n<td headers=\"D\" class=\"gt_row gt_right\">2.131907e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06658659</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">-0.005982317</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">52.35818</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.393992</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">207.433508</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.469383e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.03558253</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">-0.011726942</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">64.19814</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.436507</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">244.767080</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.527283e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.02848551</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">-0.101115607</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">73.21168</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.166345</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">409.352091</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.633515e-05</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06955750</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_dtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n187 492 \n```\n:::\n:::\n\n\n### Soft-DTW\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sdtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sdtw\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n231.662 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sdtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sdtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.9747238</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">610.6681</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">0.7127038</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">7.127038e-01</td>\n<td headers=\"D\" class=\"gt_row gt_right\">6.394018e-03</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.021962268</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.8785473</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">339.7721</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.3846248</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.184955e+01</td>\n<td headers=\"D\" class=\"gt_row gt_right\">6.047589e-05</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.012882348</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.7831408</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">367.3748</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.0620911</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">8.628989e+01</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.151199e-05</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006517102</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.5616851</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">287.9459</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.6410825</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">6.279292e+02</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.508382e-06</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006502140</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4127518</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">232.3673</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.8248896</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.900511e+03</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.029877e-06</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006496556</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3492449</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">161.4531</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.1597151</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">6.103722e+03</td>\n<td headers=\"D\" class=\"gt_row gt_right\">5.179334e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006423601</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3130712</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">165.0773</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.5475305</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">5.893653e+03</td>\n<td headers=\"D\" class=\"gt_row gt_right\">6.826592e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006458184</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1779085</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">192.9691</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.0300445</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.657527e+04</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.456487e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006500423</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1726132</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">130.6724</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.9249465</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.215560e+05</td>\n<td headers=\"D\" class=\"gt_row gt_right\">7.778736e-08</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.006444721</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sdtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n 11 668 \n```\n:::\n:::\n\n\n### SBD\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sbd <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.945 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sbd) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sbd, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.19232458</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.43352764</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">105.89969</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.495106</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.495106</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.04758953</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3749125</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.16139544</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.14186007</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">42.69029</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.539215</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.955084</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.05571189</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3521767</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.13008017</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.20138965</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">70.46372</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.731617</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.777455</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.05647432</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3400697</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.09211874</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.04440823</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">49.64036</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.799473</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.241962</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.05073587</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3159727</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.08978010</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.31394588</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">37.06136</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">6.461761</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">7.845973</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.02136961</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3667538</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.05631414</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.06024602</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">55.09867</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.170914</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.178624</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.01656789</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3179895</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.04322383</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.28795370</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">96.18451</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.350614</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.857858</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.01715419</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3501107</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.03766029</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.08963975</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">48.19501</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.360877</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.869244</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.01731394</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3257173</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.03553741</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.11301210</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">70.16402</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.846658</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.211674</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.02132175</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3251809</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sbd[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n511 168 \n```\n:::\n:::\n\n\n### GAK\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_gak <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"gak\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n271.303 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_gak) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_gak, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hsjzvcykoa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hsjzvcykoa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hsjzvcykoa thead, #hsjzvcykoa tbody, #hsjzvcykoa tfoot, #hsjzvcykoa tr, #hsjzvcykoa td, #hsjzvcykoa th {\n  border-style: none;\n}\n\n#hsjzvcykoa p {\n  margin: 0;\n  padding: 0;\n}\n\n#hsjzvcykoa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hsjzvcykoa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hsjzvcykoa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hsjzvcykoa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hsjzvcykoa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hsjzvcykoa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hsjzvcykoa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hsjzvcykoa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hsjzvcykoa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hsjzvcykoa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hsjzvcykoa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_left {\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_center {\n  text-align: center;\n}\n\n#hsjzvcykoa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hsjzvcykoa .gt_font_normal {\n  font-weight: normal;\n}\n\n#hsjzvcykoa .gt_font_bold {\n  font-weight: bold;\n}\n\n#hsjzvcykoa .gt_font_italic {\n  font-style: italic;\n}\n\n#hsjzvcykoa .gt_super {\n  font-size: 65%;\n}\n\n#hsjzvcykoa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hsjzvcykoa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hsjzvcykoa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hsjzvcykoa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hsjzvcykoa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hsjzvcykoa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hsjzvcykoa .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.91204464</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6121344</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">70.160389</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">11.397435</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">11.39743</td>\n<td headers=\"D\" class=\"gt_row gt_right\">1.070841e-03</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.024308301</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.89063056</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6025345</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">35.827115</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">12.214961</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">21.33743</td>\n<td headers=\"D\" class=\"gt_row gt_right\">8.882340e-04</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.017392584</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.56673089</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5761049</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">9.540570</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">36.984617</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">772.68089</td>\n<td headers=\"D\" class=\"gt_row gt_right\">2.073418e-05</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.009652511</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.51422407</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6090642</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">37.881634</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">9.134131</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">109.09898</td>\n<td headers=\"D\" class=\"gt_row gt_right\">2.369289e-05</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.023596187</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.34615432</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5804793</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">10.401018</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">24.242925</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">872.28716</td>\n<td headers=\"D\" class=\"gt_row gt_right\">2.770548e-06</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.012348716</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.32153320</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5967512</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">18.167789</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">15.597700</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">963.89750</td>\n<td headers=\"D\" class=\"gt_row gt_right\">2.566534e-06</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.017167921</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.30902233</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5821542</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">9.743672</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">20.658947</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">759.39685</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.587207e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.011523184</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.19782535</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5908109</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">11.123215</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">20.521645</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2053.75182</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.399318e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.019667996</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.09332721</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5976834</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">24.094674</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">9.259298</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1869.00352</td>\n<td headers=\"D\" class=\"gt_row gt_right\">3.435826e-07</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.016792580</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_gak[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n 32 647 \n```\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.9.0     arrow_13.0.0.1   lubridate_1.9.3 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.3      purrr_1.0.2     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.4   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rlang_1.1.2         magrittr_2.0.3      clue_0.3-65        \n  [4] furrr_0.3.1         flexclust_1.4-1     compiler_4.3.2     \n  [7] systemfonts_1.0.5   vctrs_0.6.4         reshape2_1.4.4     \n [10] rvest_1.0.3         lhs_1.1.6           tune_1.1.2         \n [13] pkgconfig_2.0.3     fastmap_1.1.1       ellipsis_0.3.2     \n [16] labeling_0.4.3      utf8_1.2.4          promises_1.2.1     \n [19] rmarkdown_2.25      prodlim_2023.08.28  tzdb_0.4.0         \n [22] bit_4.0.5           xfun_0.41           modeltools_0.2-23  \n [25] jsonlite_1.8.7      recipes_1.0.8       later_1.3.1        \n [28] parallel_4.3.2      cluster_2.1.4       R6_2.5.1           \n [31] stringi_1.7.12      rsample_1.2.0       parallelly_1.36.0  \n [34] rpart_4.1.21        Rcpp_1.0.11         assertthat_0.2.1   \n [37] dials_1.2.0         iterators_1.0.14    knitr_1.45         \n [40] future.apply_1.11.0 zoo_1.8-12          httpuv_1.6.12      \n [43] Matrix_1.6-1.1      splines_4.3.2       nnet_7.3-19        \n [46] timechange_0.2.0    tidyselect_1.2.0    rstudioapi_0.15.0  \n [49] yaml_2.3.7          timeDate_4022.108   codetools_0.2-19   \n [52] listenv_0.9.0       lattice_0.22-5      plyr_1.8.9         \n [55] shiny_1.7.5.1       withr_2.5.2         evaluate_0.23      \n [58] future_1.33.0       survival_3.5-7      RcppParallel_5.1.7 \n [61] xml2_1.3.5          xts_0.13.1          pillar_1.9.0       \n [64] foreach_1.5.2       stats4_4.3.2        shinyjs_2.1.0      \n [67] generics_0.1.3      hms_1.1.3           munsell_0.5.0      \n [70] scales_1.2.1        xtable_1.8-4        globals_0.16.2     \n [73] class_7.3-22        glue_1.6.2          tools_4.3.2        \n [76] data.table_1.14.8   RSpectra_0.16-1     webshot_0.5.5      \n [79] gower_1.0.1         grid_4.3.2          yardstick_1.2.0    \n [82] ipred_0.9-14        colorspace_2.1-0    cli_3.6.1          \n [85] DiceDesign_1.9      workflows_1.1.3     parsnip_1.1.1      \n [88] fansi_1.0.5         viridisLite_0.4.2   gt_0.10.0          \n [91] svglite_2.1.2       lava_1.7.3          gtable_0.3.4       \n [94] GPfit_1.0-8         sass_0.4.7          digest_0.6.33      \n [97] ggrepel_0.9.4       farver_2.1.1        htmlwidgets_1.6.2  \n[100] htmltools_0.5.7     lifecycle_1.0.4     httr_1.4.7         \n[103] hardhat_1.3.0       mime_0.12           bit64_4.0.5        \n[106] MASS_7.3-60        \n```\n:::\n:::\n",
    "supporting": [
      "cluster_long_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}