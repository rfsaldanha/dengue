{
  "hash": "7a573d134ed99171082cc5e0418c9fc9",
  "result": {
    "markdown": "---\ntitle: \"Scaled cases\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering scaled (standardized) dengue cases time-series similarities.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nLoad the aggregated data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n    select(mun, date, cases) %>%\n    collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 340179      3\n```\n:::\n:::\n\n\n### Prepare data\n\nThe chunk bellow executes various steps to prepare the data for clustering.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- tdengue %>%\n  # Prepare time series\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun, date) %>%\n  pivot_wider(names_from = mun, values_from = cases) %>%\n  select(-date) %>%\n  t() %>%\n  tslist()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 679\n```\n:::\n:::\n\n\n## Clustering\n\nSequence of `k` groups to be used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nk_seq <- 2:10\n```\n:::\n\n\n### DTW (basic)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_dtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"dtw_basic\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n44.727 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_dtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_dtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.22470565</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">471.19772</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.169633</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.169633</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.09802846</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.4465088</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.16590632</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">129.12898</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.492001</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.779535</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.08842332</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3564468</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.12371981</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">166.97238</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.873249</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.231609</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.08368662</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3581035</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.12269031</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">282.64604</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.352913</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.754531</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.08676909</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.4086315</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.11888356</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">193.62938</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.898608</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.232433</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.08471016</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3694141</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.10437071</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">82.16793</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.872270</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.348246</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.10197290</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3198181</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.07891310</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">105.14468</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.366061</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.737811</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.10021368</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3467224</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.05778652</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">87.10300</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.950026</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.716834</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.10021368</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3233407</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.05494472</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">100.42993</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.902694</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.559555</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.07642521</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3449551</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_dtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n292 387 \n```\n:::\n:::\n\n\n### Soft-DTW\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sdtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sdtw\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n204.708 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sdtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sdtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.54420550</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">424.7128</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.784989</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.784989</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0188267923</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2699432</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.23058175</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">150.9456</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.252811</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.660076</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0056554246</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1492226</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.20100983</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">179.4794</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.019992</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.279759</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0062697286</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1565015</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.16735749</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">197.7269</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.204787</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">5.000366</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0014544262</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1900948</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.16612027</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">203.6722</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.148653</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.660288</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0095083455</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2259238</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.14175838</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">106.8324</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.978932</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.094434</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0079666165</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1331531</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.13487754</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">136.8319</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.860672</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.131776</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.0017931128</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1454316</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.11776105</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">106.7446</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.427594</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.376014</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.0082114090</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1384285</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.07201448</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">121.5954</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.392449</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">5.993679</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.0005698678</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1471381</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sdtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n581  98 \n```\n:::\n:::\n\n\n### SBD\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sbd <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.792 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sbd) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sbd, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.19153388</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.41954595</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">92.48199</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.965541</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.965541</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.05215726</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3986087</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.17383693</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.15654880</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">45.49664</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.416220</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.694440</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.09627307</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3700479</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.15090087</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.16086274</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">51.05856</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.100628</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.794277</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.08129365</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3596084</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.09507187</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.03507591</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">37.49864</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.666277</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.750657</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.05350097</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3320909</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.07435107</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.07700081</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">29.71794</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.390497</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">6.258006</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.04658001</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3447000</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.05379396</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.05994618</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">39.01541</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.867380</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">5.360924</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.03345584</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3376868</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.03260668</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.10548796</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">48.66182</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">4.096509</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">5.928294</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.02534005</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3453233</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.02929865</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.29847866</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">58.62624</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">5.033205</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">6.498922</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.02115696</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3885022</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.02545150</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.23112470</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">50.67983</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">5.198919</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">6.670280</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.02116725</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3814808</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sbd[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n503 176 \n```\n:::\n:::\n\n\n### GAK\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_gak <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"gak\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n260.459 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_gak) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_gak, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hsjzvcykoa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hsjzvcykoa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hsjzvcykoa thead, #hsjzvcykoa tbody, #hsjzvcykoa tfoot, #hsjzvcykoa tr, #hsjzvcykoa td, #hsjzvcykoa th {\n  border-style: none;\n}\n\n#hsjzvcykoa p {\n  margin: 0;\n  padding: 0;\n}\n\n#hsjzvcykoa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hsjzvcykoa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hsjzvcykoa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hsjzvcykoa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hsjzvcykoa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hsjzvcykoa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hsjzvcykoa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hsjzvcykoa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hsjzvcykoa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hsjzvcykoa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hsjzvcykoa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_left {\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_center {\n  text-align: center;\n}\n\n#hsjzvcykoa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hsjzvcykoa .gt_font_normal {\n  font-weight: normal;\n}\n\n#hsjzvcykoa .gt_font_bold {\n  font-weight: bold;\n}\n\n#hsjzvcykoa .gt_font_italic {\n  font-style: italic;\n}\n\n#hsjzvcykoa .gt_super {\n  font-size: 65%;\n}\n\n#hsjzvcykoa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hsjzvcykoa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hsjzvcykoa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hsjzvcykoa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hsjzvcykoa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hsjzvcykoa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hsjzvcykoa .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2830846</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6304283</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">124.45464</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.229032</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.350710</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.009648476</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2459049</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2591976</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6297937</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">102.39058</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.243505</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.344258</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.007771500</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2020673</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2559452</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6301835</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">105.07795</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.610798</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.716722</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.009410867</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2473205</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2550581</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6295251</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">95.02169</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.043610</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.248546</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.008625614</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.1991254</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2253127</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6305288</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">110.82437</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.737232</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.904585</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.008938342</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3000306</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1974647</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6309581</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">98.32655</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.945344</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.077690</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.006170275</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3651774</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1823244</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6298506</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">74.98460</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.864885</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.987567</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.010215175</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.2561144</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1584990</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6314929</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">203.86335</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.899706</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.899706</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.020554844</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.5280049</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1423961</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6306801</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">101.83124</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.970774</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.082930</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.005129007</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.3477263</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_gak[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_scaled_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5   6 \n 73 104  64  91 144 203 \n```\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.9.0     arrow_13.0.0.1   lubridate_1.9.3 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.3      purrr_1.0.2     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.4   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rlang_1.1.2         magrittr_2.0.3      clue_0.3-65        \n  [4] furrr_0.3.1         flexclust_1.4-1     compiler_4.3.2     \n  [7] systemfonts_1.0.5   vctrs_0.6.4         reshape2_1.4.4     \n [10] rvest_1.0.3         lhs_1.1.6           tune_1.1.2         \n [13] pkgconfig_2.0.3     fastmap_1.1.1       ellipsis_0.3.2     \n [16] labeling_0.4.3      utf8_1.2.4          promises_1.2.1     \n [19] rmarkdown_2.25      prodlim_2023.08.28  tzdb_0.4.0         \n [22] bit_4.0.5           xfun_0.41           modeltools_0.2-23  \n [25] jsonlite_1.8.7      recipes_1.0.8       later_1.3.1        \n [28] parallel_4.3.2      cluster_2.1.4       R6_2.5.1           \n [31] stringi_1.7.12      rsample_1.2.0       parallelly_1.36.0  \n [34] rpart_4.1.21        Rcpp_1.0.11         assertthat_0.2.1   \n [37] dials_1.2.0         iterators_1.0.14    knitr_1.45         \n [40] future.apply_1.11.0 zoo_1.8-12          httpuv_1.6.12      \n [43] Matrix_1.6-1.1      splines_4.3.2       nnet_7.3-19        \n [46] timechange_0.2.0    tidyselect_1.2.0    rstudioapi_0.15.0  \n [49] yaml_2.3.7          timeDate_4022.108   codetools_0.2-19   \n [52] listenv_0.9.0       lattice_0.22-5      plyr_1.8.9         \n [55] shiny_1.7.5.1       withr_2.5.2         evaluate_0.23      \n [58] future_1.33.0       survival_3.5-7      RcppParallel_5.1.7 \n [61] xml2_1.3.5          xts_0.13.1          pillar_1.9.0       \n [64] foreach_1.5.2       stats4_4.3.2        shinyjs_2.1.0      \n [67] generics_0.1.3      hms_1.1.3           munsell_0.5.0      \n [70] scales_1.2.1        xtable_1.8-4        globals_0.16.2     \n [73] class_7.3-22        glue_1.6.2          tools_4.3.2        \n [76] data.table_1.14.8   RSpectra_0.16-1     webshot_0.5.5      \n [79] gower_1.0.1         grid_4.3.2          yardstick_1.2.0    \n [82] ipred_0.9-14        colorspace_2.1-0    cli_3.6.1          \n [85] DiceDesign_1.9      workflows_1.1.3     parsnip_1.1.1      \n [88] fansi_1.0.5         viridisLite_0.4.2   gt_0.10.0          \n [91] svglite_2.1.2       lava_1.7.3          gtable_0.3.4       \n [94] GPfit_1.0-8         sass_0.4.7          digest_0.6.33      \n [97] ggrepel_0.9.4       farver_2.1.1        htmlwidgets_1.6.2  \n[100] htmltools_0.5.7     lifecycle_1.0.4     httr_1.4.7         \n[103] hardhat_1.3.0       mime_0.12           bit64_4.0.5        \n[106] MASS_7.3-60        \n```\n:::\n:::\n",
    "supporting": [
      "cluster_long_scaled_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}