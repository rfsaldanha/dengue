{
  "hash": "074ee663a4245bd3db55320b34472809",
  "result": {
    "markdown": "---\ntitle: \"Time series features\"\nsubtitle: \"with scaled cases\"\nauthor: \"Raphael Saldanha\"\ndate: last-modified\nbibliography: references.bib\n---\n\n\nThis notebook aims to explore time series features of dengue cases that may guide the clustering procedures. Time series features descriptions are quoted from @tsfeatures .\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(arrow)\nlibrary(tsfeatures)\nlibrary(broom)\nlibrary(DT)\nsource(\"../functions.R\")\n```\n:::\n\n\n### Functions\n\nPerform Kolmogorov-Smirnorf tests between groups statistics.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nks_group_test <- function(stat){\n  \n  tsf_group_split <- tsf_group %>%\n    # Select variables and statistic\n    select(group, statistic = !!stat) %>%\n    # Split to list  \n    group_split(group) \n\n  # Matrix of possible combinations\n  comb <- combn(x = unique(tsf_group$group), m = 2)\n\n  # Resuls data frame\n  ks_results <- tibble()\n  \n  \n  # For each group combination, perform ks.test\n  for(i in 1:ncol(comb)){\n    g_a <- comb[1,i]\n    g_b <- comb[2,i]\n    \n    res <- ks.test(\n      x = tsf_group_split[[g_a]]$statistic, \n      y =  tsf_group_split[[g_b]]$statistic\n    ) %>% tidy()\n    \n    tmp <- tibble(\n      g_a = g_a,\n      g_b = g_b,\n      statistic = round(res$statistic, 4),\n      pvalue = round(res$p.value, 4)\n    )\n    \n    ks_results <- bind_rows(ks_results, tmp)\n  }\n  \n  ks_results %>%\n    arrange(g_a, g_b)\n}\n```\n:::\n\n\n## Load data\n\nLoad the bundled data (679 municipalities, pop $\\geq$ 50k inhab.) with standardized cases and keep only the municipality code, date and cases variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n    select(mun, date, cases) %>%\n    collect()\n```\n:::\n\n\n## Prepare data\n\nConvert panel data to a list of `ts` objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue_df <- tdengue %>%\n  arrange(mun, date) %>%\n  select(-date) %>%\n  nest(data = cases, .by = mun)\n\ntdengue_list <- lapply(tdengue_df$data, ts)\n```\n:::\n\n\n## Time series features\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsf <- tsfeatures(\n  tslist = tdengue_list, \n  features = c(\"entropy\", \"stability\",\n               \"lumpiness\", \"flat_spots\",\n               \"zero_proportion\", \"stl_features\",\n               \"acf_features\")\n)\n  \ntsf$mun <- tdengue_df$mun\n```\n:::\n\n\nAll features available at the `tsfeatures` package were computed. Bellow, details about some of them.\n\n### Shannon entropy\n\n> Measures the \"forecastability\" of a time series, where low values indicate a high signal-to-noise ratio, and large values occur when a series is difficult to forecast.\n\n$$\n-\\int^\\pi_{-\\pi}\\hat{f}(\\lambda)\\log\\hat{f}(\\lambda) d\\lambda\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = entropy)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Stability & lumpiness\n\n> Stability and lumpiness are two time series features based on tiled (non-overlapping) windows. Means or variances are produced for all tiled windows. Then stability is the variance of the means, while lumpiness is the variance of the variances.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = stability)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = lumpiness)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Flat spots\n\n> Flat spots are computed by dividing the sample space of a time series into ten equal-sized intervals, and computing the maximum run length within any single interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = flat_spots)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### STL features decomposition\n\n#### Trend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = trend)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n#### Spike\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = spike)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n#### Linearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = linearity)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#### Curvature\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = curvature)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n#### First autocorrelation coefficient\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = e_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#### Sum of the first ten squared autocorrelation coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = e_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### Autocorrelation function (ACF) features\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = x_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = x_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff1_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff1_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff2_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff2_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n## Clustering\n\nThis procedure goal is to cluster the municipalities considering time series features similarities.\n\n### K-means clustering\n\nCluster the municipalities based solely on the time series features.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npoints <- tsf %>%\n  select(-mun)\n```\n:::\n\n\nUses $k$ from 2 to 10 for clustering.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkclusts <- \n  tibble(k = 2:10) %>%\n  mutate(\n    kclust = map(k, ~kmeans(points, .x)),\n    tidied = map(kclust, tidy),\n    glanced = map(kclust, glance),\n    augmented = map(kclust, augment, points)\n  )\n```\n:::\n\n\nIsolate results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclusters <- \n  kclusts %>%\n  unnest(cols = c(tidied))\n\nassignments <- \n  kclusts %>% \n  unnest(cols = c(augmented))\n\nclusterings <- \n  kclusts %>%\n  unnest(cols = c(glanced))\n```\n:::\n\n\nThe total sum of squares is plotted. The \\$k=5\\$ seems to be a break point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(clusterings, aes(k, tot.withinss)) +\n  geom_line() +\n  geom_point() +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n### Identify municipalities and cluster id\n\nFinally, the cluster partition ID is added to the main dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_ids <- clusterings %>%\n  filter(k == 5) %>%\n  pull(augmented) %>%\n  pluck(1) %>%\n  select(group = .cluster) %>%\n  mutate(mun = tdengue_df$mun)\n```\n:::\n\n\n### Cluster sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(cluster_ids$group)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5 \n 40  88 131 199 221 \n```\n:::\n:::\n\n\n### Cluster time series plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninner_join(tdengue, cluster_ids, by = \"mun\") %>%\n  ggplot(aes(x = date, y = cases, color = mun)) +\n  geom_line(alpha = .3) +\n  facet_wrap(~group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n## Time series features per group\n\nAdd group Id to time series feautures.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsf_group <- left_join(tsf, cluster_ids, by = \"mun\")\n```\n:::\n\n\n### Shannon entropy\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = entropy, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"entropy\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-2432be069cd9d72ffcca\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2432be069cd9d72ffcca\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1068,0.2914,0.2238,0.3028,0.2368,0.1144,0.0881,0.1067,0.1355,0.07870000000000001],[0.8764,0.0083,0.0103,0,0.0002,0.7224,0.7307,0.1845,0.5123,0.8302]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Stability & lumpiness\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = stability, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"stability\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-84baff2c5cbf2d73014d\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-84baff2c5cbf2d73014d\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1455,0.2288,0.1731,0.2302,0.1992,0.1177,0.1364,0.0609,0.1249,0.136],[0.5537,0.0669,0.0852,0.0005,0.0029,0.6943,0.2062,0.8323,0.6159,0.1947]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = lumpiness, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"lumpiness\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c2ead5a422bad5b8ef28\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c2ead5a422bad5b8ef28\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1091,0.3384,0.3773,0.196,0.0727,0.208,0.2516,0.1676,0.3063,0.3148],[0.8608,0.0012,0,0.0046,0.7773,0.09470000000000001,0.0009,0.0056,0.0026,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Flat spots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = flat_spots, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"flat_spots\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-39f05a90f5db17b54262\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-39f05a90f5db17b54262\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[1,1,1,1,1,1,0.995,1,1,1],[0,0,0,0,0,0,0,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Zero proportion\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = zero_proportion, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"zero_proportion\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c9e31cec2fe989d9518d\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c9e31cec2fe989d9518d\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.0114,0.0076,0.0076,0.0076,0.0076,0,0.0114,0,0,0.0114],[1,1,1,1,1,1,1,1,1,1]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### STL features decomposition\n\n#### Trend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = trend, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"trend\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-6e0ed8380178995cce07\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6e0ed8380178995cce07\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1614,0.1595,0.1066,0.1135,0.1311,0.1593,0.0639,0.0892,0.1243,0.0963],[0.4236,0.3691,0.5878,0.2606,0.1182,0.3216,0.9645,0.375,0.6196,0.6036]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Spike\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = spike, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"spike\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-3bddd191da237978609e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3bddd191da237978609e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.125,0.4038,0.3944,0.3171,0.1399,0.2181,0.2105,0.2002,0.3195,0.3219],[0.7334000000000001,0.0001,0,0,0.0801,0.0703,0.0089,0.0005,0.0014,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Linearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = linearity, , fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"linearity\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-f132d61c8e11f3d10a3e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f132d61c8e11f3d10a3e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.3273,0.2718,0.1624,0.0834,0.1328,0.2891,0.1146,0.1445,0.3873,0.227],[0.0041,0.017,0.1245,0.6425999999999999,0.1099,0.0055,0.3993,0.0252,0,0.003]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Curvature\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = curvature, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"curvature\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-1ab149e2b8036675ad7a\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1ab149e2b8036675ad7a\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.5909,0.5094,0.2135,0.1166,0.0622,0.5528999999999999,0.1107,0.1044,0.5113,0.2015],[0,0,0.0165,0.2333,0.9075,0,0.4436,0.2041,0,0.0121]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### First autocorrelation coefficient\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = e_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"e_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-3c7ea3f8b1fecd7ae131\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3c7ea3f8b1fecd7ae131\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1886,0.3025,0.3509,0.3509,0.2956,0.1567,0.0757,0.1112,0.1239,0.1213],[0.2475,0.0054,0,0,0,0.3493,0.8759,0.1503,0.6251,0.3126]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Sum of the first ten squared autocorrelation coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = e_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-50-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"e_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-af96aae14e6c57a3a868\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-af96aae14e6c57a3a868\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1318,0.267,0.2879,0.2958,0.2458,0.1427,0.0623,0.1092,0.1288,0.0963],[0.6741,0.02,0.0003,0,0.0001,0.458,0.9718,0.1646,0.5754,0.6036]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Autocorrelation function (ACF) features\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = x_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-52-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"x_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-6177cf93c03f0dde92ff\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6177cf93c03f0dde92ff\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1341,0.3552,0.3276,0.3148,0.282,0.127,0.0866,0.079,0.1534,0.08699999999999999],[0.6535,0.0005999999999999999,0,0,0,0.6059,0.7504,0.5306999999999999,0.3605,0.7275]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = x_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-54-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"x_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-21d9a5ebaef7aa50a6b1\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-21d9a5ebaef7aa50a6b1\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1273,0.2324,0.1738,0.2423,0.2171,0.1008,0.12,0.0629,0.1446,0.0877],[0.7138,0.0598,0.0833,0.0002,0.0009,0.851,0.3429,0.8018999999999999,0.4315,0.718]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff1_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-56-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff1_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-e41730949b95ba39763c\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e41730949b95ba39763c\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1841,0.4836,0.4459,0.3879,0.301,0.1263,0.162,0.1185,0.2098,0.2026],[0.2724,0,0,0,0,0.6152,0.0813,0.1055,0.0859,0.0114]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff1_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff1_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-1cc4fa77eaaa3fdb9c60\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1cc4fa77eaaa3fdb9c60\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.225,0.2573,0.3734,0.2713,0.1742,0.1421,0.1682,0.1505,0.2342,0.2865],[0.1039,0.0277,0,0,0.0136,0.4651,0.0634,0.0174,0.0402,0.0001]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff2_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-60-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff2_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4a3a5fcb78b3e2de7435\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4a3a5fcb78b3e2de7435\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1114,0.4279,0.4691,0.2986,0.2452,0.1681,0.2007,0.08740000000000001,0.2333,0.253],[0.8429,0,0,0,0.0001,0.2665,0.0147,0.4005,0.0415,0.0005999999999999999]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff2_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-62-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff2_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-b655672fd40861df37e8\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b655672fd40861df37e8\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"5\",\"5\"],[\"2\",\"1\",\"2\",\"4\",\"5\",\"1\",\"2\",\"5\",\"1\",\"2\"],[0.1136,0.1342,0.181,0.1131,0.1222,0.0917,0.09420000000000001,0.0873,0.1033,0.0766],[0.8267,0.5845,0.06370000000000001,0.2646,0.1713,0.913,0.6508,0.4025,0.8214,0.8542999999999999]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.30            tsfeatures_1.1.1   arrow_13.0.0.1     yardstick_1.2.0   \n [5] workflowsets_1.0.1 workflows_1.1.3    tune_1.1.2         rsample_1.2.0     \n [9] recipes_1.0.8      parsnip_1.1.1      modeldata_1.2.0    infer_1.0.5       \n[13] dials_1.2.0        scales_1.2.1       broom_1.0.5        tidymodels_1.1.1  \n[17] lubridate_1.9.3    forcats_1.0.0      stringr_1.5.0      dplyr_1.1.3       \n[21] purrr_1.0.2        readr_2.1.4        tidyr_1.3.0        tibble_3.2.1      \n[25] ggplot2_3.4.4      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] rlang_1.1.2         magrittr_2.0.3      furrr_0.3.1        \n [4] tseries_0.10-54     compiler_4.3.2      vctrs_0.6.4        \n [7] lhs_1.1.6           quadprog_1.5-8      pkgconfig_2.0.3    \n[10] fastmap_1.1.1       ellipsis_0.3.2      backports_1.4.1    \n[13] labeling_0.4.3      utf8_1.2.4          rmarkdown_2.25     \n[16] prodlim_2023.08.28  tzdb_0.4.0          bit_4.0.5          \n[19] xfun_0.41           cachem_1.0.8        jsonlite_1.8.7     \n[22] parallel_4.3.2      R6_2.5.1            bslib_0.5.1        \n[25] stringi_1.7.12      parallelly_1.36.0   rpart_4.1.21       \n[28] jquerylib_0.1.4     lmtest_0.9-40       Rcpp_1.0.11        \n[31] assertthat_0.2.1    iterators_1.0.14    knitr_1.45         \n[34] future.apply_1.11.0 zoo_1.8-12          Matrix_1.6-1.1     \n[37] splines_4.3.2       nnet_7.3-19         timechange_0.2.0   \n[40] tidyselect_1.2.0    rstudioapi_0.15.0   yaml_2.3.7         \n[43] timeDate_4022.108   codetools_0.2-19    curl_5.1.0         \n[46] listenv_0.9.0       lattice_0.22-5      quantmod_0.4.25    \n[49] withr_2.5.2         urca_1.3-3          evaluate_0.23      \n[52] future_1.33.0       survival_3.5-7      xts_0.13.1         \n[55] pillar_1.9.0        foreach_1.5.2       generics_0.1.3     \n[58] TTR_0.24.3          forecast_8.21.1     hms_1.1.3          \n[61] munsell_0.5.0       globals_0.16.2      class_7.3-22       \n[64] glue_1.6.2          tools_4.3.2         data.table_1.14.8  \n[67] gower_1.0.1         grid_4.3.2          crosstalk_1.2.0    \n[70] ipred_0.9-14        colorspace_2.1-0    nlme_3.1-163       \n[73] fracdiff_1.5-2      cli_3.6.1           DiceDesign_1.9     \n[76] fansi_1.0.5         lava_1.7.3          gtable_0.3.4       \n[79] GPfit_1.0-8         sass_0.4.7          digest_0.6.33      \n[82] farver_2.1.1        htmlwidgets_1.6.2   htmltools_0.5.7    \n[85] lifecycle_1.0.4     hardhat_1.3.0       bit64_4.0.5        \n[88] MASS_7.3-60        \n```\n:::\n:::\n",
    "supporting": [
      "cluster_tsfeatures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.30/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}