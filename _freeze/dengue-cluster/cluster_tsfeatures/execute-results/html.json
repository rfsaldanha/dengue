{
  "hash": "967fe29a80601936577697709d1dc4d8",
  "result": {
    "markdown": "---\ntitle: \"Time series features\"\nsubtitle: \"with scaled cases\"\nauthor: \"Raphael Saldanha\"\ndate: last-modified\nbibliography: references.bib\n---\n\n\nThis notebook aims to explore time series features of dengue cases that may guide the clustering procedures. Time series features descriptions are quoted from @tsfeatures .\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(arrow)\nlibrary(tsfeatures)\nlibrary(broom)\nlibrary(DT)\nsource(\"../functions.R\")\n```\n:::\n\n\n### Functions\n\nPerform Kolmogorov-Smirnorf tests between groups statistics.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nks_group_test <- function(stat){\n  \n  tsf_group_split <- tsf_group %>%\n    # Select variables and statistic\n    select(group, statistic = !!stat) %>%\n    # Split to list  \n    group_split(group) \n\n  # Matrix of possible combinations\n  comb <- combn(x = unique(tsf_group$group), m = 2)\n\n  # Resuls data frame\n  ks_results <- tibble()\n  \n  \n  # For each group combination, perform ks.test\n  for(i in 1:ncol(comb)){\n    g_a <- comb[1,i]\n    g_b <- comb[2,i]\n    \n    res <- ks.test(\n      x = tsf_group_split[[g_a]]$statistic, \n      y =  tsf_group_split[[g_b]]$statistic\n    ) %>% tidy()\n    \n    tmp <- tibble(\n      g_a = g_a,\n      g_b = g_b,\n      statistic = round(res$statistic, 4),\n      pvalue = round(res$p.value, 4)\n    )\n    \n    ks_results <- bind_rows(ks_results, tmp)\n  }\n  \n  ks_results %>%\n    arrange(g_a, g_b)\n}\n```\n:::\n\n\n## Load data\n\nLoad the bundled data (679 municipalities, pop $\\geq$ 50k inhab.) with standardized cases and keep only the municipality code, date and cases variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n    select(mun, date, cases) %>%\n    collect()\n```\n:::\n\n\n## Prepare data\n\nConvert panel data to a list of `ts` objects.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue_df <- tdengue %>%\n  arrange(mun, date) %>%\n  select(-date) %>%\n  nest(data = cases, .by = mun)\n\ntdengue_list <- lapply(tdengue_df$data, ts)\n```\n:::\n\n\n## Time series features\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsf <- tsfeatures(\n  tslist = tdengue_list, \n  features = c(\"entropy\", \"stability\",\n               \"lumpiness\", \"flat_spots\",\n               \"zero_proportion\", \"stl_features\",\n               \"acf_features\")\n)\n  \ntsf$mun <- tdengue_df$mun\n```\n:::\n\n\nAll features available at the `tsfeatures` package were computed. Bellow, details about some of them.\n\n### Shannon entropy\n\n> Measures the \"forecastability\" of a time series, where low values indicate a high signal-to-noise ratio, and large values occur when a series is difficult to forecast.\n\n$$\n-\\int^\\pi_{-\\pi}\\hat{f}(\\lambda)\\log\\hat{f}(\\lambda) d\\lambda\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = entropy)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Stability & lumpiness\n\n> Stability and lumpiness are two time series features based on tiled (non-overlapping) windows. Means or variances are produced for all tiled windows. Then stability is the variance of the means, while lumpiness is the variance of the variances.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = stability)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = lumpiness)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Flat spots\n\n> Flat spots are computed by dividing the sample space of a time series into ten equal-sized intervals, and computing the maximum run length within any single interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = flat_spots)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### STL features decomposition\n\n#### Trend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = trend)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n#### Spike\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = spike)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n#### Linearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = linearity)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#### Curvature\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = curvature)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n#### First autocorrelation coefficient\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = e_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n#### Sum of the first ten squared autocorrelation coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = e_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### Autocorrelation function (ACF) features\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = x_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = x_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff1_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff1_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff2_acf1)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf, aes(x = diff2_acf10)) +\n  geom_histogram(bins = 50, alpha = .7, fill = \"purple\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n## Clustering\n\nThis procedure goal is to cluster the municipalities considering time series features similarities.\n\n### K-means clustering\n\nCluster the municipalities based solely on the time series features.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npoints <- tsf %>%\n  select(-mun)\n```\n:::\n\n\nUses $k$ from 2 to 10 for clustering.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkclusts <- \n  tibble(k = 2:10) %>%\n  mutate(\n    kclust = map(k, ~kmeans(points, .x)),\n    tidied = map(kclust, tidy),\n    glanced = map(kclust, glance),\n    augmented = map(kclust, augment, points)\n  )\n```\n:::\n\n\nIsolate results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclusters <- \n  kclusts %>%\n  unnest(cols = c(tidied))\n\nassignments <- \n  kclusts %>% \n  unnest(cols = c(augmented))\n\nclusterings <- \n  kclusts %>%\n  unnest(cols = c(glanced))\n```\n:::\n\n\nThe total sum of squares is plotted. The \\$k=5\\$ seems to be a break point.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(clusterings, aes(k, tot.withinss)) +\n  geom_line() +\n  geom_point() +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsilhouette_score <- function(k){\n  km <- kmeans(points, centers = k, nstart=25)\n  ss <- cluster::silhouette(km$cluster, dist(points))\n  mean(ss[, 3])\n}\nk <- 2:10\navg_sil <- sapply(k, silhouette_score)\nplot(k, type='b', avg_sil, xlab='Number of clusters', ylab='Average Silhouette Scores', frame=FALSE)\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n### Identify municipalities and cluster id\n\nFinally, the cluster partition ID is added to the main dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_ids <- clusterings %>%\n  filter(k == 5) %>%\n  pull(augmented) %>%\n  pluck(1) %>%\n  select(group = .cluster) %>%\n  mutate(mun = tdengue_df$mun)\n```\n:::\n\n\n### Cluster sizes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(cluster_ids$group)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5 \n 37 225  56 259 102 \n```\n:::\n:::\n\n\n### Cluster time series plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninner_join(tdengue, cluster_ids, by = \"mun\") %>%\n  ggplot(aes(x = date, y = cases, color = mun)) +\n  geom_line(alpha = .3) +\n  facet_wrap(~group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n## Time series features per group\n\nAdd group Id to time series feautures.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsf_group <- left_join(tsf, cluster_ids, by = \"mun\")\n```\n:::\n\n\n### Shannon entropy\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = entropy, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"entropy\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4d34b5a195c0cc45c450\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4d34b5a195c0cc45c450\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.3793,0.3139,0.1198,0.3398,0.0956,0.0864,0.1849,0.2226,0.243,0.2565],[0.0023,0.0028,0.541,0.0008,0.221,0.882,0.2709,0.0019,0.0225,0.0001]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Stability & lumpiness\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = stability, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"stability\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-1bc958ff33f411fa0060\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1bc958ff33f411fa0060\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.2548,0.3031,0.1493,0.2471,0.0693,0.0975,0.1415,0.1809,0.1947,0.1623],[0.0914,0.0044,0.2704,0.0332,0.6098,0.7739,0.5878,0.0202,0.1098,0.0423]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = lumpiness, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"lumpiness\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-ea016978770b278e46e4\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ea016978770b278e46e4\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4097,0.1541,0.296,0.305,0.2008,0.1313,0.1781,0.06809999999999999,0.2969,0.2022],[0.0005999999999999999,0.3929,0.0008,0.0039,0.0001,0.4056,0.3102,0.9006999999999999,0.0025,0.005]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Flat spots\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = flat_spots, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"flat_spots\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-6c3c6d855a44c07357cc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6c3c6d855a44c07357cc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Zero proportion\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = zero_proportion, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"zero_proportion\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-f3684f3933c40af278ff\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f3684f3933c40af278ff\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0,0,0,0.0039,0.0039,0.0039,0.0098,0.0098,0.0098,0.0098],[1,1,1,1,1,1,1,1,1,1]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### STL features decomposition\n\n#### Trend\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = trend, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"trend\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-a7fcaa7130126d5d222d\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a7fcaa7130126d5d222d\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.1993,0.1787,0.1065,0.1429,0.0905,0.1467,0.1028,0.1149,0.1621,0.1032],[0.2948,0.2296,0.6892,0.4915,0.2782,0.2748,0.9001,0.3123,0.2617,0.417]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Spike\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = spike, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"spike\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-234f37e0e6055166497e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-234f37e0e6055166497e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4875,0.2995,0.3004,0.4556,0.208,0.1414,0.2316,0.1114,0.3456,0.3013],[0,0.005,0.0005999999999999999,0,0.0001,0.3159,0.09080000000000001,0.3488,0.0002,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Linearity\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = linearity, , fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"linearity\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-b2f1944e32d43b9a9704\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b2f1944e32d43b9a9704\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.2756,0.2424,0.3581,0.1544,0.1861,0.2833,0.1802,0.09859999999999999,0.2773,0.1261],[0.051,0.0391,0,0.3938,0.0005,0.0012,0.2983,0.5029,0.0059,0.1953]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Curvature\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = curvature, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"curvature\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-deea0fba2555127050c3\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-deea0fba2555127050c3\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4073,0.1386,0.5013,0.2741,0.168,0.5796,0.2048,0.09859999999999999,0.5567,0.1686],[0.0008,0.524,0,0.0129,0.0022,0,0.1748,0.5029,0,0.0312]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### First autocorrelation coefficient\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = e_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-49-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"e_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-cfe19562dfb5794b3b7c\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cfe19562dfb5794b3b7c\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4609,0.4186,0.0793,0.4942,0.09569999999999999,0.1549,0.2785,0.2731,0.2878,0.3445],[0.0001,0,0.9407,0,0.2203,0.2191,0.0233,0.0001,0.0037,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n#### Sum of the first ten squared autocorrelation coefficients\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = e_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"e_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-662e60055b2ff759d73d\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-662e60055b2ff759d73d\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4078,0.3738,0.0999,0.4247,0.08989999999999999,0.1588,0.2342,0.2286,0.2125,0.2871],[0.0008,0.0002,0.7619,0,0.2852,0.196,0.0844,0.0013,0.0636,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n### Autocorrelation function (ACF) features\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = x_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-53-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"x_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-fbe0b6fa89ec51e75f28\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fbe0b6fa89ec51e75f28\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.4976,0.4231,0.1017,0.4595,0.06909999999999999,0.1158,0.2345,0.249,0.2777,0.2833],[0,0,0.7429,0,0.613,0.5671,0.0833,0.0003,0.0058,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = x_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"x_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-9de1b1e218b1fddb2b3f\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9de1b1e218b1fddb2b3f\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.3069,0.2783,0.1152,0.2973,0.0678,0.07920000000000001,0.1677,0.1986,0.18,0.1905],[0.0236,0.0113,0.5909,0.0053,0.6377,0.9352,0.3804,0.007900000000000001,0.1658,0.009900000000000001]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff1_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-57-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff1_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-77c28225769e6d9376fb\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-77c28225769e6d9376fb\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.5333,0.4446,0.1325,0.5058,0.1444,0.07630000000000001,0.2835,0.2595,0.3641,0.3593],[0,0,0.4109,0,0.0132,0.9517,0.0198,0.0002,0.0001,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff1_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff1_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-a75381a8903249abc029\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a75381a8903249abc029\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.2143,0.1596,0.2301,0.2548,0.1931,0.1187,0.2684,0.2058,0.3256,0.343],[0.209,0.3501,0.0173,0.0254,0.0003,0.535,0.0321,0.0053,0.0007,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff2_acf1, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff2_acf1\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-5f6915adbfba6c687d16\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5f6915adbfba6c687d16\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.5521,0.4601,0.2157,0.5212,0.1169,0.1033,0.3084,0.2417,0.3778,0.3199],[0,0,0.0308,0,0.0745,0.7099,0.008399999999999999,0.0005,0,0]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tsf_group, aes(x = diff2_acf10, fill = group)) +\n  geom_histogram(bins = 50, alpha = .7) +\n  facet_wrap(~ group) +\n  theme_bw() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](cluster_tsfeatures_files/figure-html/unnamed-chunk-63-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nks_group_test(\"diff2_acf10\") %>% datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-12b74d4ceec4de884db3\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-12b74d4ceec4de884db3\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],[\"1\",\"2\",\"2\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\"],[\"3\",\"1\",\"3\",\"1\",\"2\",\"3\",\"1\",\"2\",\"3\",\"4\"],[0.2548,0.2641,0.1011,0.2355,0.09520000000000001,0.1014,0.2464,0.1048,0.1502,0.1618],[0.0914,0.0189,0.749,0.0483,0.2248,0.7316,0.0607,0.4234,0.3454,0.0433]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>g_a<\\/th>\\n      <th>g_b<\\/th>\\n      <th>statistic<\\/th>\\n      <th>pvalue<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.30            tsfeatures_1.1.1   arrow_13.0.0.1     yardstick_1.2.0   \n [5] workflowsets_1.0.1 workflows_1.1.3    tune_1.1.2         rsample_1.2.0     \n [9] recipes_1.0.8      parsnip_1.1.1      modeldata_1.2.0    infer_1.0.5       \n[13] dials_1.2.0        scales_1.2.1       broom_1.0.5        tidymodels_1.1.1  \n[17] lubridate_1.9.3    forcats_1.0.0      stringr_1.5.0      dplyr_1.1.3       \n[21] purrr_1.0.2        readr_2.1.4        tidyr_1.3.0        tibble_3.2.1      \n[25] ggplot2_3.4.4      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] rlang_1.1.2         magrittr_2.0.3      furrr_0.3.1        \n [4] tseries_0.10-54     compiler_4.3.2      vctrs_0.6.4        \n [7] lhs_1.1.6           quadprog_1.5-8      pkgconfig_2.0.3    \n[10] fastmap_1.1.1       ellipsis_0.3.2      backports_1.4.1    \n[13] labeling_0.4.3      utf8_1.2.4          rmarkdown_2.25     \n[16] prodlim_2023.08.28  tzdb_0.4.0          bit_4.0.5          \n[19] xfun_0.41           cachem_1.0.8        jsonlite_1.8.7     \n[22] cluster_2.1.4       parallel_4.3.2      R6_2.5.1           \n[25] bslib_0.5.1         stringi_1.7.12      parallelly_1.36.0  \n[28] rpart_4.1.21        jquerylib_0.1.4     lmtest_0.9-40      \n[31] Rcpp_1.0.11         assertthat_0.2.1    iterators_1.0.14   \n[34] knitr_1.45          future.apply_1.11.0 zoo_1.8-12         \n[37] Matrix_1.6-1.1      splines_4.3.2       nnet_7.3-19        \n[40] timechange_0.2.0    tidyselect_1.2.0    rstudioapi_0.15.0  \n[43] yaml_2.3.7          timeDate_4022.108   codetools_0.2-19   \n[46] curl_5.1.0          listenv_0.9.0       lattice_0.22-5     \n[49] quantmod_0.4.25     withr_2.5.2         urca_1.3-3         \n[52] evaluate_0.23       future_1.33.0       survival_3.5-7     \n[55] xts_0.13.1          pillar_1.9.0        foreach_1.5.2      \n[58] generics_0.1.3      TTR_0.24.3          forecast_8.21.1    \n[61] hms_1.1.3           munsell_0.5.0       globals_0.16.2     \n[64] class_7.3-22        glue_1.6.2          tools_4.3.2        \n[67] data.table_1.14.8   gower_1.0.1         grid_4.3.2         \n[70] crosstalk_1.2.0     ipred_0.9-14        colorspace_2.1-0   \n[73] nlme_3.1-163        fracdiff_1.5-2      cli_3.6.1          \n[76] DiceDesign_1.9      fansi_1.0.5         lava_1.7.3         \n[79] gtable_0.3.4        GPfit_1.0-8         sass_0.4.7         \n[82] digest_0.6.33       farver_2.1.1        htmlwidgets_1.6.2  \n[85] htmltools_0.5.7     lifecycle_1.0.4     hardhat_1.3.0      \n[88] bit64_4.0.5         MASS_7.3-60        \n```\n:::\n:::\n",
    "supporting": [
      "cluster_tsfeatures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.30/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}