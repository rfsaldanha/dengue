{
  "hash": "a5d277bf3222dbd160f265172ee3b644",
  "result": {
    "markdown": "---\ntitle: \"Scaled cases\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering scaled (standardized) dengue cases time-series similarities.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nLoad the aggregated data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n    select(mun, date, cases = cases_cum) %>%\n    collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 340179      3\n```\n:::\n:::\n\n\n### Prepare data\n\nThe chunk bellow executes various steps to prepare the data for clustering.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- tdengue %>%\n  # Prepare time series\n  mutate(mun = paste0(\"m_\", mun)) %>%\n  arrange(mun, date) %>%\n  pivot_wider(names_from = mun, values_from = cases) %>%\n  select(-date) %>%\n  t() %>%\n  tslist()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 679\n```\n:::\n:::\n\n\n## Clustering\n\nSequence of `k` groups to be used.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nk_seq <- 2:10\n```\n:::\n\n\n### DTW (basic)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_dtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"dtw_basic\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n39.508 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_dtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_dtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3883485</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">219.03946</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.134304</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.134304</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.008077949</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.15430130</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3067752</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">310.90157</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.635604</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.775981</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.006456940</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.12341630</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2387272</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">162.71153</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.759704</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.280500</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.006971102</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.09710109</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2052530</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">116.02794</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.497911</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.157663</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.010105561</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.08426017</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1759150</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">110.48283</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.982305</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.102040</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.007701467</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.07432019</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1677298</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">116.57366</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.604325</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.207429</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.010855206</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.08933756</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1586523</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">80.28211</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.273564</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.023525</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.006111798</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.08597771</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1539778</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">147.65699</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.473204</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.436038</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.005005953</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.12329358</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1527731</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">126.08954</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.013522</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.576196</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.005165569</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.10876459</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_dtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n551 128 \n```\n:::\n:::\n\n\n\n### Soft-DTW\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sdtw <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sdtw\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n208.008 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sdtw) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sdtw, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">4.6835404</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">3.301961e-04</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">-1198.16808</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">0.4328621</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">70.9687638</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.027622202</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">-0.001783289</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.5874870</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">1.210092e-08</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">241.76435</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">0.4728893</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">0.6095286</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.016428914</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.017947639</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.5526841</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">1.864919e-08</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">-157.74645</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">0.6603416</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">0.6603416</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.008343487</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.076892143</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.5143244</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">2.926145e-06</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">1776.33826</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.5865645</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">-11.8749979</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.024224946</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.003868853</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.5091103</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">4.869410e-04</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">463.73188</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.1072188</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">0.3291628</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.018669198</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.005947036</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4865815</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">8.516047e-01</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">1744.16238</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">2.2000345</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">-13.7430978</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.020388668</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.003773382</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4759798</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">3.530744e-08</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">219.42676</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.0472748</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.8079291</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.015917823</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.007728450</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2085165</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">1.043811e-05</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">46.69006</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.5530459</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">-0.6703440</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.016278775</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.027708772</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.0811271</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">1.595867e-05</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">51191.47920</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">3.6371109</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">-5.0907762</td>\n<td headers=\"D\" class=\"gt_row gt_right\">-0.024336278</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.001610495</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sdtw[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5   6   7   8   9 \n 74 106 102  83  89  78  44  81  22 \n```\n:::\n:::\n\n\n### SBD\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_sbd <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"sbd\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n0.768 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_sbd) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_sbd, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"xwuqmzmjuo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#xwuqmzmjuo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#xwuqmzmjuo thead, #xwuqmzmjuo tbody, #xwuqmzmjuo tfoot, #xwuqmzmjuo tr, #xwuqmzmjuo td, #xwuqmzmjuo th {\n  border-style: none;\n}\n\n#xwuqmzmjuo p {\n  margin: 0;\n  padding: 0;\n}\n\n#xwuqmzmjuo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#xwuqmzmjuo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#xwuqmzmjuo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#xwuqmzmjuo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#xwuqmzmjuo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#xwuqmzmjuo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#xwuqmzmjuo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#xwuqmzmjuo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#xwuqmzmjuo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#xwuqmzmjuo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#xwuqmzmjuo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#xwuqmzmjuo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#xwuqmzmjuo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#xwuqmzmjuo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#xwuqmzmjuo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#xwuqmzmjuo .gt_left {\n  text-align: left;\n}\n\n#xwuqmzmjuo .gt_center {\n  text-align: center;\n}\n\n#xwuqmzmjuo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#xwuqmzmjuo .gt_font_normal {\n  font-weight: normal;\n}\n\n#xwuqmzmjuo .gt_font_bold {\n  font-weight: bold;\n}\n\n#xwuqmzmjuo .gt_font_italic {\n  font-style: italic;\n}\n\n#xwuqmzmjuo .gt_super {\n  font-size: 65%;\n}\n\n#xwuqmzmjuo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#xwuqmzmjuo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#xwuqmzmjuo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#xwuqmzmjuo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#xwuqmzmjuo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#xwuqmzmjuo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#xwuqmzmjuo .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4442625</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5940473</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">345.3780</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.035863</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.035863</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.008004787</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.20201102</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4022197</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5792206</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">346.5557</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.239092</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.387231</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001858214</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.12732693</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3334983</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5737804</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">245.6445</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.121578</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.815766</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.002032385</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.10409579</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3274548</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5339155</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">190.7100</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.212410</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.079583</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.004857007</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06826826</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3125595</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5426452</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">206.1180</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.239948</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.105174</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.008653764</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.07328745</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2993463</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5225233</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">168.3385</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.828146</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.486689</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.002307383</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.05626920</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2813463</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5244313</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">182.8368</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.213397</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.947885</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.002827627</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.05685390</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2604179</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5603160</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">209.0601</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.290158</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.825457</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.003340171</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.10155246</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.1947688</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.5344965</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">148.8106</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.642704</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.682444</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.002371686</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.07799687</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_sbd[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n500 179 \n```\n:::\n:::\n\n\n### GAK \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nclust_gak <- tsclust(\n  series = tdengue, \n  type = \"partitional\", \n  k = k_seq,\n  distance = \"gak\",\n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n269.685 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(clust_gak) <- paste0(\"k_\", k_seq)\nres_cvi <- sapply(clust_gak, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\nres_cvi %>%\n  gt::gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hsjzvcykoa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hsjzvcykoa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hsjzvcykoa thead, #hsjzvcykoa tbody, #hsjzvcykoa tfoot, #hsjzvcykoa tr, #hsjzvcykoa td, #hsjzvcykoa th {\n  border-style: none;\n}\n\n#hsjzvcykoa p {\n  margin: 0;\n  padding: 0;\n}\n\n#hsjzvcykoa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hsjzvcykoa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hsjzvcykoa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hsjzvcykoa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hsjzvcykoa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hsjzvcykoa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hsjzvcykoa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hsjzvcykoa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hsjzvcykoa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hsjzvcykoa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hsjzvcykoa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hsjzvcykoa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hsjzvcykoa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hsjzvcykoa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hsjzvcykoa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hsjzvcykoa .gt_left {\n  text-align: left;\n}\n\n#hsjzvcykoa .gt_center {\n  text-align: center;\n}\n\n#hsjzvcykoa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hsjzvcykoa .gt_font_normal {\n  font-weight: normal;\n}\n\n#hsjzvcykoa .gt_font_bold {\n  font-weight: bold;\n}\n\n#hsjzvcykoa .gt_font_italic {\n  font-style: italic;\n}\n\n#hsjzvcykoa .gt_super {\n  font-size: 65%;\n}\n\n#hsjzvcykoa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hsjzvcykoa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hsjzvcykoa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hsjzvcykoa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hsjzvcykoa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hsjzvcykoa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hsjzvcykoa .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"k\">k</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sil\">Sil</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SF\">SF</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CH\">CH</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DB\">DB</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DBstar\">DBstar</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"D\">D</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"COP\">COP</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_2</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4703437</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6318950</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">346.9030</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">0.7492626</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">0.7492626</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.002673344</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.22610650</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_3</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.4242503</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6317923</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">350.9145</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.1578518</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.3150938</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001689423</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.12032277</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_4</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3404306</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6317602</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">248.3140</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.0644928</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.7873944</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001860028</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.09770063</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_7</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3391378</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6315128</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">204.6923</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.2022774</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.0564247</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.003583292</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06365358</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_6</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3320730</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6315865</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">228.3494</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.1336897</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.8636779</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.004311562</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.06847479</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_9</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3173288</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6314596</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">178.8928</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.1311449</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">1.9720656</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.004519858</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.04981730</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_10</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.3094439</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6314500</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">177.1258</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.7581411</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">3.6257840</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001690421</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.05150554</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_5</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2528416</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6316542</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">190.1814</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.5612030</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">2.0839318</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001970852</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.09056517</td></tr>\n    <tr><td headers=\"k\" class=\"gt_row gt_left\">k_8</td>\n<td headers=\"Sil\" class=\"gt_row gt_right\">0.2169763</td>\n<td headers=\"SF\" class=\"gt_row gt_right\">0.6315151</td>\n<td headers=\"CH\" class=\"gt_row gt_right\">152.0770</td>\n<td headers=\"DB\" class=\"gt_row gt_right\">1.7145901</td>\n<td headers=\"DBstar\" class=\"gt_row gt_right\">4.1675547</td>\n<td headers=\"D\" class=\"gt_row gt_right\">0.001897451</td>\n<td headers=\"COP\" class=\"gt_row gt_right\">0.07208410</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsel_clust <- clust_gak[[res_cvi[[1,1]]]]\n\nplot(sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(sel_clust, type = \"centroids\", lty = 1)\n```\n\n::: {.cell-output-display}\n![](cluster_long_cum_scaled_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2 \n535 144 \n```\n:::\n:::\n\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] tictoc_1.2       kableExtra_1.3.4 dtwclust_5.5.12  dtw_1.23-1      \n [5] proxy_0.4-27     timetk_2.9.0     arrow_13.0.0.1   lubridate_1.9.3 \n [9] forcats_1.0.0    stringr_1.5.0    dplyr_1.1.3      purrr_1.0.2     \n[13] readr_2.1.4      tidyr_1.3.0      tibble_3.2.1     ggplot2_3.4.4   \n[17] tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rlang_1.1.2         magrittr_2.0.3      clue_0.3-65        \n  [4] furrr_0.3.1         flexclust_1.4-1     compiler_4.3.2     \n  [7] systemfonts_1.0.5   vctrs_0.6.4         reshape2_1.4.4     \n [10] rvest_1.0.3         lhs_1.1.6           tune_1.1.2         \n [13] pkgconfig_2.0.3     fastmap_1.1.1       ellipsis_0.3.2     \n [16] labeling_0.4.3      utf8_1.2.4          promises_1.2.1     \n [19] rmarkdown_2.25      prodlim_2023.08.28  tzdb_0.4.0         \n [22] bit_4.0.5           xfun_0.41           modeltools_0.2-23  \n [25] jsonlite_1.8.7      recipes_1.0.8       later_1.3.1        \n [28] parallel_4.3.2      cluster_2.1.4       R6_2.5.1           \n [31] stringi_1.7.12      rsample_1.2.0       parallelly_1.36.0  \n [34] rpart_4.1.21        Rcpp_1.0.11         assertthat_0.2.1   \n [37] dials_1.2.0         iterators_1.0.14    knitr_1.45         \n [40] future.apply_1.11.0 zoo_1.8-12          httpuv_1.6.12      \n [43] Matrix_1.6-1.1      splines_4.3.2       nnet_7.3-19        \n [46] timechange_0.2.0    tidyselect_1.2.0    rstudioapi_0.15.0  \n [49] yaml_2.3.7          timeDate_4022.108   codetools_0.2-19   \n [52] listenv_0.9.0       lattice_0.22-5      plyr_1.8.9         \n [55] shiny_1.7.5.1       withr_2.5.2         evaluate_0.23      \n [58] future_1.33.0       survival_3.5-7      RcppParallel_5.1.7 \n [61] xml2_1.3.5          xts_0.13.1          pillar_1.9.0       \n [64] foreach_1.5.2       stats4_4.3.2        shinyjs_2.1.0      \n [67] generics_0.1.3      hms_1.1.3           munsell_0.5.0      \n [70] scales_1.2.1        xtable_1.8-4        globals_0.16.2     \n [73] class_7.3-22        glue_1.6.2          tools_4.3.2        \n [76] data.table_1.14.8   RSpectra_0.16-1     webshot_0.5.5      \n [79] gower_1.0.1         grid_4.3.2          yardstick_1.2.0    \n [82] ipred_0.9-14        colorspace_2.1-0    cli_3.6.1          \n [85] DiceDesign_1.9      workflows_1.1.3     parsnip_1.1.1      \n [88] fansi_1.0.5         viridisLite_0.4.2   gt_0.10.0          \n [91] svglite_2.1.2       lava_1.7.3          gtable_0.3.4       \n [94] GPfit_1.0-8         sass_0.4.7          digest_0.6.33      \n [97] ggrepel_0.9.4       farver_2.1.1        htmlwidgets_1.6.2  \n[100] htmltools_0.5.7     lifecycle_1.0.3     httr_1.4.7         \n[103] hardhat_1.3.0       mime_0.12           bit64_4.0.5        \n[106] MASS_7.3-60        \n```\n:::\n:::\n",
    "supporting": [
      "cluster_long_cum_scaled_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}