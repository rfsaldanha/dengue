{
  "hash": "d8ffeb62382cd9798e679f5648d735aa",
  "result": {
    "markdown": "---\ntitle: \"Climate variables multivariate clustering\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering only climate indicators with multivariate clustering techniques.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nlibrary(sf)\nlibrary(DT)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nDaily, scaled cases, maximum temperature, minimum temperature and precipitation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n  select(mun, date, tmax, tmin, prec) %>%\n  collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 331980      5\n```\n:::\n:::\n\n\nData for maps.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuf_sf <- geobr::read_state(showProgress = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n```{.r .cell-code}\ncoords <- geobr::read_municipality(showProgress = FALSE) %>%\n  st_make_valid() %>%\n  st_centroid()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n:::\n:::\n\n\n## Prepare data\n\nFor clustering, the data must be a list of data frames with climate data and without date.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngdengue <- tdengue %>%\n  group_by(mun) %>%\n  arrange(date) %>%\n  select(-date)\n\nmdengue <- group_split(gdengue, .keep = FALSE) %>%\n  tslist(simplify = TRUE)\n\nnames(mdengue) <- group_keys(gdengue)$mun\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(mdengue[1:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 3\n $ 110002: num [1:1001, 1:3] -14.518 0.299 0.299 0.393 0.393 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"tmax\" \"tmin\" \"prec\"\n $ 110012: num [1:1001, 1:3] -14.518 0.299 0.299 0.393 0.393 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"tmax\" \"tmin\" \"prec\"\n $ 110020: num [1:1001, 1:3] -14.518 0.299 0.299 0.393 0.393 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:3] \"tmax\" \"tmin\" \"prec\"\n```\n:::\n:::\n\n\n## DTW clustering\n\nTry from 2 to 5 partitions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nstdw_clust <- tsclust(\n  series = mdengue, \n  type = \"partitional\", k = 2:5, \n  distance = \"dtw_basic\", \n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n30.191 sec elapsed\n```\n:::\n:::\n\n\n### Cluster Validity Indices (CVI)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(stdw_clust) <- paste0(\"k_\", 2:5)\nres_cvi <- sapply(stdw_clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\ndatatable(res_cvi)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-9a3a6cb3e4f80868c585\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-9a3a6cb3e4f80868c585\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\"],[\"k_5\",\"k_4\",\"k_3\",\"k_2\"],[0.7956875850879431,0.7357453295535062,0.6800903183678049,0.3203225404032219],[0,0,0,0],[291.6570259822248,251.5579911988959,273.2771607470059,111.1776401033615],[0.8195090468598127,0.614826687589783,0.7726932710468508,1.223686795681302],[2.320491606044528,2.394516331840521,1.535842604949903,1.223686795681302],[0.06200030226193576,0.01737168528509853,0.06998465172731703,0.1181275232975209],[0.04094891521778685,0.05840338785997486,0.2087162503824385,0.8672374888311931]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>k<\\/th>\\n      <th>Sil<\\/th>\\n      <th>SF<\\/th>\\n      <th>CH<\\/th>\\n      <th>DB<\\/th>\\n      <th>DBstar<\\/th>\\n      <th>D<\\/th>\\n      <th>COP<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_sel_clust <- stdw_clust[[res_cvi[[1,1]]]]\n\nplot(m_sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_clim_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Partitions size\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(m_sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5 \n127  97  25  41  43 \n```\n:::\n:::\n\n\n### Partition results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoords <- coords %>%\n  mutate(code_muni = substr(code_muni, 0, 6))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids <- tibble(\n  code_muni = names(mdengue),\n  group = as.character(m_sel_clust@cluster)\n) %>% \n  left_join(coords, by = \"code_muni\") %>%\n  arrange(group, name_muni) %>%\n  st_as_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(object = m_cluster_ids, file = \"m_clim_cluster_ids.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids %>%\n  select(group, name_muni, abbrev_state) %>%\n  arrange(group, name_muni) %>%\n  st_drop_geometry() %>%\n  datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-aa1003e105a8d8df3105\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-aa1003e105a8d8df3105\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\"],[\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\"],[\"Abreu E Lima\",\"Americana\",\"Angra Dos Reis\",\"Anápolis\",\"Arapiraca\",\"Araruama\",\"Araxá\",\"Araçatuba\",\"Ariquemes\",\"Assis\",\"Atibaia\",\"Açailândia\",\"Bacabal\",\"Barcarena\",\"Barretos\",\"Barueri\",\"Bauru\",\"Belford Roxo\",\"Betim\",\"Cabo De Santo Agostinho\",\"Cabo Frio\",\"Camaragibe\",\"Camaçari\",\"Campina Grande\",\"Catanduva\",\"Contagem\",\"Corumbá\",\"Cubatão\",\"Curitiba\",\"Dourados\",\"Embu\",\"Eunápolis\",\"Formosa\",\"Franca\",\"Francisco Morato\",\"Garanhuns\",\"Guarujá\",\"Guarulhos\",\"Hortolândia\",\"Ilhéus\",\"Itabaiana\",\"Itabira\",\"Itaboraí\",\"Itabuna\",\"Itacoatiara\",\"Itapecerica Da Serra\",\"Itaperuna\",\"Itapevi\",\"Itaquaquecetuba\",\"Itatiba\",\"Ituiutaba\",\"Itumbiara\",\"Jaboatão Dos Guararapes\",\"Jacareí\",\"Japeri\",\"Jataí\",\"Jequié\",\"Ji-Paraná\",\"Juazeiro\",\"Juazeiro Do Norte\",\"Jundiaí\",\"Lagarto\",\"Lauro De Freitas\",\"Lavras\",\"Limeira\",\"Maceió\",\"Magé\",\"Maricá\",\"Maringá\",\"Marília\",\"Mesquita\",\"Mogi Guaçu\",\"Montes Claros\",\"Muriaé\",\"Nova Serrana\",\"Olinda\",\"Osasco\",\"Ourinhos\",\"Paragominas\",\"Parnamirim\",\"Parnaíba\",\"Passos\",\"Paulista\",\"Paulo Afonso\",\"Paço Do Lumiar\",\"Petrolina\",\"Pindamonhangaba\",\"Piracicaba\",\"Ponta Grossa\",\"Porto Alegre\",\"Porto Seguro\",\"Porto Velho\",\"Praia Grande\",\"Presidente Prudente\",\"Resende\",\"Ribeirão Das Neves\",\"Rio Das Ostras\",\"Rondonópolis\",\"Sabará\",\"Santa Bárbara D'oeste\",\"Santa Rita\",\"Santo André\",\"Santo Antônio De Jesus\",\"Santos\",\"Sertãozinho\",\"Simões Filho\",\"Sobral\",\"Sorocaba\",\"São Bernardo Do Campo\",\"São Carlos\",\"São Gonçalo Do Amarante\",\"São José\",\"São José Dos Pinhais\",\"São Lourenço Da Mata\",\"São Pedro Da Aldeia\",\"São Vicente\",\"Tailândia\",\"Tangará Da Serra\",\"Teófilo Otoni\",\"Timon\",\"Toledo\",\"Três Lagoas\",\"Ubá\",\"Valparaíso De Goiás\",\"Vilhena\",\"Volta Redonda\",\"Várzea Grande\",\"Abaetetuba\",\"Alagoinhas\",\"Altamira\",\"Ananindeua\",\"Aparecida De Goiânia\",\"Aracaju\",\"Araguari\",\"Araguaína\",\"Araraquara\",\"Barreiras\",\"Belo Horizonte\",\"Belém\",\"Boa Vista\",\"Bragança\",\"Brasília\",\"Cametá\",\"Campinas\",\"Campo Grande\",\"Campos Dos Goytacazes\",\"Castanhal\",\"Catalão\",\"Caucaia\",\"Caxias\",\"Coronel Fabriciano\",\"Crato\",\"Cuiabá\",\"Diadema\",\"Duque De Caxias\",\"Feira De Santana\",\"Fortaleza\",\"Foz Do Iguaçu\",\"Goiânia\",\"Governador Valadares\",\"Guarapari\",\"Igarassu\",\"Iguatu\",\"Imperatriz\",\"Ipatinga\",\"Itaituba\",\"Itapipoca\",\"João Pessoa\",\"Juiz De Fora\",\"Linhares\",\"Londrina\",\"Luziânia\",\"Macapá\",\"Macaé\",\"Manacapuru\",\"Manaus\",\"Marabá\",\"Maracanaú\",\"Marituba\",\"Mogi Das Cruzes\",\"Mossoró\",\"Natal\",\"Nilópolis\",\"Niterói\",\"Nova Iguaçu\",\"Nova Lima\",\"Palmas\",\"Parauapebas\",\"Parintins\",\"Patos\",\"Patos De Minas\",\"Paulínia\",\"Petrópolis\",\"Recife\",\"Ribeirão Preto\",\"Rio Branco\",\"Rio Claro\",\"Rio De Janeiro\",\"Rio Verde\",\"Salvador\",\"Santa Luzia\",\"Santana\",\"Santarém\",\"Senador Canedo\",\"Sinop\",\"Sumaré\",\"São Félix Do Xingu\",\"São Gonçalo\",\"São José De Ribamar\",\"São José Do Rio Preto\",\"São José Dos Campos\",\"São João De Meriti\",\"São Luís\",\"São Paulo\",\"Taubaté\",\"Teresina\",\"Trindade\",\"Tucuruí\",\"Uberaba\",\"Uberlândia\",\"Varginha\",\"Vespasiano\",\"Vitória Da Conquista\",\"Vitória De Santo Antão\",\"Alvorada\",\"Aracruz\",\"Bagé\",\"Bento Gonçalves\",\"Breves\",\"Cachoeiro De Itapemirim\",\"Campo Largo\",\"Cariacica\",\"Colatina\",\"Erechim\",\"Fazenda Rio Grande\",\"Gravataí\",\"Guarapuava\",\"Lages\",\"Pelotas\",\"Piraquara\",\"Santa Cruz Do Sul\",\"Sapucaia Do Sul\",\"Serra\",\"São Leopoldo\",\"São Mateus\",\"Tubarão\",\"Valença\",\"Vila Velha\",\"Vitória\",\"Apucarana\",\"Araucária\",\"Barbacena\",\"Barra Do Piraí\",\"Bayeux\",\"Botucatu\",\"Cachoeirinha\",\"Caieiras\",\"Canoas\",\"Carapicuíba\",\"Caxias Do Sul\",\"Codó\",\"Colombo\",\"Cotia\",\"Criciúma\",\"Florianópolis\",\"Franco Da Rocha\",\"Ibirité\",\"Indaiatuba\",\"Itajaí\",\"Itanhaém\",\"Itapetininga\",\"Joinville\",\"Leme\",\"Mairiporã\",\"Nossa Senhora Do Socorro\",\"Novo Hamburgo\",\"Paranaguá\",\"Passo Fundo\",\"Pinhais\",\"Poços De Caldas\",\"Ribeirão Pires\",\"Rio Grande\",\"Salto\",\"Santa Maria\",\"Tatuí\",\"Teixeira De Freitas\",\"Umuarama\",\"Uruguaiana\",\"Votorantim\",\"Várzea Paulista\",\"Almirante Tamandaré\",\"Arapongas\",\"Araras\",\"Balneário Camboriú\",\"Barra Mansa\",\"Birigui\",\"Blumenau\",\"Bragança Paulista\",\"Brusque\",\"Cambé\",\"Caraguatatuba\",\"Caruaru\",\"Cascavel\",\"Chapecó\",\"Conselheiro Lafaiete\",\"Divinópolis\",\"Ferraz De Vasconcelos\",\"Guaratinguetá\",\"Guaíba\",\"Itaguaí\",\"Itu\",\"Jandira\",\"Jaraguá Do Sul\",\"Jaú\",\"Maranguape\",\"Mauá\",\"Nova Friburgo\",\"Novo Gama\",\"Palhoça\",\"Pouso Alegre\",\"Poá\",\"Queimados\",\"Santa Cruz Do Capibaribe\",\"Santana De Parnaíba\",\"Sarandi\",\"Sete Lagoas\",\"Suzano\",\"São Caetano Do Sul\",\"Taboão Da Serra\",\"Teresópolis\",\"Valinhos\",\"Viamão\",\"Águas Lindas De Goiás\"],[\"PE\",\"SP\",\"RJ\",\"GO\",\"AL\",\"RJ\",\"MG\",\"SP\",\"RO\",\"SP\",\"SP\",\"MA\",\"MA\",\"PA\",\"SP\",\"SP\",\"SP\",\"RJ\",\"MG\",\"PE\",\"RJ\",\"PE\",\"BA\",\"PB\",\"SP\",\"MG\",\"MS\",\"SP\",\"PR\",\"MS\",\"SP\",\"BA\",\"GO\",\"SP\",\"SP\",\"PE\",\"SP\",\"SP\",\"SP\",\"BA\",\"SE\",\"MG\",\"RJ\",\"BA\",\"AM\",\"SP\",\"RJ\",\"SP\",\"SP\",\"SP\",\"MG\",\"GO\",\"PE\",\"SP\",\"RJ\",\"GO\",\"BA\",\"RO\",\"BA\",\"CE\",\"SP\",\"SE\",\"BA\",\"MG\",\"SP\",\"AL\",\"RJ\",\"RJ\",\"PR\",\"SP\",\"RJ\",\"SP\",\"MG\",\"MG\",\"MG\",\"PE\",\"SP\",\"SP\",\"PA\",\"RN\",\"PI\",\"MG\",\"PE\",\"BA\",\"MA\",\"PE\",\"SP\",\"SP\",\"PR\",\"RS\",\"BA\",\"RO\",\"SP\",\"SP\",\"RJ\",\"MG\",\"RJ\",\"MT\",\"MG\",\"SP\",\"PB\",\"SP\",\"BA\",\"SP\",\"SP\",\"BA\",\"CE\",\"SP\",\"SP\",\"SP\",\"RN\",\"SC\",\"PR\",\"PE\",\"RJ\",\"SP\",\"PA\",\"MT\",\"MG\",\"MA\",\"PR\",\"MS\",\"MG\",\"GO\",\"RO\",\"RJ\",\"MT\",\"PA\",\"BA\",\"PA\",\"PA\",\"GO\",\"SE\",\"MG\",\"TO\",\"SP\",\"BA\",\"MG\",\"PA\",\"RR\",\"PA\",\"DF\",\"PA\",\"SP\",\"MS\",\"RJ\",\"PA\",\"GO\",\"CE\",\"MA\",\"MG\",\"CE\",\"MT\",\"SP\",\"RJ\",\"BA\",\"CE\",\"PR\",\"GO\",\"MG\",\"ES\",\"PE\",\"CE\",\"MA\",\"MG\",\"PA\",\"CE\",\"PB\",\"MG\",\"ES\",\"PR\",\"GO\",\"AP\",\"RJ\",\"AM\",\"AM\",\"PA\",\"CE\",\"PA\",\"SP\",\"RN\",\"RN\",\"RJ\",\"RJ\",\"RJ\",\"MG\",\"TO\",\"PA\",\"AM\",\"PB\",\"MG\",\"SP\",\"RJ\",\"PE\",\"SP\",\"AC\",\"SP\",\"RJ\",\"GO\",\"BA\",\"MG\",\"AP\",\"PA\",\"GO\",\"MT\",\"SP\",\"PA\",\"RJ\",\"MA\",\"SP\",\"SP\",\"RJ\",\"MA\",\"SP\",\"SP\",\"PI\",\"GO\",\"PA\",\"MG\",\"MG\",\"MG\",\"MG\",\"BA\",\"PE\",\"RS\",\"ES\",\"RS\",\"RS\",\"PA\",\"ES\",\"PR\",\"ES\",\"ES\",\"RS\",\"PR\",\"RS\",\"PR\",\"SC\",\"RS\",\"PR\",\"RS\",\"RS\",\"ES\",\"RS\",\"ES\",\"SC\",\"BA\",\"ES\",\"ES\",\"PR\",\"PR\",\"MG\",\"RJ\",\"PB\",\"SP\",\"RS\",\"SP\",\"RS\",\"SP\",\"RS\",\"MA\",\"PR\",\"SP\",\"SC\",\"SC\",\"SP\",\"MG\",\"SP\",\"SC\",\"SP\",\"SP\",\"SC\",\"SP\",\"SP\",\"SE\",\"RS\",\"PR\",\"RS\",\"PR\",\"MG\",\"SP\",\"RS\",\"SP\",\"RS\",\"SP\",\"BA\",\"PR\",\"RS\",\"SP\",\"SP\",\"PR\",\"PR\",\"SP\",\"SC\",\"RJ\",\"SP\",\"SC\",\"SP\",\"SC\",\"PR\",\"SP\",\"PE\",\"PR\",\"SC\",\"MG\",\"MG\",\"SP\",\"SP\",\"RS\",\"RJ\",\"SP\",\"SP\",\"SC\",\"SP\",\"CE\",\"SP\",\"RJ\",\"GO\",\"SC\",\"MG\",\"SP\",\"RJ\",\"PE\",\"SP\",\"PR\",\"MG\",\"SP\",\"SP\",\"SP\",\"RJ\",\"SP\",\"RS\",\"GO\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>group<\\/th>\\n      <th>name_muni<\\/th>\\n      <th>abbrev_state<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = uf_sf, fill = \"lightgray\", color = \"grey20\", size=.15, show.legend = FALSE) +\n  geom_sf(data = m_cluster_ids, aes(color = group), size = 2) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_clim_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: CentOS Linux 7 (Core)\n\nMatrix products: default\nBLAS/LAPACK: /home/raphaelfs/miniconda3/envs/quarto/lib/libopenblasp-r0.3.25.so;  LAPACK version 3.11.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=pt_BR.UTF-8        LC_COLLATE=pt_BR.UTF-8    \n [5] LC_MONETARY=pt_BR.UTF-8    LC_MESSAGES=pt_BR.UTF-8   \n [7] LC_PAPER=pt_BR.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=pt_BR.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/Sao_Paulo\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.28          sf_1.0-14        tictoc_1.2       kableExtra_1.3.4\n [5] dtwclust_5.5.12  dtw_1.23-1       proxy_0.4-27     timetk_2.8.2    \n [9] arrow_12.0.0     lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0   \n[13] dplyr_1.1.2      purrr_1.0.1      readr_2.1.4      tidyr_1.3.0     \n[17] tibble_3.2.1     ggplot2_3.4.2    tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rstudioapi_0.14     jsonlite_1.8.5      wk_0.7.3           \n  [4] magrittr_2.0.3      modeltools_0.2-23   farver_2.1.1       \n  [7] rmarkdown_2.22      vctrs_0.6.3         webshot_0.5.4      \n [10] htmltools_0.5.5     dials_1.2.0         curl_5.0.2         \n [13] s2_1.1.4            sass_0.4.6          parallelly_1.36.0  \n [16] KernSmooth_2.23-21  bslib_0.4.2         htmlwidgets_1.6.2  \n [19] plyr_1.8.8          cachem_1.0.8        zoo_1.8-12         \n [22] mime_0.12           lifecycle_1.0.3     iterators_1.0.14   \n [25] pkgconfig_2.0.3     Matrix_1.5-4.1      R6_2.5.1           \n [28] fastmap_1.1.1       future_1.32.0       shiny_1.7.4        \n [31] tune_1.1.2          clue_0.3-64         digest_0.6.31      \n [34] colorspace_2.1-0    furrr_0.3.1         RSpectra_0.16-1    \n [37] crosstalk_1.2.0     labeling_0.4.2      fansi_1.0.4        \n [40] yardstick_1.2.0     timechange_0.2.0    httr_1.4.6         \n [43] compiler_4.3.2      bit64_4.0.5         withr_2.5.0        \n [46] DBI_1.1.3           MASS_7.3-60         lava_1.7.2.1       \n [49] classInt_0.4-9      tools_4.3.2         units_0.8-2        \n [52] httpuv_1.6.11       flexclust_1.4-1     future.apply_1.11.0\n [55] nnet_7.3-19         glue_1.6.2          promises_1.2.0.1   \n [58] grid_4.3.2          cluster_2.1.4       reshape2_1.4.4     \n [61] generics_0.1.3      recipes_1.0.6       gtable_0.3.3       \n [64] tzdb_0.4.0          class_7.3-22        data.table_1.14.8  \n [67] hms_1.1.3           rsample_1.2.0       xml2_1.3.4         \n [70] utf8_1.2.3          ggrepel_0.9.3       geobr_1.8.1        \n [73] foreach_1.5.2       pillar_1.9.0        later_1.3.1        \n [76] splines_4.3.2       lhs_1.1.6           lattice_0.21-8     \n [79] survival_3.5-5      bit_4.0.5           tidyselect_1.2.0   \n [82] knitr_1.43          svglite_2.1.1       stats4_4.3.2       \n [85] xfun_0.39           hardhat_1.3.0       timeDate_4022.108  \n [88] stringi_1.7.12      DiceDesign_1.9      yaml_2.3.7         \n [91] workflows_1.1.3     evaluate_0.21       codetools_0.2-19   \n [94] cli_3.6.1           RcppParallel_5.1.7  rpart_4.1.19       \n [97] xtable_1.8-4        systemfonts_1.0.4   jquerylib_0.1.4    \n[100] munsell_0.5.0       Rcpp_1.0.10         globals_0.16.2     \n[103] parallel_4.3.2      ellipsis_0.3.2      gower_1.0.1        \n[106] assertthat_0.2.1    parsnip_1.1.0       GPfit_1.0-8        \n[109] listenv_0.9.0       viridisLite_0.4.2   ipred_0.9-13       \n[112] scales_1.2.1        xts_0.13.1          prodlim_2019.11.13 \n[115] e1071_1.7-13        rlang_1.1.1         rvest_1.0.3        \n[118] shinyjs_2.1.0      \n```\n:::\n:::\n",
    "supporting": [
      "cluster_multivariate_clim_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.28/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}