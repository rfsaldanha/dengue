{
  "hash": "be777e52473acada7100811689b264ba",
  "result": {
    "markdown": "---\ntitle: \"Cases and climate variables multivariate clustering\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering climate indicators with multivariate clustering techniques.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nlibrary(sf)\nlibrary(DT)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nDaily, scaled cases, maximum temperature, minimum temperature and precipitation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n  select(mun, date, cases, tmax, tmin, prec) %>%\n  collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 163326      6\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(unique(tdengue$mun))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 326\n```\n:::\n:::\n\n\nData for maps.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuf_sf <- geobr::read_state(showProgress = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n```{.r .cell-code}\ncoords <- geobr::read_municipality(showProgress = FALSE) %>%\n  st_make_valid() %>%\n  st_centroid()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n:::\n:::\n\n\n## Prepare data\n\nFor clustering, the data must be a list of data frames with climate data and without date.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngdengue <- tdengue %>%\n  group_by(mun) %>%\n  arrange(date) %>%\n  select(-date)\n\nmdengue <- group_split(gdengue, .keep = FALSE) %>%\n  tslist(simplify = TRUE)\n\nnames(mdengue) <- group_keys(gdengue)$mun\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(mdengue[1:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 3\n $ 110002: num [1:501, 1:4] -0.5104 0.668 0.668 0.0788 0.668 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n $ 110012: num [1:501, 1:4] -0.4493 0.6488 1.1979 0.0997 0.0997 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n $ 110020: num [1:501, 1:4] -0.5195 0.1563 0.0718 -0.1816 0.3253 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n```\n:::\n:::\n\n\n## DTW clustering\n\nTry from 3 to 20 partitions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nstdw_clust <- tsclust(\n  series = mdengue, \n  type = \"partitional\", k = 3:20, \n  distance = \"dtw_basic\", \n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n13.926 sec elapsed\n```\n:::\n:::\n\n\n### Cluster Validity Indices (CVI)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(stdw_clust) <- paste0(\"k_\", 3:20)\nres_cvi <- sapply(stdw_clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\ndatatable(res_cvi)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-2228f0057e4179a1f21e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2228f0057e4179a1f21e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\"],[\"k_6\",\"k_5\",\"k_14\",\"k_4\",\"k_11\",\"k_15\",\"k_10\",\"k_3\",\"k_19\",\"k_8\",\"k_20\",\"k_17\",\"k_9\",\"k_18\",\"k_16\",\"k_12\",\"k_13\",\"k_7\"],[0.1530297469356477,0.1440762044713745,0.1400584225015963,0.1354547579634003,0.1208323157407356,0.1105893378279768,0.1095486174706609,0.1094875020359826,0.1089257116601769,0.09797794633096432,0.09210995555770808,0.09154821081714312,0.08908547609352244,0.08260358364305846,0.08129072667558394,0.07136656410796276,0.06131959166201611,0.03334285681935422],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[66.03871539724065,70.83730006839602,31.05107538599962,73.72133754541019,36.74893705232316,28.20357775100776,37.92326564538576,132.799072097871,23.39248613274816,46.02250861410634,22.58194920998412,26.34562406898972,41.3226490792125,23.70068122356517,25.71442726657208,34.46339975166363,32.37456572009118,39.47010817257704],[2.016717468165261,1.939575756275471,1.569492045784807,1.80846374856984,1.796855644968916,1.82821826051781,1.95121179376399,1.799833628541421,1.807197655292344,2.345528320027988,1.722026296063557,1.938822173588695,2.109041983689778,2.018107368640858,1.794717064569474,2.306726907779244,2.044140737665228,2.491651988726502],[2.831176268818642,2.347999367208251,1.951876574122824,1.819376903904833,2.284181270249329,2.69986132475828,2.646232116412836,1.876632643543888,2.300494532526559,3.133500281328306,2.29180932440963,2.597457610600983,2.915782300990952,2.656927220913814,2.672091378347231,2.968123486807218,2.857604373450767,2.757466387210257],[0.06404119331825649,0.05293480520822988,0.07478527348838045,0.07474487852441768,0.06461003914169353,0.09877742552571456,0.09261909518077052,0.05288796621815163,0.1010807627526162,0.06404119331825649,0.1020234877438586,0.07528597865196485,0.06974269565671985,0.05311861964957065,0.06407529214486364,0.0469497174971813,0.04481128132921332,0.05903396603380133],[0.2750364644880977,0.29375881890079,0.2368916791190641,0.3655863370523117,0.2495944625836389,0.2381982078210064,0.251850261562682,0.3672949506522975,0.2234764172064207,0.2688587067005322,0.2203517930010253,0.2249012289596225,0.2632677092874243,0.2320771535639892,0.2380825819007399,0.2470739370001668,0.2455732801168612,0.3216543774674874]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>k<\\/th>\\n      <th>Sil<\\/th>\\n      <th>SF<\\/th>\\n      <th>CH<\\/th>\\n      <th>DB<\\/th>\\n      <th>DBstar<\\/th>\\n      <th>D<\\/th>\\n      <th>COP<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"k\",\"targets\":1},{\"name\":\"Sil\",\"targets\":2},{\"name\":\"SF\",\"targets\":3},{\"name\":\"CH\",\"targets\":4},{\"name\":\"DB\",\"targets\":5},{\"name\":\"DBstar\",\"targets\":6},{\"name\":\"D\",\"targets\":7},{\"name\":\"COP\",\"targets\":8}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_sel_clust <- stdw_clust[[res_cvi[[1,1]]]]\n\nplot(m_sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_all_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Partitions size\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(m_sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1  2  3  4  5  6 \n91 48 84 47 27 29 \n```\n:::\n:::\n\n\n### Partition results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoords <- coords %>%\n  mutate(code_muni = substr(code_muni, 0, 6))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids <- tibble(\n  code_muni = names(mdengue),\n  group = as.character(m_sel_clust@cluster)\n) %>% \n  left_join(coords, by = \"code_muni\") %>%\n  arrange(group, name_muni) %>%\n  st_as_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(object = m_cluster_ids, file = \"m_cluster_ids.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids %>%\n  select(group, name_muni, abbrev_state) %>%\n  arrange(group, name_muni) %>%\n  st_drop_geometry() %>%\n  datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-0a0473e6474226addf1e\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0a0473e6474226addf1e\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\"],[\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\"],[\"Abaetetuba\",\"Alagoinhas\",\"Altamira\",\"Ananindeua\",\"Aparecida De Goiânia\",\"Aracaju\",\"Araguari\",\"Araguaína\",\"Araraquara\",\"Barreiras\",\"Belo Horizonte\",\"Belém\",\"Boa Vista\",\"Bragança\",\"Brasília\",\"Cametá\",\"Campo Grande\",\"Campos Dos Goytacazes\",\"Castanhal\",\"Catalão\",\"Caucaia\",\"Caxias\",\"Coronel Fabriciano\",\"Crato\",\"Cuiabá\",\"Duque De Caxias\",\"Feira De Santana\",\"Fortaleza\",\"Foz Do Iguaçu\",\"Goiânia\",\"Governador Valadares\",\"Guarapari\",\"Igarassu\",\"Iguatu\",\"Imperatriz\",\"Ipatinga\",\"Itaituba\",\"Itapipoca\",\"João Pessoa\",\"Juiz De Fora\",\"Linhares\",\"Londrina\",\"Luziânia\",\"Macapá\",\"Macaé\",\"Manaus\",\"Marabá\",\"Maracanaú\",\"Marituba\",\"Mossoró\",\"Natal\",\"Nilópolis\",\"Niterói\",\"Nova Iguaçu\",\"Palmas\",\"Parauapebas\",\"Parintins\",\"Patos\",\"Patos De Minas\",\"Petrópolis\",\"Recife\",\"Ribeirão Preto\",\"Rio Branco\",\"Rio Claro\",\"Rio De Janeiro\",\"Rio Verde\",\"Salvador\",\"Santa Luzia\",\"Santana\",\"Santarém\",\"Senador Canedo\",\"Sinop\",\"Sumaré\",\"São Félix Do Xingu\",\"São Gonçalo\",\"São José De Ribamar\",\"São José Do Rio Preto\",\"São José Dos Campos\",\"São João De Meriti\",\"São Luís\",\"São Paulo\",\"Taubaté\",\"Teresina\",\"Trindade\",\"Tucuruí\",\"Uberaba\",\"Uberlândia\",\"Varginha\",\"Vespasiano\",\"Vitória Da Conquista\",\"Vitória De Santo Antão\",\"Araruama\",\"Ariquemes\",\"Bagé\",\"Barcarena\",\"Barretos\",\"Belford Roxo\",\"Cabo Frio\",\"Campina Grande\",\"Corumbá\",\"Cubatão\",\"Eunápolis\",\"Formosa\",\"Garanhuns\",\"Itaboraí\",\"Itaperuna\",\"Ituiutaba\",\"Itumbiara\",\"Japeri\",\"Jequié\",\"Juazeiro Do Norte\",\"Lagarto\",\"Magé\",\"Maricá\",\"Maringá\",\"Mesquita\",\"Montes Claros\",\"Nova Serrana\",\"Paragominas\",\"Porto Seguro\",\"Porto Velho\",\"Praia Grande\",\"Ribeirão Das Neves\",\"Rio Das Ostras\",\"Rondonópolis\",\"Sabará\",\"Santo Antônio De Jesus\",\"Santos\",\"Simões Filho\",\"São Pedro Da Aldeia\",\"São Vicente\",\"Tailândia\",\"Tangará Da Serra\",\"Teófilo Otoni\",\"Toledo\",\"Três Lagoas\",\"Ubá\",\"Uruguaiana\",\"Vilhena\",\"Abreu E Lima\",\"Americana\",\"Angra Dos Reis\",\"Anápolis\",\"Arapiraca\",\"Araxá\",\"Araçatuba\",\"Assis\",\"Atibaia\",\"Açailândia\",\"Bacabal\",\"Barueri\",\"Bauru\",\"Betim\",\"Cabo De Santo Agostinho\",\"Camaragibe\",\"Camaçari\",\"Campinas\",\"Catanduva\",\"Contagem\",\"Curitiba\",\"Diadema\",\"Dourados\",\"Embu\",\"Franca\",\"Francisco Morato\",\"Guarujá\",\"Guarulhos\",\"Hortolândia\",\"Ilhéus\",\"Itabira\",\"Itabuna\",\"Itacoatiara\",\"Itapecerica Da Serra\",\"Itapevi\",\"Itaquaquecetuba\",\"Itatiba\",\"Jaboatão Dos Guararapes\",\"Jacareí\",\"Jataí\",\"Ji-Paraná\",\"Juazeiro\",\"Jundiaí\",\"Lauro De Freitas\",\"Lavras\",\"Limeira\",\"Maceió\",\"Marília\",\"Mogi Das Cruzes\",\"Mogi Guaçu\",\"Muriaé\",\"Olinda\",\"Osasco\",\"Ourinhos\",\"Parnamirim\",\"Parnaíba\",\"Passos\",\"Paulista\",\"Paulo Afonso\",\"Paulínia\",\"Paço Do Lumiar\",\"Petrolina\",\"Pindamonhangaba\",\"Piracicaba\",\"Ponta Grossa\",\"Porto Alegre\",\"Presidente Prudente\",\"Resende\",\"Santa Bárbara D'oeste\",\"Santa Rita\",\"Santo André\",\"Sertãozinho\",\"Sobral\",\"Sorocaba\",\"São Bernardo Do Campo\",\"São Carlos\",\"São Gonçalo Do Amarante\",\"São José\",\"São José Dos Pinhais\",\"São Lourenço Da Mata\",\"Timon\",\"Valparaíso De Goiás\",\"Volta Redonda\",\"Várzea Grande\",\"Apucarana\",\"Araucária\",\"Balneário Camboriú\",\"Barbacena\",\"Barra Do Piraí\",\"Botucatu\",\"Brusque\",\"Cachoeirinha\",\"Caieiras\",\"Caraguatatuba\",\"Carapicuíba\",\"Caxias Do Sul\",\"Codó\",\"Colombo\",\"Conselheiro Lafaiete\",\"Cotia\",\"Criciúma\",\"Florianópolis\",\"Franco Da Rocha\",\"Guaratinguetá\",\"Ibirité\",\"Indaiatuba\",\"Itajaí\",\"Itanhaém\",\"Itapetininga\",\"Jaraguá Do Sul\",\"Joinville\",\"Leme\",\"Nossa Senhora Do Socorro\",\"Novo Hamburgo\",\"Palhoça\",\"Passo Fundo\",\"Pinhais\",\"Poços De Caldas\",\"Queimados\",\"Ribeirão Pires\",\"Rio Grande\",\"Salto\",\"Santa Maria\",\"Santana De Parnaíba\",\"Taboão Da Serra\",\"Teixeira De Freitas\",\"Umuarama\",\"Viamão\",\"Votorantim\",\"Várzea Paulista\",\"Águas Lindas De Goiás\",\"Alvorada\",\"Aracruz\",\"Bento Gonçalves\",\"Breves\",\"Cachoeiro De Itapemirim\",\"Campo Largo\",\"Canoas\",\"Cariacica\",\"Colatina\",\"Erechim\",\"Fazenda Rio Grande\",\"Gravataí\",\"Guarapuava\",\"Lages\",\"Mairiporã\",\"Paranaguá\",\"Pelotas\",\"Piraquara\",\"Santa Cruz Do Sul\",\"Sapucaia Do Sul\",\"Serra\",\"São Leopoldo\",\"São Mateus\",\"Tatuí\",\"Tubarão\",\"Vila Velha\",\"Vitória\",\"Almirante Tamandaré\",\"Arapongas\",\"Araras\",\"Barra Mansa\",\"Birigui\",\"Blumenau\",\"Bragança Paulista\",\"Cambé\",\"Caruaru\",\"Cascavel\",\"Chapecó\",\"Divinópolis\",\"Ferraz De Vasconcelos\",\"Itaguaí\",\"Itu\",\"Jandira\",\"Jaú\",\"Maranguape\",\"Mauá\",\"Nova Friburgo\",\"Novo Gama\",\"Pouso Alegre\",\"Poá\",\"Santa Cruz Do Capibaribe\",\"Sete Lagoas\",\"Suzano\",\"São Caetano Do Sul\",\"Teresópolis\",\"Valinhos\"],[\"PA\",\"BA\",\"PA\",\"PA\",\"GO\",\"SE\",\"MG\",\"TO\",\"SP\",\"BA\",\"MG\",\"PA\",\"RR\",\"PA\",\"DF\",\"PA\",\"MS\",\"RJ\",\"PA\",\"GO\",\"CE\",\"MA\",\"MG\",\"CE\",\"MT\",\"RJ\",\"BA\",\"CE\",\"PR\",\"GO\",\"MG\",\"ES\",\"PE\",\"CE\",\"MA\",\"MG\",\"PA\",\"CE\",\"PB\",\"MG\",\"ES\",\"PR\",\"GO\",\"AP\",\"RJ\",\"AM\",\"PA\",\"CE\",\"PA\",\"RN\",\"RN\",\"RJ\",\"RJ\",\"RJ\",\"TO\",\"PA\",\"AM\",\"PB\",\"MG\",\"RJ\",\"PE\",\"SP\",\"AC\",\"SP\",\"RJ\",\"GO\",\"BA\",\"MG\",\"AP\",\"PA\",\"GO\",\"MT\",\"SP\",\"PA\",\"RJ\",\"MA\",\"SP\",\"SP\",\"RJ\",\"MA\",\"SP\",\"SP\",\"PI\",\"GO\",\"PA\",\"MG\",\"MG\",\"MG\",\"MG\",\"BA\",\"PE\",\"RJ\",\"RO\",\"RS\",\"PA\",\"SP\",\"RJ\",\"RJ\",\"PB\",\"MS\",\"SP\",\"BA\",\"GO\",\"PE\",\"RJ\",\"RJ\",\"MG\",\"GO\",\"RJ\",\"BA\",\"CE\",\"SE\",\"RJ\",\"RJ\",\"PR\",\"RJ\",\"MG\",\"MG\",\"PA\",\"BA\",\"RO\",\"SP\",\"MG\",\"RJ\",\"MT\",\"MG\",\"BA\",\"SP\",\"BA\",\"RJ\",\"SP\",\"PA\",\"MT\",\"MG\",\"PR\",\"MS\",\"MG\",\"RS\",\"RO\",\"PE\",\"SP\",\"RJ\",\"GO\",\"AL\",\"MG\",\"SP\",\"SP\",\"SP\",\"MA\",\"MA\",\"SP\",\"SP\",\"MG\",\"PE\",\"PE\",\"BA\",\"SP\",\"SP\",\"MG\",\"PR\",\"SP\",\"MS\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"BA\",\"MG\",\"BA\",\"AM\",\"SP\",\"SP\",\"SP\",\"SP\",\"PE\",\"SP\",\"GO\",\"RO\",\"BA\",\"SP\",\"BA\",\"MG\",\"SP\",\"AL\",\"SP\",\"SP\",\"SP\",\"MG\",\"PE\",\"SP\",\"SP\",\"RN\",\"PI\",\"MG\",\"PE\",\"BA\",\"SP\",\"MA\",\"PE\",\"SP\",\"SP\",\"PR\",\"RS\",\"SP\",\"RJ\",\"SP\",\"PB\",\"SP\",\"SP\",\"CE\",\"SP\",\"SP\",\"SP\",\"RN\",\"SC\",\"PR\",\"PE\",\"MA\",\"GO\",\"RJ\",\"MT\",\"PR\",\"PR\",\"SC\",\"MG\",\"RJ\",\"SP\",\"SC\",\"RS\",\"SP\",\"SP\",\"SP\",\"RS\",\"MA\",\"PR\",\"MG\",\"SP\",\"SC\",\"SC\",\"SP\",\"SP\",\"MG\",\"SP\",\"SC\",\"SP\",\"SP\",\"SC\",\"SC\",\"SP\",\"SE\",\"RS\",\"SC\",\"RS\",\"PR\",\"MG\",\"RJ\",\"SP\",\"RS\",\"SP\",\"RS\",\"SP\",\"SP\",\"BA\",\"PR\",\"RS\",\"SP\",\"SP\",\"GO\",\"RS\",\"ES\",\"RS\",\"PA\",\"ES\",\"PR\",\"RS\",\"ES\",\"ES\",\"RS\",\"PR\",\"RS\",\"PR\",\"SC\",\"SP\",\"PR\",\"RS\",\"PR\",\"RS\",\"RS\",\"ES\",\"RS\",\"ES\",\"SP\",\"SC\",\"ES\",\"ES\",\"PR\",\"PR\",\"SP\",\"RJ\",\"SP\",\"SC\",\"SP\",\"PR\",\"PE\",\"PR\",\"SC\",\"MG\",\"SP\",\"RJ\",\"SP\",\"SP\",\"SP\",\"CE\",\"SP\",\"RJ\",\"GO\",\"MG\",\"SP\",\"PE\",\"MG\",\"SP\",\"SP\",\"RJ\",\"SP\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>group<\\/th>\\n      <th>name_muni<\\/th>\\n      <th>abbrev_state<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"group\",\"targets\":1},{\"name\":\"name_muni\",\"targets\":2},{\"name\":\"abbrev_state\",\"targets\":3}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = uf_sf, fill = \"lightgray\", color = \"grey20\", size=.15, show.legend = FALSE) +\n  geom_sf(data = m_cluster_ids, aes(color = group), size = 2, alpha = 0.7) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_all_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 22.04.3 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Europe/Paris\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.31          sf_1.0-15        tictoc_1.2       kableExtra_1.4.0\n [5] dtwclust_5.5.12  dtw_1.23-1       proxy_0.4-27     timetk_2.9.0    \n [9] arrow_14.0.0.2   lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1   \n[13] dplyr_1.1.4      purrr_1.0.2      readr_2.1.5      tidyr_1.3.1     \n[17] tibble_3.2.1     ggplot2_3.4.4    tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rstudioapi_0.15.0   jsonlite_1.8.8      wk_0.9.1           \n  [4] magrittr_2.0.3      modeltools_0.2-23   farver_2.1.1       \n  [7] rmarkdown_2.25      vctrs_0.6.5         htmltools_0.5.7    \n [10] dials_1.2.0         curl_5.2.0          s2_1.1.6           \n [13] sass_0.4.8          parallelly_1.36.0   KernSmooth_2.23-22 \n [16] bslib_0.6.1         htmlwidgets_1.6.4   plyr_1.8.9         \n [19] cachem_1.0.8        zoo_1.8-12          mime_0.12          \n [22] lifecycle_1.0.4     iterators_1.0.14    pkgconfig_2.0.3    \n [25] Matrix_1.6-3        R6_2.5.1            fastmap_1.1.1      \n [28] future_1.33.1       shiny_1.8.0         tune_1.1.2         \n [31] clue_0.3-65         digest_0.6.34       colorspace_2.1-0   \n [34] furrr_0.3.1         RSpectra_0.16-1     crosstalk_1.2.1    \n [37] labeling_0.4.3      fansi_1.0.6         yardstick_1.3.0    \n [40] timechange_0.3.0    httr_1.4.7          compiler_4.3.2     \n [43] bit64_4.0.5         withr_3.0.0         DBI_1.2.1          \n [46] MASS_7.3-60         lava_1.7.3          classInt_0.4-10    \n [49] tools_4.3.2         units_0.8-5         httpuv_1.6.14      \n [52] flexclust_1.4-1     future.apply_1.11.1 nnet_7.3-19        \n [55] glue_1.7.0          promises_1.2.1      grid_4.3.2         \n [58] cluster_2.1.6       reshape2_1.4.4      generics_0.1.3     \n [61] recipes_1.0.9       gtable_0.3.4        tzdb_0.4.0         \n [64] class_7.3-22        data.table_1.14.10  hms_1.1.3          \n [67] rsample_1.2.0       xml2_1.3.6          utf8_1.2.4         \n [70] ggrepel_0.9.5       geobr_1.8.2         foreach_1.5.2      \n [73] pillar_1.9.0        later_1.3.2         splines_4.3.2      \n [76] lhs_1.1.6           lattice_0.22-5      survival_3.5-7     \n [79] bit_4.0.5           tidyselect_1.2.0    knitr_1.45         \n [82] svglite_2.1.3       stats4_4.3.2        xfun_0.41          \n [85] hardhat_1.3.0       timeDate_4032.109   stringi_1.8.3      \n [88] DiceDesign_1.10     yaml_2.3.8          workflows_1.1.3    \n [91] evaluate_0.23       codetools_0.2-19    cli_3.6.2          \n [94] RcppParallel_5.1.7  rpart_4.1.23        xtable_1.8-4       \n [97] systemfonts_1.0.5   munsell_0.5.0       jquerylib_0.1.4    \n[100] Rcpp_1.0.12         globals_0.16.2      parallel_4.3.2     \n[103] ellipsis_0.3.2      gower_1.0.1         assertthat_0.2.1   \n[106] parsnip_1.1.1       GPfit_1.0-8         listenv_0.9.0      \n[109] viridisLite_0.4.2   ipred_0.9-14        scales_1.3.0       \n[112] xts_0.13.2          prodlim_2023.08.28  e1071_1.7-14       \n[115] rlang_1.1.3         shinyjs_2.1.0      \n```\n:::\n:::\n",
    "supporting": [
      "cluster_multivariate_all_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.31/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}