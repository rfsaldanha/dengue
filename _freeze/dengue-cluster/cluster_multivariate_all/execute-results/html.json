{
  "hash": "be777e52473acada7100811689b264ba",
  "result": {
    "markdown": "---\ntitle: \"Cases and climate variables multivariate clustering\"\nauthor: Raphael Saldanha\ndate: last-modified\n---\n\n\nThis notebook aims to cluster the Brazilian municipalities considering climate indicators with multivariate clustering techniques.\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(arrow)\nlibrary(timetk)\nlibrary(dtwclust)\nlibrary(kableExtra)\nlibrary(tictoc)\nlibrary(sf)\nlibrary(DT)\nsource(\"../functions.R\")\n```\n:::\n\n\n## Load data\n\nDaily, scaled cases, maximum temperature, minimum temperature and precipitation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntdengue <- open_dataset(sources = data_dir(\"bundled_data/tdengue.parquet\")) %>%\n  select(mun, date, cases, tmax, tmin, prec) %>%\n  collect()\n\ndim(tdengue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 331980      6\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(unique(tdengue$mun))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 333\n```\n:::\n:::\n\n\nData for maps.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuf_sf <- geobr::read_state(showProgress = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n```{.r .cell-code}\ncoords <- geobr::read_municipality(showProgress = FALSE) %>%\n  st_make_valid() %>%\n  st_centroid()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2010\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: st_centroid assumes attributes are constant over geometries\n```\n:::\n:::\n\n\n## Prepare data\n\nFor clustering, the data must be a list of data frames with climate data and without date.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngdengue <- tdengue %>%\n  group_by(mun) %>%\n  arrange(date) %>%\n  select(-date)\n\nmdengue <- group_split(gdengue, .keep = FALSE) %>%\n  tslist(simplify = TRUE)\n\nnames(mdengue) <- group_keys(gdengue)$mun\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(mdengue[1:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 3\n $ 110002: num [1:1001, 1:4] -0.511 0.668 0.668 0.668 0.668 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n $ 110012: num [1:1001, 1:4] -0.45 0.648 0.648 1.198 1.198 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n $ 110020: num [1:1001, 1:4] -0.5201 0.1558 0.1558 0.0713 0.0713 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"cases\" \"tmax\" \"tmin\" \"prec\"\n```\n:::\n:::\n\n\n## DTW clustering\n\nTry from 3 to 20 partitions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntic()\nstdw_clust <- tsclust(\n  series = mdengue, \n  type = \"partitional\", k = 3:20, \n  distance = \"dtw_basic\", \n  seed = 13\n)\ntoc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n33.221 sec elapsed\n```\n:::\n:::\n\n\n### Cluster Validity Indices (CVI)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(stdw_clust) <- paste0(\"k_\", 3:20)\nres_cvi <- sapply(stdw_clust, cvi, type = \"internal\") %>% \n  t() %>%\n  as_tibble(rownames = \"k\") %>%\n  arrange(-Sil)\n\ndatatable(res_cvi)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-602228f0057e4179a1f2\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-602228f0057e4179a1f2\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\"],[\"k_5\",\"k_10\",\"k_4\",\"k_11\",\"k_8\",\"k_9\",\"k_3\",\"k_6\",\"k_15\",\"k_18\",\"k_7\",\"k_14\",\"k_16\",\"k_13\",\"k_12\",\"k_19\",\"k_17\",\"k_20\"],[0.1279891898123446,0.119391513627497,0.1112460346175835,0.111183544363204,0.1037889735428478,0.09908440332531278,0.09892984383200942,0.09398010585344234,0.09269024567672776,0.08951796943607226,0.08892738818122657,0.08854704499566712,0.08643915610544772,0.0820343625057926,0.07761686669656334,0.06921027960321488,0.05487261485226928,0.04173607783450495],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[77.75557636045349,36.86152453465702,84.89952578430741,35.64293817440353,41.08147273532985,43.48789744620822,106.4230192029615,52.53254600580426,25.96180002036026,23.803732462588,53.87800011773442,30.10210404457136,27.11284537736144,29.87663609861306,31.04191310540553,21.59494888502675,22.62436202537118,18.76528009214688],[1.658898470788445,1.882554869825658,1.924466082331256,1.9938445306628,2.204419668240759,1.648603751234362,2.107691477550161,2.137246906350873,1.945500720947033,1.9060611331235,1.830034787074255,1.904295830187339,1.85320605023181,1.932421270659566,2.117756324004935,1.759508162073236,2.164061740353588,2.138780449354899],[2.144809158458031,2.660883630629609,2.184289831286962,2.519810188189624,3.031635798966411,2.176479681652975,2.113687431492114,2.693270360372969,2.794142587602786,2.531278171566188,2.354791994887921,2.530897103864516,2.201971561180548,2.72361744371077,3.038253168112735,2.623302907037457,3.127845415735809,3.227042391768956],[0.08223307687689742,0.0818423748225903,0.07874964129385519,0.08770535045225687,0.07079839471025445,0.06152565069149599,0.09378627426196144,0.07079839471025445,0.1028779404861086,0.09141522966759452,0.07874964129385519,0.05464640279993375,0.0807654199387649,0.07079839471025445,0.07079839471025445,0.04624141913723524,0.06838457120656347,0.04920344101067848],[0.3008754691926039,0.2773243959547624,0.3411457223621422,0.2709614172930037,0.2894771446282627,0.2766254810204077,0.3816313315558913,0.3159596106312662,0.2660881402551111,0.2410372808552153,0.3218964738939778,0.2549663513244521,0.2490030578486272,0.275890948091602,0.2713504596501977,0.2605357604354647,0.2637490636418223,0.2564643160435325]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>k<\\/th>\\n      <th>Sil<\\/th>\\n      <th>SF<\\/th>\\n      <th>CH<\\/th>\\n      <th>DB<\\/th>\\n      <th>DBstar<\\/th>\\n      <th>D<\\/th>\\n      <th>COP<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5,6,7,8]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_sel_clust <- stdw_clust[[res_cvi[[1,1]]]]\n\nplot(m_sel_clust)\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_all_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Partitions size\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(m_sel_clust@cluster)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  1   2   3   4   5 \n 69  62  82 102  18 \n```\n:::\n:::\n\n\n### Partition results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoords <- coords %>%\n  mutate(code_muni = substr(code_muni, 0, 6))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids <- tibble(\n  code_muni = names(mdengue),\n  group = as.character(m_sel_clust@cluster)\n) %>% \n  left_join(coords, by = \"code_muni\") %>%\n  arrange(group, name_muni) %>%\n  st_as_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(object = m_cluster_ids, file = \"m_cluster_ids.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_cluster_ids %>%\n  select(group, name_muni, abbrev_state) %>%\n  arrange(group, name_muni) %>%\n  st_drop_geometry() %>%\n  datatable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-1e0a0473e6474226addf\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1e0a0473e6474226addf\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\"],[\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\"],[\"Anápolis\",\"Aparecida De Goiânia\",\"Araguari\",\"Araxá\",\"Araçatuba\",\"Barcarena\",\"Barretos\",\"Bauru\",\"Belo Horizonte\",\"Betim\",\"Birigui\",\"Blumenau\",\"Brasília\",\"Cabo De Santo Agostinho\",\"Campo Grande\",\"Catalão\",\"Contagem\",\"Curitiba\",\"Divinópolis\",\"Dourados\",\"Eunápolis\",\"Feira De Santana\",\"Formosa\",\"Franca\",\"Garanhuns\",\"Goiânia\",\"Ibirité\",\"Itabira\",\"Itaboraí\",\"Itabuna\",\"Itaperuna\",\"Itu\",\"Ituiutaba\",\"Jequié\",\"João Pessoa\",\"Juiz De Fora\",\"Maringá\",\"Montes Claros\",\"Muriaé\",\"Nova Serrana\",\"Patos De Minas\",\"Paço Do Lumiar\",\"Piracicaba\",\"Ponta Grossa\",\"Porto Alegre\",\"Porto Velho\",\"Presidente Prudente\",\"Ribeirão Das Neves\",\"Rio Das Ostras\",\"Rio Verde\",\"Santa Luzia\",\"Santa Rita\",\"Santo Antônio De Jesus\",\"Serra\",\"Sertãozinho\",\"Sete Lagoas\",\"Suzano\",\"São José Do Rio Preto\",\"São José Dos Pinhais\",\"São Lourenço Da Mata\",\"São Pedro Da Aldeia\",\"Tangará Da Serra\",\"Três Lagoas\",\"Uberlândia\",\"Ubá\",\"Vila Velha\",\"Vilhena\",\"Volta Redonda\",\"Águas Lindas De Goiás\",\"Almirante Tamandaré\",\"Apucarana\",\"Arapongas\",\"Araucária\",\"Balneário Camboriú\",\"Barbacena\",\"Barra Do Piraí\",\"Bayeux\",\"Botucatu\",\"Breves\",\"Brusque\",\"Cachoeirinha\",\"Caieiras\",\"Canoas\",\"Carapicuíba\",\"Cariacica\",\"Caruaru\",\"Cascavel\",\"Caxias Do Sul\",\"Chapecó\",\"Codó\",\"Colatina\",\"Colombo\",\"Conselheiro Lafaiete\",\"Cotia\",\"Criciúma\",\"Florianópolis\",\"Franco Da Rocha\",\"Guaratinguetá\",\"Guaíba\",\"Indaiatuba\",\"Itajaí\",\"Itanhaém\",\"Itapetininga\",\"Jaraguá Do Sul\",\"Joinville\",\"Leme\",\"Mairiporã\",\"Nossa Senhora Do Socorro\",\"Nova Friburgo\",\"Novo Hamburgo\",\"Palhoça\",\"Paranaguá\",\"Passo Fundo\",\"Pinhais\",\"Piraquara\",\"Poços De Caldas\",\"Queimados\",\"Ribeirão Pires\",\"Rio Grande\",\"Salto\",\"Santa Maria\",\"Sarandi\",\"Tatuí\",\"Teixeira De Freitas\",\"Teresópolis\",\"Tubarão\",\"Umuarama\",\"Viamão\",\"Vitória\",\"Votorantim\",\"Várzea Paulista\",\"Abaetetuba\",\"Alagoinhas\",\"Altamira\",\"Ananindeua\",\"Aracaju\",\"Araguaína\",\"Araraquara\",\"Barreiras\",\"Belford Roxo\",\"Belém\",\"Boa Vista\",\"Bragança\",\"Cabo Frio\",\"Cametá\",\"Campos Dos Goytacazes\",\"Castanhal\",\"Caucaia\",\"Caxias\",\"Coronel Fabriciano\",\"Crato\",\"Cuiabá\",\"Duque De Caxias\",\"Fortaleza\",\"Foz Do Iguaçu\",\"Governador Valadares\",\"Guarapari\",\"Iguatu\",\"Imperatriz\",\"Ipatinga\",\"Itacoatiara\",\"Itaituba\",\"Itapipoca\",\"Japeri\",\"Linhares\",\"Londrina\",\"Luziânia\",\"Macapá\",\"Macaé\",\"Magé\",\"Manacapuru\",\"Manaus\",\"Marabá\",\"Maracanaú\",\"Maricá\",\"Marituba\",\"Mesquita\",\"Mossoró\",\"Natal\",\"Nilópolis\",\"Niterói\",\"Nova Iguaçu\",\"Nova Lima\",\"Palmas\",\"Paragominas\",\"Parauapebas\",\"Parintins\",\"Patos\",\"Petrópolis\",\"Porto Seguro\",\"Ribeirão Preto\",\"Rio Branco\",\"Rio De Janeiro\",\"Salvador\",\"Santana\",\"Santarém\",\"Senador Canedo\",\"Sinop\",\"São Félix Do Xingu\",\"São Gonçalo\",\"São José De Ribamar\",\"São João De Meriti\",\"São Luís\",\"Tailândia\",\"Taubaté\",\"Teresina\",\"Trindade\",\"Tucuruí\",\"Uberaba\",\"Varginha\",\"Vespasiano\",\"Vitória Da Conquista\",\"Vitória De Santo Antão\",\"Abreu E Lima\",\"Americana\",\"Angra Dos Reis\",\"Arapiraca\",\"Araras\",\"Araruama\",\"Ariquemes\",\"Assis\",\"Atibaia\",\"Açailândia\",\"Bacabal\",\"Barra Mansa\",\"Barueri\",\"Bragança Paulista\",\"Camaragibe\",\"Camaçari\",\"Cambé\",\"Campina Grande\",\"Campinas\",\"Caraguatatuba\",\"Catanduva\",\"Corumbá\",\"Cubatão\",\"Diadema\",\"Embu\",\"Ferraz De Vasconcelos\",\"Francisco Morato\",\"Guarujá\",\"Guarulhos\",\"Hortolândia\",\"Igarassu\",\"Ilhéus\",\"Itabaiana\",\"Itaguaí\",\"Itapecerica Da Serra\",\"Itapevi\",\"Itaquaquecetuba\",\"Itatiba\",\"Itumbiara\",\"Jaboatão Dos Guararapes\",\"Jacareí\",\"Jandira\",\"Jataí\",\"Jaú\",\"Ji-Paraná\",\"Juazeiro\",\"Juazeiro Do Norte\",\"Jundiaí\",\"Lagarto\",\"Lauro De Freitas\",\"Lavras\",\"Limeira\",\"Maceió\",\"Maranguape\",\"Marília\",\"Mauá\",\"Mogi Das Cruzes\",\"Mogi Guaçu\",\"Novo Gama\",\"Olinda\",\"Osasco\",\"Ourinhos\",\"Parnamirim\",\"Parnaíba\",\"Passos\",\"Paulista\",\"Paulo Afonso\",\"Paulínia\",\"Petrolina\",\"Pindamonhangaba\",\"Pouso Alegre\",\"Poá\",\"Praia Grande\",\"Recife\",\"Resende\",\"Rio Claro\",\"Rondonópolis\",\"Sabará\",\"Santa Bárbara D'oeste\",\"Santa Cruz Do Capibaribe\",\"Santana De Parnaíba\",\"Santo André\",\"Santos\",\"Simões Filho\",\"Sobral\",\"Sorocaba\",\"Sumaré\",\"São Bernardo Do Campo\",\"São Caetano Do Sul\",\"São Carlos\",\"São Gonçalo Do Amarante\",\"São José\",\"São José Dos Campos\",\"São Paulo\",\"São Vicente\",\"Taboão Da Serra\",\"Teófilo Otoni\",\"Timon\",\"Toledo\",\"Valinhos\",\"Valparaíso De Goiás\",\"Várzea Grande\",\"Alvorada\",\"Aracruz\",\"Bagé\",\"Bento Gonçalves\",\"Cachoeiro De Itapemirim\",\"Campo Largo\",\"Erechim\",\"Fazenda Rio Grande\",\"Gravataí\",\"Guarapuava\",\"Lages\",\"Pelotas\",\"Santa Cruz Do Sul\",\"Sapucaia Do Sul\",\"São Leopoldo\",\"São Mateus\",\"Uruguaiana\",\"Valença\"],[\"GO\",\"GO\",\"MG\",\"MG\",\"SP\",\"PA\",\"SP\",\"SP\",\"MG\",\"MG\",\"SP\",\"SC\",\"DF\",\"PE\",\"MS\",\"GO\",\"MG\",\"PR\",\"MG\",\"MS\",\"BA\",\"BA\",\"GO\",\"SP\",\"PE\",\"GO\",\"MG\",\"MG\",\"RJ\",\"BA\",\"RJ\",\"SP\",\"MG\",\"BA\",\"PB\",\"MG\",\"PR\",\"MG\",\"MG\",\"MG\",\"MG\",\"MA\",\"SP\",\"PR\",\"RS\",\"RO\",\"SP\",\"MG\",\"RJ\",\"GO\",\"MG\",\"PB\",\"BA\",\"ES\",\"SP\",\"MG\",\"SP\",\"SP\",\"PR\",\"PE\",\"RJ\",\"MT\",\"MS\",\"MG\",\"MG\",\"ES\",\"RO\",\"RJ\",\"GO\",\"PR\",\"PR\",\"PR\",\"PR\",\"SC\",\"MG\",\"RJ\",\"PB\",\"SP\",\"PA\",\"SC\",\"RS\",\"SP\",\"RS\",\"SP\",\"ES\",\"PE\",\"PR\",\"RS\",\"SC\",\"MA\",\"ES\",\"PR\",\"MG\",\"SP\",\"SC\",\"SC\",\"SP\",\"SP\",\"RS\",\"SP\",\"SC\",\"SP\",\"SP\",\"SC\",\"SC\",\"SP\",\"SP\",\"SE\",\"RJ\",\"RS\",\"SC\",\"PR\",\"RS\",\"PR\",\"PR\",\"MG\",\"RJ\",\"SP\",\"RS\",\"SP\",\"RS\",\"PR\",\"SP\",\"BA\",\"RJ\",\"SC\",\"PR\",\"RS\",\"ES\",\"SP\",\"SP\",\"PA\",\"BA\",\"PA\",\"PA\",\"SE\",\"TO\",\"SP\",\"BA\",\"RJ\",\"PA\",\"RR\",\"PA\",\"RJ\",\"PA\",\"RJ\",\"PA\",\"CE\",\"MA\",\"MG\",\"CE\",\"MT\",\"RJ\",\"CE\",\"PR\",\"MG\",\"ES\",\"CE\",\"MA\",\"MG\",\"AM\",\"PA\",\"CE\",\"RJ\",\"ES\",\"PR\",\"GO\",\"AP\",\"RJ\",\"RJ\",\"AM\",\"AM\",\"PA\",\"CE\",\"RJ\",\"PA\",\"RJ\",\"RN\",\"RN\",\"RJ\",\"RJ\",\"RJ\",\"MG\",\"TO\",\"PA\",\"PA\",\"AM\",\"PB\",\"RJ\",\"BA\",\"SP\",\"AC\",\"RJ\",\"BA\",\"AP\",\"PA\",\"GO\",\"MT\",\"PA\",\"RJ\",\"MA\",\"RJ\",\"MA\",\"PA\",\"SP\",\"PI\",\"GO\",\"PA\",\"MG\",\"MG\",\"MG\",\"BA\",\"PE\",\"PE\",\"SP\",\"RJ\",\"AL\",\"SP\",\"RJ\",\"RO\",\"SP\",\"SP\",\"MA\",\"MA\",\"RJ\",\"SP\",\"SP\",\"PE\",\"BA\",\"PR\",\"PB\",\"SP\",\"SP\",\"SP\",\"MS\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"PE\",\"BA\",\"SE\",\"RJ\",\"SP\",\"SP\",\"SP\",\"SP\",\"GO\",\"PE\",\"SP\",\"SP\",\"GO\",\"SP\",\"RO\",\"BA\",\"CE\",\"SP\",\"SE\",\"BA\",\"MG\",\"SP\",\"AL\",\"CE\",\"SP\",\"SP\",\"SP\",\"SP\",\"GO\",\"PE\",\"SP\",\"SP\",\"RN\",\"PI\",\"MG\",\"PE\",\"BA\",\"SP\",\"PE\",\"SP\",\"MG\",\"SP\",\"SP\",\"PE\",\"RJ\",\"SP\",\"MT\",\"MG\",\"SP\",\"PE\",\"SP\",\"SP\",\"SP\",\"BA\",\"CE\",\"SP\",\"SP\",\"SP\",\"SP\",\"SP\",\"RN\",\"SC\",\"SP\",\"SP\",\"SP\",\"SP\",\"MG\",\"MA\",\"PR\",\"SP\",\"GO\",\"MT\",\"RS\",\"ES\",\"RS\",\"RS\",\"ES\",\"PR\",\"RS\",\"PR\",\"RS\",\"PR\",\"SC\",\"RS\",\"RS\",\"RS\",\"RS\",\"ES\",\"RS\",\"BA\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>group<\\/th>\\n      <th>name_muni<\\/th>\\n      <th>abbrev_state<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = uf_sf, fill = \"lightgray\", color = \"grey20\", size=.15, show.legend = FALSE) +\n  geom_sf(data = m_cluster_ids, aes(color = group), size = 2, alpha = 0.7) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](cluster_multivariate_all_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-conda-linux-gnu (64-bit)\nRunning under: CentOS Linux 7 (Core)\n\nMatrix products: default\nBLAS/LAPACK: /home/raphaelfs/miniconda3/envs/quarto/lib/libopenblasp-r0.3.25.so;  LAPACK version 3.11.0\n\nRandom number generation:\n RNG:     L'Ecuyer-CMRG \n Normal:  Inversion \n Sample:  Rejection \n \nlocale:\n [1] LC_CTYPE=pt_BR.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=pt_BR.UTF-8        LC_COLLATE=pt_BR.UTF-8    \n [5] LC_MONETARY=pt_BR.UTF-8    LC_MESSAGES=pt_BR.UTF-8   \n [7] LC_PAPER=pt_BR.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=pt_BR.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: America/Sao_Paulo\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] DT_0.28          sf_1.0-14        tictoc_1.2       kableExtra_1.3.4\n [5] dtwclust_5.5.12  dtw_1.23-1       proxy_0.4-27     timetk_2.8.2    \n [9] arrow_12.0.0     lubridate_1.9.2  forcats_1.0.0    stringr_1.5.0   \n[13] dplyr_1.1.2      purrr_1.0.1      readr_2.1.4      tidyr_1.3.0     \n[17] tibble_3.2.1     ggplot2_3.4.2    tidyverse_2.0.0 \n\nloaded via a namespace (and not attached):\n  [1] rstudioapi_0.14     jsonlite_1.8.5      wk_0.7.3           \n  [4] magrittr_2.0.3      modeltools_0.2-23   farver_2.1.1       \n  [7] rmarkdown_2.22      vctrs_0.6.3         webshot_0.5.4      \n [10] htmltools_0.5.5     dials_1.2.0         curl_5.0.2         \n [13] s2_1.1.4            sass_0.4.6          parallelly_1.36.0  \n [16] KernSmooth_2.23-21  bslib_0.4.2         htmlwidgets_1.6.2  \n [19] plyr_1.8.8          cachem_1.0.8        zoo_1.8-12         \n [22] mime_0.12           lifecycle_1.0.3     iterators_1.0.14   \n [25] pkgconfig_2.0.3     Matrix_1.5-4.1      R6_2.5.1           \n [28] fastmap_1.1.1       future_1.32.0       shiny_1.7.4        \n [31] tune_1.1.2          clue_0.3-64         digest_0.6.31      \n [34] colorspace_2.1-0    furrr_0.3.1         RSpectra_0.16-1    \n [37] crosstalk_1.2.0     labeling_0.4.2      fansi_1.0.4        \n [40] yardstick_1.2.0     timechange_0.2.0    httr_1.4.6         \n [43] compiler_4.3.2      bit64_4.0.5         withr_2.5.0        \n [46] DBI_1.1.3           MASS_7.3-60         lava_1.7.2.1       \n [49] classInt_0.4-9      tools_4.3.2         units_0.8-2        \n [52] httpuv_1.6.11       flexclust_1.4-1     future.apply_1.11.0\n [55] nnet_7.3-19         glue_1.6.2          promises_1.2.0.1   \n [58] grid_4.3.2          cluster_2.1.4       reshape2_1.4.4     \n [61] generics_0.1.3      recipes_1.0.6       gtable_0.3.3       \n [64] tzdb_0.4.0          class_7.3-22        data.table_1.14.8  \n [67] hms_1.1.3           rsample_1.2.0       xml2_1.3.4         \n [70] utf8_1.2.3          ggrepel_0.9.3       geobr_1.8.1        \n [73] foreach_1.5.2       pillar_1.9.0        later_1.3.1        \n [76] splines_4.3.2       lhs_1.1.6           lattice_0.21-8     \n [79] survival_3.5-5      bit_4.0.5           tidyselect_1.2.0   \n [82] knitr_1.43          svglite_2.1.1       stats4_4.3.2       \n [85] xfun_0.39           hardhat_1.3.0       timeDate_4022.108  \n [88] stringi_1.7.12      DiceDesign_1.9      yaml_2.3.7         \n [91] workflows_1.1.3     evaluate_0.21       codetools_0.2-19   \n [94] cli_3.6.1           RcppParallel_5.1.7  rpart_4.1.19       \n [97] xtable_1.8-4        systemfonts_1.0.4   jquerylib_0.1.4    \n[100] munsell_0.5.0       Rcpp_1.0.10         globals_0.16.2     \n[103] parallel_4.3.2      ellipsis_0.3.2      gower_1.0.1        \n[106] assertthat_0.2.1    parsnip_1.1.0       GPfit_1.0-8        \n[109] listenv_0.9.0       viridisLite_0.4.2   ipred_0.9-13       \n[112] scales_1.2.1        xts_0.13.1          prodlim_2019.11.13 \n[115] e1071_1.7-13        rlang_1.1.1         rvest_1.0.3        \n[118] shinyjs_2.1.0      \n```\n:::\n:::\n",
    "supporting": [
      "cluster_multivariate_all_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.28/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}